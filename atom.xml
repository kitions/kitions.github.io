<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Filip</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://kitions.github.io/"/>
  <updated>2023-03-23T03:18:57.810Z</updated>
  <id>https://kitions.github.io/</id>
  
  <author>
    <name>link</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Next.js - Postcss-scss - bug</title>
    <link href="https://kitions.github.io/2023/03/23/230323Next.js%20-%20Postcss-scss%20-%20bug/"/>
    <id>https://kitions.github.io/2023/03/23/230323Next.js - Postcss-scss - bug/</id>
    <published>2023-03-23T03:18:55.000Z</published>
    <updated>2023-03-23T03:18:57.810Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Next-js-Postcss-scss-bug"><a href="#Next-js-Postcss-scss-bug" class="headerlink" title="Next.js - Postcss-scss - bug"></a>Next.js - Postcss-scss - bug</h1><p> background-imageé—®é¢˜</p><p>ä¸èƒ½åœ¨backgroundä¸­å†™åŒå¼•å·</p><p><code>background: URL(../../public/images/test.png);</code></p><p>åœ¨scssä¸­ç›´æ¥æ ¹æ®ç›¸å¯¹è·¯å¾„å†™ï¼Œåˆ°æ—¶å€™nextä¼šæ¥ç®¡æ‰“åŒ…ï¼Œå¹¶å¼•å…¥cdné“¾æ¥</p><p> postcss-scssçš„bugï¼ˆå·²åœ¨4.0.6ä¿®å¤ï¼‰ï¼š</p><p> - <a href="https://github.com/vercel/next.js/issues/21461" target="_blank" rel="noopener">https://github.com/vercel/next.js/issues/21461</a></p><p> - <a href="https://github.com/postcss/postcss-scss/issues/142" target="_blank" rel="noopener">https://github.com/postcss/postcss-scss/issues/142</a></p><p>æ­£ç¡®å†™æ³•ï¼š</p><p><img src="https://tuchuang-1253437688.cos.ap-shanghai.myqcloud.com/md%E5%9B%BE%E5%BA%8A/image-20230323110759068.png" alt="image-20230323110759068"></p><p><img src="https://tuchuang-1253437688.cos.ap-shanghai.myqcloud.com/md%E5%9B%BE%E5%BA%8A/image-20230323110725151.png" alt="image-20230323110725151"></p><p><img src="https://tuchuang-1253437688.cos.ap-shanghai.myqcloud.com/md%E5%9B%BE%E5%BA%8A/image-20230323110654906.png" alt="image-20230323110654906"></p><p>æ‰“åŒ…åçš„äº§ç‰©ï¼š</p><p><img src="https://tuchuang-1253437688.cos.ap-shanghai.myqcloud.com/md%E5%9B%BE%E5%BA%8A/image-20230323110934853.png" alt="image-20230323110934853"></p>]]></content>
    
    <summary type="html">
    
      next.js scss background-imageé—®é¢˜
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="next.js" scheme="https://kitions.github.io/tags/next-js/"/>
    
  </entry>
  
  <entry>
    <title>ReactçŠ¶æ€ç®¡ç†åº“Recoilæµ…å…¥æµ…å‡º</title>
    <link href="https://kitions.github.io/2022/11/10/221013Recoil/"/>
    <id>https://kitions.github.io/2022/11/10/221013Recoil/</id>
    <published>2022-11-10T06:50:40.000Z</published>
    <updated>2022-11-11T09:04:20.094Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ReactçŠ¶æ€ç®¡ç†åº“Recoilæµ…å…¥æµ…å‡º"><a href="#ReactçŠ¶æ€ç®¡ç†åº“Recoilæµ…å…¥æµ…å‡º" class="headerlink" title="ReactçŠ¶æ€ç®¡ç†åº“Recoilæµ…å…¥æµ…å‡º"></a>ReactçŠ¶æ€ç®¡ç†åº“Recoilæµ…å…¥æµ…å‡º</h1><h1 id="ä¸€ã€å¼•è¨€"><a href="#ä¸€ã€å¼•è¨€" class="headerlink" title="ä¸€ã€å¼•è¨€"></a>ä¸€ã€å¼•è¨€</h1><p>Recoil çš„ slogan ååˆ†ç®€å•ï¼šä¸€ä¸ªreactçŠ¶æ€ç®¡ç†åº“ï¼ˆA state management library for Reactï¼‰</p><p>Recoil çš„äº§ç”Ÿæºäº Facebook å†…éƒ¨ä¸€ä¸ªå¯è§†åŒ–æ•°æ®åˆ†æç›¸å…³çš„åº”ç”¨ï¼Œåœ¨ä½¿ç”¨ React çš„å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºç°æœ‰çŠ¶æ€ç®¡ç†å·¥å…·ä¸èƒ½å¾ˆå¥½çš„æ»¡è¶³åº”ç”¨çš„éœ€æ±‚ï¼Œå› æ­¤å‚¬ç”Ÿå‡ºäº† Recoil ã€‚</p><p>è¿™ä¸ªåº”ç”¨å¸¦æœ‰å¤æ‚çš„äº¤äº’ï¼Œå¯ä»¥è¢«æ€»ç»“ä¸ºä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>å¤§é‡éœ€è¦å…±äº«çŠ¶æ€çš„åœºæ™¯</li><li>å¤§é‡éœ€è¦æ´¾ç”ŸçŠ¶æ€(åŸºäºæŸäº›çŠ¶æ€è®¡ç®—å‡ºä¸€ä¸ªæ–°çš„çŠ¶æ€)çš„åœºæ™¯</li><li>çŠ¶æ€å¯ä»¥è¢«æŒä¹…åŒ–ï¼Œè¿›è€Œé€šè¿‡è¢«æŒä¹…åŒ–çš„çŠ¶æ€æ¢å¤å½“æ—¶åœºæ™¯</li></ul><h1 id="äºŒã€æ³¨æ„ğŸ“¢"><a href="#äºŒã€æ³¨æ„ğŸ“¢" class="headerlink" title="äºŒã€æ³¨æ„ğŸ“¢"></a>äºŒã€æ³¨æ„ğŸ“¢</h1><p>ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤é¡¹ç›®æ˜¯facebookå†…éƒ¨çš„å®éªŒæ€§é¡¹ç›®ï¼Œæˆªæ­¢2022å¹´11æœˆ8æ—¥ï¼Œæ­¤é¡¹ç›®ç›®å‰çš„æœ€æ–°çš„ç‰ˆæœ¬å·æ˜¯0.7.6ï¼Œè¿˜æ²¡æœ‰å‡ºæ­£å¼ç‰ˆæœ¬ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7xgyscibnj30ch0bjgm2.jpg" alt="image-20221108093737186"></p><p>åŒ…æ‹¬å…¶<a href="https://recoiljs.org/docs/api-reference/core/useRecoilTransaction" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>çœ‹ç€çœ‹ç€å°±ä¼šå‡ºæ¥ä¸ª UNSTABLE æˆ–è€…UNSAFEçš„æ ‡ç­¾</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7xh14qahrj313i0mzq70.jpg" alt="image-20221108093951738"></p><p>å¦‚æœä½ çš„é¡¹ç›®ï¼Œå¤§å‹é¡¹ç›®æˆ–è€…ç»´æŠ¤å¾ˆæŒä¹…çš„é¡¹ç›®ï¼ˆps: 3ã€5å¹´ä»¥ä¸Šçš„ï¼‰ä¸ªäººä¸æ˜¯å¾ˆæ¨èç”¨ï¼Œå°é¡¹ç›®å¯ä»¥è¯•æ°´ï¼Œå®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚å†™æ³•å¾ˆèˆ’æœï¼Œå‡½æ•°å¼è°ƒç”¨åŠå…¶ç®€æ˜“ã€‚</p><h1 id="ä¸‰ã€å…¶ä»–çŠ¶æ€ç®¡ç†æ–¹æ¡ˆæ¯”è¾ƒ"><a href="#ä¸‰ã€å…¶ä»–çŠ¶æ€ç®¡ç†æ–¹æ¡ˆæ¯”è¾ƒ" class="headerlink" title="ä¸‰ã€å…¶ä»–çŠ¶æ€ç®¡ç†æ–¹æ¡ˆæ¯”è¾ƒ"></a>ä¸‰ã€å…¶ä»–çŠ¶æ€ç®¡ç†æ–¹æ¡ˆæ¯”è¾ƒ</h1><p>å½“ç„¶å…±äº«çŠ¶æ€è¿˜æœ‰å…¶ä»–æ–¹æ³•ï¼š</p><ul><li><p>Reactè‡ªèº«</p></li><li><p>Redux</p></li><li><p>Mobx</p></li><li><p>Context</p></li></ul><h3 id="3-1-å„ä¸ªæ–¹æ¡ˆNPM-Trendså¯¹æ¯”"><a href="#3-1-å„ä¸ªæ–¹æ¡ˆNPM-Trendså¯¹æ¯”" class="headerlink" title="3.1. å„ä¸ªæ–¹æ¡ˆNPM Trendså¯¹æ¯”"></a>3.1. <a href="https://npmtrends.com/mobx-vs-recoil-vs-redux" target="_blank" rel="noopener">å„ä¸ªæ–¹æ¡ˆNPM Trendså¯¹æ¯”</a></h3><p><img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7xsu7x6n5j311u0n9mza.jpg" alt="image-20221108162825008"></p><h3 id="3-2-Stars-å¯¹æ¯”"><a href="#3-2-Stars-å¯¹æ¯”" class="headerlink" title="3.2. Stars å¯¹æ¯”"></a>3.2. Stars å¯¹æ¯”</h3><p><img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7xsvd33xoj311208rgmd.jpg" alt="image-20221108162931404"></p><p>å¦‚æœç”¨è¿™äº›æ–¹æ³•çš„ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜æˆ–è€…è¯´ä¸€äº›ç¼ºç‚¹ä¸å¤ªèˆ’æœçš„åœ°æ–¹ï¼Ÿå½“ç„¶å®ƒä»¬æœ¬èº«éƒ½å¾ˆä¼˜ç§€ï¼Œä¸ç„¶ä¹Ÿä¸ä¼šé‚£ä¹ˆå¤§çš„ä¸‹è½½é‡ã€‚</p><h3 id="3-3-Reactè‡ªèº«"><a href="#3-3-Reactè‡ªèº«" class="headerlink" title="3.3. Reactè‡ªèº«"></a>3.3. Reactè‡ªèº«</h3><p>Reactæœ¬èº«è§£å†³æ•°æ®å…±äº«æ˜¯é€šè¿‡æå‡çŠ¶æ€æ¥è§£å†³çš„ï¼Œè¿™ä¸ªå°±è‡ªç„¶å°±ä¼šå› ä¸ºæŸä¸ªç»„ä»¶çš„çŠ¶æ€æ”¹å˜è€Œå¯¼è‡´æ‰€æœ‰çš„å­ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œå°½ç®¡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>memo</code>æ¥ä¼˜åŒ–ï¼Œä½†æ˜¯å”¤é†’çš„é—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå¯¹æ¯”å‰åçš„Propsçš„æ“ä½œä¾ç„¶æ— æ³•é¿å…ã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œä¸€æ—¦åˆæœ‰ä¸€ä¸ªç»„ä»¶éœ€è¦è§‚å¯Ÿå…±äº«çš„æ•°æ®ï¼Œé‚£åˆéœ€è¦ç»§ç»­æå‡æ•°æ®ï¼Œåˆéº»çƒ¦äº†</p><h3 id="3-4-Redux"><a href="#3-4-Redux" class="headerlink" title="3.4. Redux"></a>3.4. Redux</h3><p> Redux å…¶å¤§è‡´å·¥ä½œæµç¨‹ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>ç”¨æˆ·åœ¨é¡µé¢ä¸Šè¿›è¡ŒæŸäº›æ“ä½œï¼Œé€šè¿‡ <code>dispatch</code> å‘é€ä¸€ä¸ª <code>action</code>ã€‚</li><li>Redux æ¥æ”¶åˆ°è¿™ä¸ª <code>action</code> åé€šè¿‡ <code>reducer</code> å‡½æ•°è·å–åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚</li><li>å°†æ–°çŠ¶æ€æ›´æ–°è¿› <code>store</code>ï¼Œ<code>store</code> æ›´æ–°åé€šçŸ¥é¡µé¢è¿›è¡Œé‡æ–°æ¸²æŸ“ã€‚</li></ol><p>ä»è¿™ä¸ªæµç¨‹ä¸­ä¸éš¾çœ‹å‡ºï¼ŒRedux çš„æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ª <strong><em>ã€Œå‘å¸ƒ-è®¢é˜…ã€</em></strong> æ¨¡å¼ã€‚view è®¢é˜…äº† store çš„å˜åŒ–ï¼Œä¸€æ—¦ store çŠ¶æ€å‘ç”Ÿä¿®æ”¹å°±ä¼šé€šçŸ¥æ‰€æœ‰çš„è®¢é˜…è€…ï¼Œview æ¥æ”¶åˆ°é€šçŸ¥ä¹‹åä¼šè¿›è¡Œé‡æ–°æ¸²æŸ“ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h73p29oai8j315r0ikdhs.jpg" width="600"></p><h3 id="3-5-Mobx"><a href="#3-5-Mobx" class="headerlink" title="3.5. Mobx"></a>3.5. Mobx</h3><p>Mobx æ˜¯ React çš„å¦ä¸€ç§ç»è¿‡æˆ˜ç«æ´—ç¤¼çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼Œå’Œ Redux ä¸åŒçš„åœ°æ–¹æ˜¯ Mobx æ˜¯ä¸€ä¸ªå“åº”å¼ç¼–ç¨‹ï¼ˆ<code>Reactive Programming</code>ï¼‰åº“</p><p>Mobx å€ŸåŠ©äºè£…é¥°å™¨çš„å®ç°ï¼Œä½¿å¾—ä»£ç æ›´åŠ ç®€æ´æ˜“æ‡‚ã€‚ç”±äºä½¿ç”¨äº†å¯è§‚å¯Ÿå¯¹è±¡ï¼Œæ‰€ä»¥ Mobx å¯ä»¥åšåˆ°ç›´æ¥ä¿®æ”¹çŠ¶æ€ï¼Œè€Œä¸å¿…åƒ Redux ä¸€æ ·ç¼–å†™ç¹ççš„ actions å’Œ reducersã€‚</p><p>è¿™é‡Œçš„ <code>action</code> ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†ä¸ºäº†ä¿è¯çŠ¶æ€ä¸ä¼šè¢«éšæ„ä¿®æ”¹ï¼Œè¿˜æ˜¯å»ºè®®å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼Œåªå…è®¸åœ¨ <code>action</code> é‡Œé¢ä¿®æ”¹çŠ¶æ€ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; action, observable &#125; <span class="keyword">from</span> <span class="string">'mobx'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">  @observable count = <span class="number">0</span>;</span><br><span class="line">  @action increment() &#123;</span><br><span class="line">    <span class="keyword">this</span>.count++;</span><br><span class="line">  &#125;</span><br><span class="line">  @action decrement() &#123;</span><br><span class="line">    <span class="keyword">this</span>.count--;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7xtcapjklj313206bwex.jpg" alt="image-20221013153014972"></p><h3 id="3-6-Redux-å’Œ-Mobxæ€»ç»“"><a href="#3-6-Redux-å’Œ-Mobxæ€»ç»“" class="headerlink" title="3.6. Redux å’Œ Mobxæ€»ç»“"></a>3.6. Redux å’Œ Mobxæ€»ç»“</h3><ul><li>ä¸€ä¸ªActionä¼šå”¤é†’æ‰€æœ‰çš„è®¢é˜…æ•°æ®çš„ç»„ä»¶ï¼Œå³ä½¿ä»–ä»¬è®¢é˜…çš„æ•°æ®å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œè€Œä¸”åªèƒ½åœ¨æ•°æ®å˜åŒ–åï¼Œé€šè¿‡æµ…æ¯”è¾ƒï¼ˆæˆ–è€…æ·±æ¯”è¾ƒï¼‰çš„æ–¹å¼å¯¹æ¯”å‰åçš„æ•°æ®æ˜¯å¦ä¸€è‡´ï¼Œæ¥é˜»æ­¢æ— æ•ˆæ¸²æŸ“ã€‚ï¼ˆMobxåŸºæœ¬åŒç†ï¼‰</li><li>åªèƒ½é€šè¿‡çŠ¶æ€æå‡è‡³å…¬å…±ç¥–å…ˆæ¥å…±äº«çŠ¶æ€ï¼Œä½†å¯èƒ½å¯¼è‡´ä¸€é¢—å·¨å¤§çš„æ ‘é‡æ–°æ¸²æŸ“ã€‚</li><li>ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰åªèƒ½å­˜å‚¨ä¸€ä¸ªå€¼ï¼Œè€Œä¸èƒ½å­˜å‚¨ä¸€ç»„ä¸ç¡®å®šçš„å€¼ï¼Œä¸”æ¯ä¸ªå€¼éƒ½æœ‰è‡ªå·±çš„ä½¿ç”¨è€…ï¼ˆconsumersï¼‰ã€‚</li><li>è¿™ä¸¤ç§æ–¹å¼éƒ½å¾ˆéš¾å°†ç»„ä»¶æ ‘çš„å¶å­èŠ‚ç‚¹ï¼ˆä½¿ç”¨çŠ¶æ€çš„åœ°æ–¹ï¼‰ä¸ç»„ä»¶æ ‘çš„é¡¶å±‚ï¼ˆçŠ¶æ€å¿…é¡»å­˜åœ¨çš„åœ°æ–¹ï¼‰è¿›è¡Œä»£ç åˆ†æ‹†ã€‚</li></ul><h3 id="3-7-Context"><a href="#3-7-Context" class="headerlink" title="3.7. Context"></a>3.7. Context</h3><p>å¦‚æœä»…ä»…åœ¨ä¾èµ–æ•°æ®å˜åŒ–æ—¶å€™æ‰æ›´æ–°çš„åœºæ™¯ï¼Œä½¿ç”¨Contextå¯ä»¥å®Œç¾çš„è§£å†³ï¼Œå½“Contextçš„æ•°æ®å˜åŒ–æ—¶ï¼Œåªæœ‰ç›‘å¬äº†ç›¸å…³Contextçš„ç»„ä»¶æ‰ä¼šé‡æ–°æ¸²æŸ“ã€‚ä½†Contextçš„é—®é¢˜æ˜¯è¿‡äºåŠ¨æ€æ€§çš„åœºæ™¯å¯èƒ½æœ‰äº›è®¸é—®é¢˜ï¼Œæ¯”å¦‚ç”¨æˆ·é€šè¿‡ç‚¹å‡»æŒ‰é’®æ·»åŠ å†…éƒ¨çš„æŸä¸ªå°ç»„ä»¶ï¼Œè¿™æ ·çš„è¯ å¯¹åº”çš„Contextä¹Ÿéœ€è¦åŠ¨æ€çš„æ’å…¥åˆ°é¡¶å±‚ç»„ä»¶ï¼Œæ–¹ä¾¿å…±äº«æ•°æ®ç»™å…¶ä»–ç»„ä»¶ï¼Œä½†æ˜¯ç”±äºReactçš„diffç­–ç•¥ï¼Œå¦‚æœåœ¨é¡¶å±‚ç»„ä»¶åŠ¨æ€æ’å…¥Contextæˆ–ä»»ä½•ç»„ä»¶ï¼Œå°±ä¼šå¯¼è‡´å­ç»„ä»¶æ ‘ä¸æ–­è¢« é”€æ¯é‡å»ºï¼ŒæŸè€—æ€§èƒ½ã€‚</p><h1 id="å››ã€Recoilä»‹ç»"><a href="#å››ã€Recoilä»‹ç»" class="headerlink" title="å››ã€Recoilä»‹ç»"></a>å››ã€Recoilä»‹ç»</h1><p>Recoilçš„è®¾è®¡æ€æƒ³å°±æ˜¯æˆ‘ä»¬æŠŠçŠ¶æ€æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„Atomï¼ˆåŸå­ï¼‰ï¼Œå†ç”±Selectoræ´¾ç”Ÿå‡ºæ›´å¤šçš„çŠ¶æ€ï¼Œæœ€åReactçš„ç»„ä»¶æ ‘è®¢é˜…è‡ªå·±éœ€è¦çš„çŠ¶æ€ï¼Œå½“æœ‰åŸå­çŠ¶æ€æ›´æ–°ï¼Œåªæœ‰æ”¹å˜çš„åŸå­åŠå…¶ä¸‹æ¸¸èŠ‚ç‚¹æœ‰è®¢é˜…ä»–ä»¬çš„ç»„ä»¶æ‰ä¼šæ›´æ–°ã€‚</p><p>Copyï¼šä¹Ÿå°±æ˜¯è¯´ï¼ŒRecoilå…¶å®æ„å»ºäº†ä¸€ä¸ª<a href="https://zh.wikipedia.org/wiki/%E6%9C%89%E5%90%91%E6%97%A0%E7%8E%AF%E5%9B%BE" target="_blank" rel="noopener">æœ‰å‘æ— ç¯å›¾</a>ï¼Œè¿™ä¸ªå›¾å’ŒReactç»„ä»¶æ ‘æ­£äº¤ï¼Œä»–çš„çŠ¶æ€å’ŒReactç»„ä»¶æ ‘æ˜¯å®Œå…¨è§£è€¦çš„ã€‚</p><p>Recoilç‹¬ç«‹äºReactï¼Œå•ç‹¬æ„å»ºå‡ºä¸€å¥—è‡ªå·±çš„çŠ¶æ€æ ‘ï¼Œè¿™ä¸ªçŠ¶æ€æ ‘å¹³è¡Œäºç»„ä»¶æ ‘è€Œå­˜åœ¨ï¼ŒçŠ¶æ€æ ‘ç”±Atomå’ŒSelectoræ„æˆã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7xh4r6kdnj30y20u00v9.jpg" alt="img"></p><p>çŠ¶æ€æ ‘çš„åŸºæœ¬å•ä½æ˜¯Atomï¼ˆåŸå­ï¼‰ï¼Œä¸€ä¸ªAtomè¡¨ç¤ºä¸€ä»½å¯å˜ï¼Œå¯è¢«è®¢é˜…çš„çŠ¶æ€ï¼Œå½“Atomä»£è¡¨çš„çŠ¶æ€æ”¹å˜æ—¶ï¼Œåªä¼šé‡æ–°æ¸²æŸ“è®¢é˜…äº†è¿™ä¸ªAtomçš„ç»„ä»¶ï¼Œè€Œä¸ä¼šå½±å“å…¶ä»–ç»„ä»¶ã€‚</p><h1 id="äº”ã€Recoilä½¿ç”¨"><a href="#äº”ã€Recoilä½¿ç”¨" class="headerlink" title="äº”ã€Recoilä½¿ç”¨"></a>äº”ã€Recoilä½¿ç”¨</h1><p>Recoilæ˜¯ä¸“é—¨ä¸ºReactè®¾è®¡çš„çŠ¶æ€ç®¡ç†åº“ï¼Œä»–çš„APIæ»¡æ»¡çš„â€œreacté£æ ¼â€ã€‚ Recoil åªæ”¯æŒhooks APIï¼Œåœ¨ä½¿ç”¨ä¸Šæ¥è¯´å¯ä»¥è¯´ååˆ†ç®€æ´ã€‚</p><h4 id="5-1-RecoilRoot"><a href="#5-1-RecoilRoot" class="headerlink" title="5.1 RecoilRoot"></a>5.1 RecoilRoot</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom/client'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; RecoilRoot &#125; <span class="keyword">from</span> <span class="string">'recoil'</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = ReactDOM.createRoot(</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>) <span class="keyword">as</span> HTMLElement</span><br><span class="line">);</span><br><span class="line">root.render(</span><br><span class="line">  &lt;React.StrictMode&gt;</span><br><span class="line">    &lt;RecoilRoot&gt;</span><br><span class="line">      &lt;React.Suspense fallback=&#123;&lt;div&gt;Loading...&lt;<span class="regexp">/div&gt;&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &lt;App /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/React.Suspense&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>RecoilRoot&gt;</span><br><span class="line">  &lt;<span class="regexp">/React.StrictMode&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure><h5 id="useRecoilState"><a href="#useRecoilState" class="headerlink" title="useRecoilState"></a>useRecoilState</h5><p>å½“ç»„ä»¶åŒæ—¶éœ€è¦è¯»å†™çŠ¶æ€æ—¶ï¼Œæ¨èä½¿ç”¨è¯¥ hookã€‚</p><p><code>const [comState, setComState] = useRecoilState(commonState);</code></p><h5 id="useRecoilValue"><a href="#useRecoilValue" class="headerlink" title="useRecoilValue"></a>useRecoilValue</h5><p>å½“ä¸€ä¸ªç»„ä»¶éœ€è¦åœ¨ä¸å†™å…¥ state çš„æƒ…å†µä¸‹è¯»å– state æ—¶ï¼Œæ¨èä½¿ç”¨è¯¥ hookã€‚</p><p><code>const comState1 = useRecoilValue(commonState);</code></p><h5 id="useSetRecoilState"><a href="#useSetRecoilState" class="headerlink" title="useSetRecoilState"></a>useSetRecoilState</h5><p>â€‹    è¿”å›ä¸€ä¸ª setter å‡½æ•°ï¼Œç”¨æ¥æ›´æ–°å¯å†™ Recoil state çš„å€¼ï¼ŒçŠ¶æ€å˜åŒ–ä¸ä¼šå¯¼è‡´ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p><p>â€‹    å½“ä¸€ä¸ªç»„ä»¶éœ€è¦å†™å…¥è€Œä¸éœ€è¦è¯»å– state æ—¶ï¼Œæ¨èä½¿ç”¨æ­¤ hookã€‚</p><p>â€‹    å¦‚æœç»„ä»¶ä½¿ç”¨äº† <code>useRecoilState()</code>æ¥è·å– setter å‡½æ•°ï¼Œé‚£ä¹ˆåŒæ—¶å®ƒä¹Ÿä¼šè®¢é˜…æ›´æ–°ï¼Œå¹¶åœ¨ atom æˆ– selector æ›´æ–°æ—¶é‡æ–°æ¸²æŸ“ã€‚ä½¿ç”¨ <code>useSetRecoilState()</code> å…è®¸ç»„ä»¶åœ¨å€¼å‘ç”Ÿæ”¹å˜æ—¶è€Œä¸ç”¨ç»™ç»„ä»¶è®¢é˜…é‡æ–°æ¸²æŸ“çš„æƒ…å†µä¸‹è®¾ç½®å€¼ã€‚</p><p><code>const setComState = useSetRecoilState(commonState);</code></p><h4 id="5-2-Atom"><a href="#5-2-Atom" class="headerlink" title="5.2 Atom"></a>5.2 Atom</h4><p>ä¸€ä¸ª <strong>atom</strong> ä»£è¡¨ä¸€ä¸ª<strong>çŠ¶æ€</strong>ã€‚Atom å¯åœ¨ä»»æ„ç»„ä»¶ä¸­è¿›è¡Œè¯»å†™ã€‚è¯»å– atom å€¼çš„ç»„ä»¶éšå¼<strong>è®¢é˜…</strong>äº†è¯¥ atomï¼Œå› æ­¤ä»»ä½• atom çš„æ›´æ–°éƒ½å°†å¯¼è‡´è®¢é˜…è¯¥ atom çš„ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;atom&#125; <span class="keyword">from</span> <span class="string">"recoil"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> textState = atom(&#123;</span><br><span class="line">  key: <span class="string">'textState'</span>, <span class="comment">// // å…¨å±€ä¸‹ä¿æŒå”¯ä¸€æ€§</span></span><br><span class="line">  <span class="keyword">default</span>: <span class="string">''</span>, <span class="comment">// åˆå§‹å€¼</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åœ¨éœ€è¦å‘ atom è¯»å–æˆ–å†™å…¥çš„ç»„ä»¶ä¸­ï¼Œåº”è¯¥ä½¿ç”¨ <code>useRecoilState()</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useRecoilState, useRecoilValue, useSetRecoilState&#125; <span class="keyword">from</span> <span class="string">"recoil"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;textState, charCountState&#125; <span class="keyword">from</span> <span class="string">"../store/"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">HomePage</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h3&gt;HomePage&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">        &lt;TextInput /</span>&gt;</span><br><span class="line">        &lt;CharacterCount /&gt;</span><br><span class="line">        &lt;SetButton /&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function TextInput() &#123;</span></span><br><span class="line"><span class="regexp">  const [text, setText] = useRecoilState(textState);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  const onChange = event =&gt; &#123;</span></span><br><span class="line"><span class="regexp">    setText(event.target.value);</span></span><br><span class="line"><span class="regexp">  &#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;input type="text" value=&#123;text&#125; onChange=&#123;onChange&#125; /</span>&gt;</span><br><span class="line">      &lt;p&gt;<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span> Echo: &#123;text&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="5-3-Selector"><a href="#5-3-Selector" class="headerlink" title="5.3 Selector"></a>5.3 Selector</h4><p><strong>selector</strong> ä»£è¡¨ä¸€ä¸ª<strong>æ´¾ç”ŸçŠ¶æ€</strong>ï¼Œæ´¾ç”ŸçŠ¶æ€æ˜¯çŠ¶æ€çš„<strong>è½¬æ¢</strong>ã€‚ä½ å¯ä»¥å°†æ´¾ç”ŸçŠ¶æ€è§†ä¸ºå°†çŠ¶æ€ä¼ é€’ç»™ä»¥æŸç§æ–¹å¼ä¿®æ”¹ç»™å®šçŠ¶æ€çš„çº¯å‡½æ•°çš„è¾“å‡ºï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;selector&#125; <span class="keyword">from</span> <span class="string">"recoil"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> charCountState = selector(&#123;</span><br><span class="line">  key: <span class="string">'charCountState'</span>, <span class="comment">// å…¨å±€ä¸‹ä¿æŒå”¯ä¸€æ€§</span></span><br><span class="line">  get: <span class="function">(<span class="params">&#123;get&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> text = get(textState);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> text.length;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæƒ³è¦è·å–textStateçš„é•¿åº¦ï¼Œå› æ­¤åªéœ€è¯»å–å€¼å°±å¯ä»¥ äº†ï¼Œå¯ä»¥ä½¿ç”¨ <code>useRecoilValue()</code> è¿™ä¸€ hookï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useRecoilValue&#125; <span class="keyword">from</span> <span class="string">"recoil"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CharacterCount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> count = useRecoilValue(charCountState);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Character Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å…­ã€Example"><a href="#å…­ã€Example" class="headerlink" title="å…­ã€Example"></a>å…­ã€Example</h1><p><a href="https://github.com/kitions/my-app-recoil" target="_blank" rel="noopener">ToListåº”ç”¨</a></p><h1 id="ä¸ƒã€æ€»ç»“"><a href="#ä¸ƒã€æ€»ç»“" class="headerlink" title="ä¸ƒã€æ€»ç»“"></a>ä¸ƒã€æ€»ç»“</h1><p>è™½ç„¶Reactç›¸å…³çš„çŠ¶æ€ç®¡ç†åº“å¾ˆå¤šï¼Œä½†æ˜¯Recoilçš„ä¸€äº›æ€æƒ³è¿˜æ˜¯éå¸¸å…ˆè¿›çš„ï¼Œç¤¾åŒºå¯¹Recoilå…³æ³¨åº¦ä¹Ÿå¾ˆé«˜ï¼Œç›®å‰ star 18kã€‚ä½†è¿˜æ˜¯è·Ÿä¸Šè¿°çš„æ³¨æ„äº‹é¡¹ä¸€æ ·ï¼Œè¿˜ä¸æ˜¯ç¨³å®šç‰ˆæœ¬ï¼Œnpmä¸‹è½½é‡å¹¶ä¸æ˜¯ç‰¹åˆ«é«˜ï¼Œå¤§é¡¹ç›®ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ä¸æ¨èã€‚</p><h1 id="é™„1-ç®€æ˜“ç‰ˆRecoil"><a href="#é™„1-ç®€æ˜“ç‰ˆRecoil" class="headerlink" title="é™„1. ç®€æ˜“ç‰ˆRecoil"></a>é™„1. ç®€æ˜“ç‰ˆRecoil</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState, useEffect, useCallback &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// An interface with the disconnect method. This could just be a function</span></span><br><span class="line"><span class="comment">// but I think having it as an object is more readable.</span></span><br><span class="line">interface Disconnect &#123;</span><br><span class="line">    disconnect: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// `Stateful` is the base class that manages states and subscriptions.</span></span><br><span class="line"><span class="comment">// Both Atom and Selector are derived from it.</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Stateful</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// This is a set of unique callbacks. The callbacks are listeners</span></span><br><span class="line">    <span class="comment">// that have subscribed</span></span><br><span class="line">    private listeners = <span class="keyword">new</span> <span class="built_in">Set</span>&lt;<span class="function">(<span class="params">value: T</span>) =&gt;</span> <span class="keyword">void</span>&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The value property is protected because it needs to be manually</span></span><br><span class="line">    <span class="comment">// assigned in the constructor (because of inheritance quirks)</span></span><br><span class="line">    <span class="keyword">constructor</span>(protected value: T) &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Simple method for returning the state. This could return a deep</span></span><br><span class="line">    <span class="comment">// copy if you wanted to be extra cautious.</span></span><br><span class="line">    snapshot(): T &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The emit method is what updates all the listeners with the new state</span></span><br><span class="line">    private emit() &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> listener <span class="keyword">of</span> <span class="built_in">Array</span>.from(<span class="keyword">this</span>.listeners)) &#123;</span><br><span class="line">            listener(<span class="keyword">this</span>.snapshot());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The update method is the canonical way to set state. It uses object</span></span><br><span class="line">    <span class="comment">// equality to prevent unnecessary renders. A deep comparison could be</span></span><br><span class="line">    <span class="comment">// performed for complex objects that are often re-created but are the</span></span><br><span class="line">    <span class="comment">// same.</span></span><br><span class="line">    protected update(value: T) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.value !== value) &#123;</span><br><span class="line">            <span class="keyword">this</span>.value = value;</span><br><span class="line">            <span class="comment">// After updating the value, let all the listeners know there's a</span></span><br><span class="line">            <span class="comment">// new state.</span></span><br><span class="line">            <span class="keyword">this</span>.emit();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The subscribe method lets consumers listen for state updates. Calling</span></span><br><span class="line">    <span class="comment">// the `disconnect` method will stop the callback from being called in</span></span><br><span class="line">    <span class="comment">// the future.</span></span><br><span class="line">    subscribe(callback: <span class="function">(<span class="params">value: T</span>) =&gt;</span> <span class="keyword">void</span>): Disconnect &#123;</span><br><span class="line">        <span class="keyword">this</span>.listeners.add(callback);</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            disconnect: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.listeners.delete(callback);</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The atom is a thin wrapper around the `Stateful` base class. It has a</span></span><br><span class="line"><span class="comment">// single method for updating the state.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Note: `useState` allows you to pass a reducer function, you could add support</span></span><br><span class="line"><span class="comment">// for this if you wanted.</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Atom</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Stateful</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    public setState(value: T) &#123;</span><br><span class="line">        <span class="keyword">super</span>.update(value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The Recoil selector function is a bit gnarley. Essentially the "get" function</span></span><br><span class="line"><span class="comment">// is the way that selectors can subscribe to other selectors and atoms.</span></span><br><span class="line">type SelectorGenerator&lt;T&gt; = <span class="function">(<span class="params">context: &#123; get: &lt;V&gt;(dep: Stateful&lt;V&gt;</span>) =&gt;</span> V &#125;) =&gt; T;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The selector class. It extends `Stateful` so that it can be used as a value like</span></span><br><span class="line"><span class="comment">// atoms.</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Selector</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Stateful</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// Keep track of all the registered dependencies. We want to make sure we only</span></span><br><span class="line">    <span class="comment">// re-render once when they change.</span></span><br><span class="line">    private registeredDeps = <span class="keyword">new</span> <span class="built_in">Set</span>&lt;Stateful&lt;any&gt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// When the get function is called, it allows consumers to subscribe to state</span></span><br><span class="line">    <span class="comment">// changes. This method subscribes to the dependency if it hasn't been already,</span></span><br><span class="line">    <span class="comment">// then returns it's value.</span></span><br><span class="line">    private addDep&lt;V&gt;(dep: Stateful&lt;V&gt;): V &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.registeredDeps.has(dep)) &#123;</span><br><span class="line">            dep.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.updateSelector());</span><br><span class="line">            <span class="keyword">this</span>.registeredDeps.add(dep);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dep.snapshot();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A helper method for running the internal generator method, updating dependencies,</span></span><br><span class="line">    <span class="comment">// returning the computed state and updating all listeners.</span></span><br><span class="line">    private updateSelector() &#123;</span><br><span class="line">        <span class="keyword">this</span>.update(<span class="keyword">this</span>.generate(&#123; <span class="attr">get</span>: <span class="function"><span class="params">dep</span> =&gt;</span> <span class="keyword">this</span>.addDep(dep) &#125;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(private readonly generate: SelectorGenerator&lt;T&gt;) &#123;</span><br><span class="line">        <span class="comment">// This needs to be undefined initially because of Typescript's inheritance rules</span></span><br><span class="line">        <span class="comment">// It's effectively "initialised memory"</span></span><br><span class="line">        <span class="keyword">super</span>(<span class="literal">undefined</span> <span class="keyword">as</span> any);</span><br><span class="line">        <span class="keyword">this</span>.value = generate(&#123; <span class="attr">get</span>: <span class="function"><span class="params">dep</span> =&gt;</span> <span class="keyword">this</span>.addDep(dep) &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A helper function for creating a new Atom</span></span><br><span class="line"><span class="comment">// The `key` member is currently unused. I just kept it around to maintain a similar</span></span><br><span class="line"><span class="comment">// API to Recoil.</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">atom</span>&lt;<span class="title">V</span>&gt;(<span class="params">value: &#123; key: string; default: V &#125;</span>): <span class="title">Atom</span>&lt;<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Atom(value.default);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A helper method for creating a new Selector</span></span><br><span class="line"><span class="comment">// Likewise the `key` method is just for looking like Recoil.</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">selector</span>&lt;<span class="title">V</span>&gt;(<span class="params">value: &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    key: string;</span></span></span><br><span class="line"><span class="function"><span class="params">    get: SelectorGenerator&lt;V&gt;;</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>): <span class="title">Selector</span>&lt;<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Selector(value.get);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This hook will re-render whenever the supplied `Stateful` value changes.</span></span><br><span class="line"><span class="comment">// It can be used with `Selector`s or `Atom`s.</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">useCoiledValue</span>&lt;<span class="title">T</span>&gt;(<span class="params">value: Stateful&lt;T&gt;</span>): <span class="title">T</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [, updateState] = useState(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">    useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; disconnect &#125; = value.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> updateState(&#123;&#125;));</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> disconnect();</span><br><span class="line">    &#125;, [value]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> value.snapshot();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Similar to the above method, but it also lets you set state.</span></span><br><span class="line">export function useCoiledState&lt;T&gt;(atom: Atom&lt;T&gt;): [T, (value: T) =&gt; void] &#123;</span><br><span class="line">    <span class="keyword">const</span> value = useCoiledValue(atom);</span><br><span class="line">    <span class="keyword">return</span> [value, useCallback(<span class="function"><span class="params">value</span> =&gt;</span> atom.setState(value), [atom])];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ol><li><a href="https://recoiljs.org/zh-hans/" target="_blank" rel="noopener">Recoilå®˜ç½‘</a></li><li><a href="https://juejin.cn/post/6936117926713884686" target="_blank" rel="noopener">React ä¸‹ä¸€ä»£çŠ¶æ€ç®¡ç†åº“ Recoil by å­—èŠ‚</a></li><li>ğŸ‘ğŸ»<a href="https://juejin.cn/post/7006253866610229256" target="_blank" rel="noopener">Reactä¸‹ä¸€ä»£çŠ¶æ€ç®¡ç†åº“â€”â€”recoil by å¤´æ¡å‰ç«¯</a></li><li><a href="https://juejin.cn/post/6889763592947564551" target="_blank" rel="noopener">Recoil ç”¨æ³•åŠåŸç†æµ…æ</a></li></ol>]]></content>
    
    <summary type="html">
    
      Recoil çš„äº§ç”Ÿæºäº Facebook å†…éƒ¨ä¸€ä¸ªå¯è§†åŒ–æ•°æ®åˆ†æç›¸å…³çš„åº”ç”¨ï¼Œåœ¨ä½¿ç”¨ React çš„å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºç°æœ‰çŠ¶æ€ç®¡ç†å·¥å…·ä¸èƒ½å¾ˆå¥½çš„æ»¡è¶³åº”ç”¨çš„éœ€æ±‚ï¼Œå› æ­¤å‚¬ç”Ÿå‡ºäº† Recoil ã€‚
    
    </summary>
    
      <category term="React" scheme="https://kitions.github.io/categories/React/"/>
    
    
      <category term="React" scheme="https://kitions.github.io/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>Git LFSå¤§æ–‡ä»¶</title>
    <link href="https://kitions.github.io/2022/07/26/220726Git%20LFS%E5%A4%A7%E6%96%87%E4%BB%B6/"/>
    <id>https://kitions.github.io/2022/07/26/220726Git LFSå¤§æ–‡ä»¶/</id>
    <published>2022-07-26T03:55:15.000Z</published>
    <updated>2022-10-17T03:30:46.826Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Git-LFSå¤§æ–‡ä»¶"><a href="#Git-LFSå¤§æ–‡ä»¶" class="headerlink" title="Git LFSå¤§æ–‡ä»¶"></a>Git LFSå¤§æ–‡ä»¶</h1><h4 id="ä»€ä¹ˆæ˜¯git-lfs"><a href="#ä»€ä¹ˆæ˜¯git-lfs" class="headerlink" title="ä»€ä¹ˆæ˜¯git lfs"></a>ä»€ä¹ˆæ˜¯git lfs</h4><p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgit-lfs.github.com%2F" target="_blank" rel="noopener">Git LFS</a>ï¼ˆLarge File Storageï¼‰ï¼Œç”¨ä»¥å¸®åŠ©gitç®¡ç†æ¯”è¾ƒå¤§çš„æ–‡ä»¶ã€‚gitçš„diffç­‰æ˜¯åŸºäºæ–‡ä»¶ã€‚å¯¹äºäºŒè¿›åˆ¶æ–‡ä»¶æ¥è¯´ï¼Œgitéœ€è¦å­˜å‚¨æ¯æ¬¡æäº¤çš„å˜åŠ¨ã€‚git flså¯¹äºè¿½è¸ªçš„æ–‡ä»¶åªä¼šä¿å­˜ä¸€ä¸ªæŒ‡å‘å…¶çš„æŒ‡é’ˆã€‚ä¸ä¼šåœ¨æœ¬åœ°ä»“åº“ä¿å­˜ä½ æ¯æ¬¡æäº¤çš„æ‰€æœ‰ç‰ˆæœ¬ã€‚å¯¹äºå†å²æäº¤ç‰ˆæœ¬ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬éƒ½å¾ˆå°‘å»åŠ¨ï¼Œä¸éœ€è¦æ£€å‡ºã€‚æ‰€ä»¥è¿™æ ·æå¤§çš„èŠ‚çœäº†ç©ºé—´å’Œä»“åº“æ‹‰å–é€Ÿåº¦ã€‚<br> <strong>æ ¸å¿ƒ</strong>ï¼šæŠŠéœ€è¦è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€ä½†æ˜¯å ç”¨å¾ˆå¤§ç©ºé—´çš„æ–‡ä»¶ç‹¬ç«‹äºGitä»“åº“ç®¡ç†ï¼ŒåŠ å¿«cloneä»“åº“é€Ÿåº¦ã€‚</p><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p>lfsç›®å‰æ˜¯gitæ‰©å±•ï¼Œæ²¡æœ‰è¢«åŠ å…¥gitæ ¸å¿ƒã€‚æ‰€ä»¥å°±éœ€è¦æœ‰ä¸ªå®‰è£…çš„æ­¥éª¤ã€‚<br> <strong>æ³¨æ„</strong>ï¼šå®‰è£…git lfséœ€è¦ gitç‰ˆæœ¬&gt;=1.8.2</p><p><strong>Mac</strong></p><ol><li>å®‰è£…homebrew(å®‰è£…è¿‡çš„ä¸‹ä¸€æ­¥)</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure><ol><li>brew install git-lfs</li><li>git lfs install</li></ol><p><strong>Windows</strong></p><ol><li>ä¸‹è½½å®‰è£…<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fgit-lfs%2Fgit-lfs%2Freleases" target="_blank" rel="noopener">windows installer</a></li><li>è¿è¡Œwindows installer</li><li>git lfs install</li></ol><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p>cdè¿›é¡¹ç›®ç›®å½•<br> é¦–å…ˆgit lfs track â€XXâ€œæ¥å‘Šè¯‰lfséœ€è¦å¤„ç†å“ªäº›æ–‡ä»¶ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git lfs track <span class="string">"*.a"</span>  <span class="comment">// è¿½è¸ªæ‰€æœ‰åç¼€ä¸ºaçš„æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤æ‰§è¡Œåï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºâ€.gitattributesâ€œçš„æ–‡ä»¶ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat .gitattributes      </span><br><span class="line">xx.a <span class="built_in">filter</span>=lfs diff=lfs merge=lfs -text</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š.gitattributesæ–‡ä»¶æ˜¯éœ€è¦åŠ å…¥ç‰ˆæœ¬æ§åˆ¶çš„ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">add</span> .gitattributes</span><br><span class="line">git <span class="keyword">add</span> xx.a</span><br><span class="line">git commit -m <span class="string">"Add xx.a"</span></span><br></pre></td></tr></table></figure><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><ol><li><code>git lfs ls-files</code> å¯ä»¥æ˜¾ç¤ºå½“å‰è¢«lfsè¿½è¸ªçš„æ–‡ä»¶åˆ—è¡¨</li><li><code>git lfs track</code> æŸ¥çœ‹ç°æœ‰çš„æ–‡ä»¶è¿½è¸ªæ¨¡å¼</li><li><code>git lfs untrack &quot;*xx.a&quot;</code> å–æ¶ˆgit flså¯¹xx.açš„è¿½è¸ªç®¡ç†</li><li><code>git lfs version</code> æŸ¥çœ‹å½“å‰æ‰€ç”¨git lfsç‰ˆæœ¬</li><li><code>git lfs pull</code> å¦‚æœèµ·ä¹‹å‰æ‹‰ä»£ç æ—¶ï¼Œæ²¡æœ‰åŒæ—¶è·å–lfså¯¹è±¡ï¼Œä¹‹ååˆéœ€è¦å°†è¢«lfsè¿½è¸ªçš„æ–‡ä»¶æ—¶ï¼Œå¯æ‰§è¡Œæ­¤å‘½ä»¤æ¥æ‹‰å–</li></ol><h4 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h4><p><a href="https://help.aliyun.com/document_detail/206889.html" target="_blank" rel="noopener">é˜¿é‡Œäº‘ - å¦‚ä½•ä½¿ç”¨ Git LFS</a></p>]]></content>
    
    <summary type="html">
    
      Git LFSå¤§æ–‡ä»¶ä»‹ç»å’Œä½¿ç”¨
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="git" scheme="https://kitions.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Gité¡¹ç›®è¿‡å¤§ï¼Œ.gitå†å²å¤§æ–‡ä»¶æ¸…ç†</title>
    <link href="https://kitions.github.io/2022/07/25/220725Git%E9%A1%B9%E7%9B%AE%E8%BF%87%E5%A4%A7%20%E5%A4%A7%E6%96%87%E4%BB%B6%E6%B8%85%E7%90%86/"/>
    <id>https://kitions.github.io/2022/07/25/220725Gité¡¹ç›®è¿‡å¤§ å¤§æ–‡ä»¶æ¸…ç†/</id>
    <published>2022-07-25T09:25:57.000Z</published>
    <updated>2022-10-17T03:30:46.826Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Gité¡¹ç›®è¿‡å¤§ï¼Œ-gitå†å²å¤§æ–‡ä»¶æ¸…ç†"><a href="#Gité¡¹ç›®è¿‡å¤§ï¼Œ-gitå†å²å¤§æ–‡ä»¶æ¸…ç†" class="headerlink" title="Gité¡¹ç›®è¿‡å¤§ï¼Œ.gitå†å²å¤§æ–‡ä»¶æ¸…ç†"></a>Gité¡¹ç›®è¿‡å¤§ï¼Œ.gitå†å²å¤§æ–‡ä»¶æ¸…ç†</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rev-list --objects --all | grep &quot;$(git verify-pack -v .git/objects/pack/*.idx | sort -k 3 -n | tail -5 | awk &apos;&#123;print$1&#125;&apos;)&quot;</span><br></pre></td></tr></table></figure><blockquote><p><code>rev-list</code>å‘½ä»¤ç”¨æ¥åˆ—å‡ºGitä»“åº“ä¸­çš„æäº¤ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥åˆ—å‡ºæ‰€æœ‰æäº¤ä¸­æ¶‰åŠçš„æ–‡ä»¶ååŠå…¶IDã€‚ è¯¥å‘½ä»¤å¯ä»¥æŒ‡å®šåªæ˜¾ç¤ºæŸä¸ªå¼•ç”¨ï¼ˆæˆ–åˆ†æ”¯ï¼‰çš„ä¸Šä¸‹æ¸¸çš„æäº¤ã€‚</p><p><code>--objects</code>ï¼šåˆ—å‡ºè¯¥æäº¤æ¶‰åŠçš„æ‰€æœ‰æ–‡ä»¶IDã€‚</p><p><code>--all</code>ï¼šæ‰€æœ‰åˆ†æ”¯çš„æäº¤ï¼Œç›¸å½“äºæŒ‡å®šäº†ä½äº/refsä¸‹çš„æ‰€æœ‰å¼•ç”¨ã€‚</p><p><code>verify-pack</code>å‘½ä»¤ç”¨äºæ˜¾ç¤ºå·²æ‰“åŒ…çš„å†…å®¹ã€‚</p></blockquote><h1 id="Function-1ï¼š"><a href="#Function-1ï¼š" class="headerlink" title="Function  1ï¼š"></a>Function  1ï¼š</h1><p>gitå¦‚ä½•æ°¸ä¹…åˆ é™¤å†å²æ–‡ä»¶ï¼ˆä¸å°å¿ƒæäº¤çš„å¯†ç ã€buildã€ äºŒè¿›åˆ¶ç­‰ å‡å¯ä»¥åˆ é™¤ï¼‰ å¦‚æœçŸ¥é“è¦åˆ é™¤çš„æ–‡ä»¶å¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼ˆå®é™…ä½¿ç”¨è¿‡ç¨‹æŠŠbuild æ›¿æ¢æˆè‡ªå·±çš„æ–‡ä»¶è·¯å¾„ï¼Œ æˆ‘è¿™é‡Œä¸ä¿ç•™cacheåˆ°ç£ç›˜ ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git filter-branch --force --index-filter &apos;git rm -rf --ignore-unmatch build&apos; --prune-empty --tag-name-filter cat -- --all</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦ä¿ç•™æ–‡ä»¶åˆ°ç£ç›˜å¯ä½¿ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git filter-branch --force --index-filter &apos;git rm --cached -r --ignore-unmatch build&apos; --prune-empty --tag-name-filter cat -- --all</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸çŸ¥é“è¦åˆ é™¤çš„æ–‡ä»¶æ˜¯å“ªä¸ªå¯¼è‡´ä»“åº“å¤§å¯å…ˆæŸ¥æ‰¾å¤§æ–‡ä»¶ï¼ˆä¹Ÿå¯ä»¥ç”¨bfgå·¥å…·ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rev-list --objects --all | grep &quot;$(git verify-pack -v .git/objects/pack/*.idx | sort -k 3 -n | tail -5 | awk &apos;&#123;print$1&#125;&apos;)&quot;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å¯èƒ½éœ€è¦å¾ˆä¹…ï¼Œå®Œæˆåå‡ºç°ç±»ä¼¼ä¸‹é¢çš„æç¤ºå°±æ ‡ç¤ºåˆ é™¤æˆåŠŸ Rewrite xxxx (266â„266)</p><h2 id="Ref-â€˜refs-heads-masterâ€™-was-rewritten"><a href="#Ref-â€˜refs-heads-masterâ€™-was-rewritten" class="headerlink" title="Ref â€˜refs/heads/masterâ€™ was rewritten"></a>Ref â€˜refs/heads/masterâ€™ was rewritten</h2><p>å¼ºåˆ¶æ¨é€åˆ°remote git push origin master â€“force æ¥ä¸‹æ¥å¯¹git ä»“åº“è¿›è¡Œç˜¦èº«ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rm -rf .git/refs/original/</span><br><span class="line">git reflog expire --expire=now --all</span><br><span class="line">git gc --prune=now</span><br><span class="line">git gc --aggressive --prune=now</span><br></pre></td></tr></table></figure><p>æˆªæ­¢æ‰§è¡Œæœ€å…³é”®çš„ä¸€æ­¥ï¼Œä¹Ÿæ˜¯æœ€å±é™©çš„ä¸€æ­¥ï¼ˆåŒæ­¥.gitåˆ°è¿œç«¯ï¼‰ï¼Œå¥½å¤šäººè¯´æ‰§è¡Œå®Œä¸Šé¢çš„remoteçš„ä»“åº“å¤§å°ä¸å˜ï¼Œé‡æ–°å…‹éš†ä¸‹æ¥ä¾ç„¶å¾ˆå¤§ï¼Œå…¶å®æ˜¯å› ä¸ºæ²¡æœ‰åŒæ­¥gc åçš„ä»“åº“åˆ°è¿œç«¯ï¼Œæ‰§è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**git push --mirror**</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š </p><p><a href="https://www.cnblogs.com/shines77/p/3460274.html" target="_blank" rel="noopener">Gitå¦‚ä½•æ°¸ä¹…åˆ é™¤æ–‡ä»¶(åŒ…æ‹¬å†å²è®°å½•)</a><br><a href="https://docs.github.com/cn/free-pro-team@latest/github/managing-large-files/removing-files-from-a-repositorys-history" target="_blank" rel="noopener">ä»ä»“åº“çš„å†å²è®°å½•ä¸­åˆ é™¤æ–‡ä»¶</a><br><a href="http://palanceli.com/2017/12/18/2017/1218GitReduceSize/" target="_blank" rel="noopener">gitç˜¦èº«</a><br><a href="https://blog.walterlv.com/git/2017/09/18/delete-a-file-from-whole-git-history.html" target="_blank" rel="noopener">å½»åº•åˆ é™¤ Git ä»“åº“ä¸­çš„æ–‡ä»¶é¿å…å ç”¨å¤§é‡ç£ç›˜ç©ºé—´</a><br><a href="https://rtyley.github.io/bfg-repo-cleaner/#usage" target="_blank" rel="noopener">BFG an alternative to git-filter-branch</a><br><a href="https://linux.cn/article-8556-1.html" target="_blank" rel="noopener">å¦‚ä½•ç˜¦èº« Git ä»“åº“</a><br><a href="http://iissnan.com/progit/about.html" target="_blank" rel="noopener">progit</a></p><p><a href="https://itcn.blog/p/201079769.html" target="_blank" rel="noopener">Gitä»“åº“ç˜¦èº«â€“æ¸…é™¤é¡¹ç›®gitä»“åº“å¤§æ–‡ä»¶</a></p><h1 id="Function-2ï¼š"><a href="#Function-2ï¼š" class="headerlink" title="Function  2ï¼š"></a>Function  2ï¼š</h1><p>Gitå¦‚ä½•æ°¸ä¹…åˆ é™¤æ–‡ä»¶(åŒ…æ‹¬å†å²è®°å½•)<br> æœ‰äº›æ—¶å€™ä¸å°å¿ƒä¸Šä¼ äº†ä¸€äº›æ•æ„Ÿæ–‡ä»¶(ä¾‹å¦‚å¯†ç )ï¼Œæˆ–è€…ä¸æƒ³ä¸Šä¼ çš„æ–‡ä»¶(æ²¡åŠæ—¶æˆ–å¿˜äº†åŠ åˆ°.gitignoreé‡Œçš„)ï¼Œè€Œä¸”ä¸Šä¼ çš„æ–‡ä»¶åˆç‰¹åˆ«å¤§çš„æ—¶å€™, è¿™å°†å¯¼è‡´åˆ«äººcloneä½ çš„ä»£ç æˆ–ä¸‹è½½zipåŒ…çš„æ—¶å€™ä¹Ÿå¿…é¡»æ›´æ–°æˆ–ä¸‹è½½è¿™äº›æ— ç”¨çš„æ–‡ä»¶ï¼Œå› æ­¤ï¼Œæœ‰æ—¶éœ€è¦ä¸€ä¸ªæ–¹æ³•ï¼Œæ°¸ä¹…çš„åˆ é™¤è¿™äº›æ–‡ä»¶(åŒ…æ‹¬è¯¥æ–‡ä»¶çš„å†å²è®°å½•)ã€‚</p><p>é¦–å…ˆ, å¯ä»¥å‚è€ƒ github çš„å¸®åŠ©:</p><p><a href="https://help.github.com/articles/remove-sensitive-data" target="_blank" rel="noopener">https://help.github.com/articles/remove-sensitive-data</a></p><p>æ­¥éª¤ä¸€: ä»åº“ä¸­æ¸…é™¤æ–‡ä»¶<br>ä»¥Windowsä¸‹ä¸ºä¾‹(Linuxç±»ä¼¼)ï¼Œæ‰“å¼€é¡¹ç›®çš„Git Bashï¼Œä½¿ç”¨å‘½ä»¤ï¼š</p><p>$ git filter-branch â€“force â€“index-filter â€˜git rm â€“cached â€“ignore-unmatch path-to-your-remove-fileâ€™ â€“prune-empty â€“tag-name-filter cat â€“ â€“all<br>å…¶ä¸­ï¼Œpath-to-your-remove-file å°±æ˜¯ä½ è¦åˆ é™¤çš„æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„(ç›¸å¯¹äºgitä»“åº“çš„è·Ÿç›®å½•)ï¼Œæ›¿æ¢æˆä½ è¦åˆ é™¤çš„æ–‡ä»¶å³å¯ã€‚ æ³¨æ„ä¸€ç‚¹ï¼Œè¿™é‡Œçš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œéƒ½ä¸èƒ½ä»¥ â€˜/â€˜ å¼€å¤´ï¼Œå¦åˆ™æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä¼šè¢«è®¤ä¸ºæ˜¯ä» git çš„å®‰è£…ç›®å½•å¼€å§‹ã€‚å¦‚æœä½ è¦åˆ é™¤çš„ç›®æ ‡ä¸æ˜¯æ–‡ä»¶ï¼Œè€Œæ˜¯æ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆè¯·åœ¨ git rm â€“cachedâ€™ å‘½ä»¤åé¢æ·»åŠ  -r å‘½ä»¤ï¼Œè¡¨ç¤ºé€’å½’çš„åˆ é™¤ï¼ˆå­ï¼‰æ–‡ä»¶å¤¹å’Œæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œç±»ä¼¼äº â€˜rm -rf å‘½ä»¤ã€‚æ­¤å¤–ï¼Œå¦‚æœä½ è¦åˆ é™¤çš„æ–‡ä»¶å¾ˆå¤šï¼Œå¯ä»¥å†™è¿›ä¸€ä¸ª.shæ–‡ä»¶æ‰¹é‡æ‰§è¡Œï¼Œå¦‚æœæ–‡ä»¶æˆ–è·¯å¾„é‡Œæœ‰ä¸­æ–‡ï¼Œç”±äºMinGWæˆ–CygWinå¯¹ä¸­æ–‡è·¯å¾„è®¾ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œä½ å¯ä»¥ä½¿ç”¨é€šé…ç¬¦<em>å·ï¼Œä¾‹å¦‚ï¼šsound/music_</em>.mp3ï¼Œè¿™æ ·å°±æŠŠsoundç›®å½•ä¸‹ä»¥music_å¼€å¤´çš„mp3æ–‡ä»¶éƒ½åˆ é™¤äº†ã€‚</p><p>ä¾‹å¦‚è¿™æ ·ï¼Œ æ–°å»ºä¸€ä¸ª bash è„šæœ¬æ–‡ä»¶ï¼Œ<a href="http://del.sh/" target="_blank" rel="noopener">del.sh</a>ï¼š</p><p>#!/bin/bash</p><p>git filter-branch â€“force â€“index-filter â€˜git rm â€“cached â€“ignore-unmatch projects/Moon.mp3â€™ â€“prune-empty â€“tag-name-filter cat â€“ â€“all<br>git filter-branch â€“force â€“index-filter â€˜git rm â€“cached â€“ignore-unmatch sound/Music_*.mp3â€™ â€“prune-empty â€“tag-name-filter cat â€“ â€“all<br>å¦‚æœä½ çœ‹åˆ°ç±»ä¼¼ä¸‹é¢è¿™æ ·çš„ï¼Œå°±è¯´æ˜åˆ é™¤æˆåŠŸäº†ï¼š</p><p>Rewrite 48dc599c80e20527ed902928085e7861e6b3cbe6 (266/266)<br># Ref â€˜refs/heads/masterâ€™ was rewritten<br>å¦‚æœæ˜¾ç¤º xxxxx unchangedï¼Œ è¯´æ˜repoé‡Œæ²¡æœ‰æ‰¾åˆ°è¯¥æ–‡ä»¶, è¯·æ£€æŸ¥è·¯å¾„å’Œæ–‡ä»¶åæ˜¯å¦æ­£ç¡®ã€‚</p><p>æ³¨æ„ï¼š è¡¥å……ä¸€ç‚¹ï¼Œå¦‚æœä½ æƒ³ä»¥åä¹Ÿä¸ä¼šå†ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œ è¯·æŠŠè¿™ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ·»åŠ åˆ°.gitignoreæ–‡ä»¶é‡Œï¼Œç„¶åå†pushä½ çš„repoã€‚</p><p>æ­¥éª¤äºŒ: æ¨é€æˆ‘ä»¬ä¿®æ”¹åçš„repo<br>æ³¨æ„ï¼šä¸‹æ–‡ä»¥masteråˆ†æ”¯ä¸ºä¾‹ï¼Œè‹¥å…¶ä»–åˆ†æ”¯ä¹Ÿè¢«rewrittenäº†ï¼Œåˆ™éƒ½éœ€è¦ä¸“é—¨pushä¸€æ¬¡ï¼›è‹¥éœ€è¦pushçš„æ˜¯ä¿æŠ¤åˆ†æ”¯ï¼Œåˆ™å¿…é¡»å…ˆä¸´æ—¶å»é™¤ä¿æŠ¤è®¾ç½®ï¼Œç­‰pushä¹‹åå†è®¾ç½®å›æ¥ã€‚</p><p>ä»¥å¼ºåˆ¶è¦†ç›–çš„æ–¹å¼æ¨é€ä½ çš„repoï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><p>$ git push origin master â€“force-with-lease<br>è¿™ä¸ªè¿‡ç¨‹å…¶å®æ˜¯é‡æ–°ä¸Šä¼ æˆ‘ä»¬çš„repoï¼Œæ¯”è¾ƒè€—æ—¶ï¼Œ è™½ç„¶è·Ÿåˆ æ‰é‡æ–°å»ºä¸€ä¸ªrepoæœ‰äº›ç±»ä¼¼ï¼Œä½†æ˜¯å¥½å¤„æ˜¯ä¿ç•™äº†åŸæœ‰çš„æ›´æ–°è®°å½•ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ‰äº›ä¸åŒçš„ã€‚å¦‚æœä½ å®åœ¨ä¸åœ¨æ„è¿™äº›æ›´æ–°è®°å½•ï¼Œä¹Ÿå¯ä»¥åˆ æ‰é‡å»ºï¼Œä¸¤è€…ä¹Ÿå·®ä¸å¤ªå¤šï¼Œä¹Ÿè®¸åè€…è¿˜æ›´ç›´è§‚äº›ã€‚</p><p>æ‰§è¡Œç»“æœç±»ä¼¼ä¸‹é¢ï¼š</p><p>Counting objects: 4669, done.<br>Delta compression using up to 4 threads.<br>Compressing objects: 100% (4352/4352), done.<br>Writing objects: 100% (4666/4666), 35.16 MiB | 51 KiB/s, done.<br>Total 4666 (delta 1361), reused 0 (delta 0)<br>To <a href="https://github.com/defunkt/github-gem.git" target="_blank" rel="noopener">https://github.com/defunkt/github-gem.git</a><br> + beb839dâ€¦81f21f3 master -&gt; master (forced update)<br>ä¸ºäº†èƒ½ä»æ‰“äº† tag çš„ç‰ˆæœ¬ä¸­ä¹Ÿåˆ é™¤ä½ æ‰€æŒ‡å®šçš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™æ ·çš„å‘½ä»¤æ¥å¼ºåˆ¶æ¨é€æ‚¨çš„ Git tagsï¼š</p><p>$ git push origin master â€“force-with-lease â€“tags<br>æ­¥éª¤ä¸‰: æ¸…ç†å’Œå›æ”¶ç©ºé—´<br>è™½ç„¶ä¸Šé¢æˆ‘ä»¬å·²ç»åˆ é™¤äº†æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬çš„repoé‡Œé¢ä»ç„¶ä¿ç•™äº†è¿™äº›objectsï¼Œ ç­‰å¾…åƒåœ¾å›æ”¶(GC)ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨å‘½ä»¤å½»åº•æ¸…é™¤å®ƒï¼Œå¹¶æ”¶å›ç©ºé—´ã€‚</p><p>å‘½ä»¤å¦‚ä¸‹ï¼š</p><p>$ rm -rf .git/refs/original/</p><p>$ git reflog expire â€“expire=now â€“all</p><p>$ git gc â€“prune=now<br>Counting objects: 2437, done.<br># Delta compression using up to 4 threads.<br># Compressing objects: 100% (1378/1378), done.<br># Writing objects: 100% (2437/2437), done.<br># Total 2437 (delta 1461), reused 1802 (delta 1048)<br>$ git gc â€“aggressive â€“prune=now<br>Counting objects: 2437, done.<br># Delta compression using up to 4 threads.<br># Compressing objects: 100% (2426/2426), done.<br># Writing objects: 100% (2437/2437), done.<br># Total 2437 (delta 1483), reused 0 (delta 0)<br>æ³¨ï¼šæ³¨é‡Šéƒ¨åˆ†æ˜¯å‘½ä»¤æ‰§è¡Œåçš„ç»“æœã€‚</p><p>ç°åœ¨ä½ å†çœ‹çœ‹ä½ çš„.gitç›®å½•æ–‡ä»¶å¤§å°æ˜¯ä¸æ˜¯å˜å°äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      Gité¡¹ç›®è¿‡å¤§ï¼Œ.gitå†å²å¤§æ–‡ä»¶æ¸…ç†
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="git" scheme="https://kitions.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Electron æ‰“åŒ…ä¸‹è½½åŒ…æ…¢é—®é¢˜</title>
    <link href="https://kitions.github.io/2022/07/15/220715Electron%20%E6%89%93%E5%8C%85%E4%B8%8B%E8%BD%BD%E5%8C%85%E6%85%A2%E9%97%AE%E9%A2%98/"/>
    <id>https://kitions.github.io/2022/07/15/220715Electron æ‰“åŒ…ä¸‹è½½åŒ…æ…¢é—®é¢˜/</id>
    <published>2022-07-15T09:47:05.000Z</published>
    <updated>2022-10-17T03:30:46.826Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Electron-æ‰“åŒ…ä¸‹è½½åŒ…æ…¢é—®é¢˜"><a href="#Electron-æ‰“åŒ…ä¸‹è½½åŒ…æ…¢é—®é¢˜" class="headerlink" title="Electron æ‰“åŒ…ä¸‹è½½åŒ…æ…¢é—®é¢˜"></a>Electron æ‰“åŒ…ä¸‹è½½åŒ…æ…¢é—®é¢˜</h1><p>å®‰è£…Electronæ—¶ä¼šåˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦æœ‰è¦ä¸‹è½½çš„zipåŒ…ï¼Œå¦‚æœæ²¡æœ‰çš„è¯å°±å»ä¸‹è½½è¿™ä¸ªzipåŒ…ã€‚ä½†æ˜¯å¾€å¾€ä¸‹è½½è¿™ä¸ªzipåŒ…æ—¶éå¸¸æ…¢ï¼Œæ€»æ˜¯ä¸‹è½½ä¸æˆåŠŸã€‚</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h47r1nyinmj20rn05omyu.jpg" alt="image-20220715174023362"></p><p>ç¼“å­˜çš„ä½ç½®å–å†³äºæ“ä½œç³»ç»Ÿï¼Œé»˜è®¤å€¼ä¸ºï¼š<br>Linuxï¼š<code>$XDG_CACHE_HOMEæˆ–~/.cache/electron/</code><br>è‹¹æœç³»ç»Ÿï¼š<code>~/Library/Caches/electron/</code><br>Windowsï¼š<code>$LOCALAPPDATA/electron/Cache</code>æˆ–<code>~/AppData/Local/electron/Cache/</code></p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h47r384ej1j20kn0h1q5z.jpg" alt="image-20220715174155879"></p><p>ç„¶åï¼Œ<a href="https://github.com/electron/electron/releases" target="_blank" rel="noopener">ä¸‹è½½</a>éœ€è¦çš„electronå¯¹åº”ç‰ˆæœ¬çš„åŒ…, æ”¾åˆ°ä¸Šé¢æåˆ°çš„ç¼“å­˜åœ°å€ä¸­ã€‚</p><p>æœ€åï¼Œåœ¨å‘½ä»¤çª—å£ä¸­æ‰§è¡Œ<code>npm install electron -g</code>,æ‰§è¡ŒæˆåŠŸ</p><p>å†æ¬¡æ‰“åŒ…<code>npm run package:win</code>  <code>npm run package:mac</code>ï¼Œå°±ok</p>]]></content>
    
    <summary type="html">
    
      è‹¹æœè·¯å¾„ä¸ºï¼š~/Library/Caches/electron/ï¼ŒWindowsä¸º$LOCALAPPDATA/electron/Cacheæˆ–~/AppData/Local/electron/Cache/
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="electron" scheme="https://kitions.github.io/tags/electron/"/>
    
  </entry>
  
  <entry>
    <title>Gitæ–‡ä»¶å¤¹å¤§å°å†™æ•æ„Ÿé—®é¢˜</title>
    <link href="https://kitions.github.io/2022/06/09/220609mac%E3%80%81linux%20-%20Git%E6%96%87%E4%BB%B6%E5%90%8D%E5%A4%A7%E5%B0%8F%E5%86%99%E6%95%8F%E6%84%9F%E9%97%AE%E9%A2%98/"/>
    <id>https://kitions.github.io/2022/06/09/220609macã€linux - Gitæ–‡ä»¶åå¤§å°å†™æ•æ„Ÿé—®é¢˜/</id>
    <published>2022-06-09T03:49:53.000Z</published>
    <updated>2022-10-17T03:30:46.826Z</updated>
    
    <content type="html"><![CDATA[<h1 id="macã€linux-Gitæ–‡ä»¶å¤¹å¤§å°å†™æ•æ„Ÿé—®é¢˜"><a href="#macã€linux-Gitæ–‡ä»¶å¤¹å¤§å°å†™æ•æ„Ÿé—®é¢˜" class="headerlink" title="macã€linux - Gitæ–‡ä»¶å¤¹å¤§å°å†™æ•æ„Ÿé—®é¢˜"></a>macã€linux - Gitæ–‡ä»¶å¤¹å¤§å°å†™æ•æ„Ÿé—®é¢˜</h1><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h31ugcqy9gj204u02dq2s.jpg" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_d64fbe84-9deb-4f01-a9be-13c5757b7872"></p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h31uhnhca9j20v706w3z5.jpg" alt="image-20220609114607932"></p><p>æ–‡ä»¶å¤¹å†™çš„å¤§å†™ï¼Œè·¯ç”±å†™çš„å°å†™ï¼Œæœ¬åœ°æœºå™¨(Mac)æ‰“åŒ…çš„æ—¶å€™æ˜¯æ­£å¸¸çš„ã€‚ä¸€æ‰“åŒ…å‘ç‰ˆå°±æœ‰é—®é¢˜äº†</p><p><strong>mac/windows ç¯å¢ƒä¸‹ Gitåœ¨ä¸è®¾ç½®å¤§å°å†™æ•æ„Ÿè§„åˆ™çš„æ—¶å€™é»˜è®¤å¤§å°å†™æ˜¯ä¸æ•æ„Ÿ</strong></p><p><strong>æ‰“åŒ…æœºå™¨æ˜¯ Linux çš„ï¼Œè€Œ Linux ä¸‹ Gitæ˜¯é»˜è®¤å¤§å°å†™æ•æ„Ÿçš„ã€‚æ‰¾ä¸åˆ°æ–‡ä»¶å¤¹</strong> </p><h3 id="FIX"><a href="#FIX" class="headerlink" title="FIX"></a><strong>FIX</strong></h3><p>æ–¹æ³•ä¸€<br>åˆ é™¤æ–‡ä»¶ï¼Œé‡æ–°æ·»åŠ æ–‡ä»¶ã€‚ï¼ˆåˆ é™¤ä¹‹å‰è®°å¾—å¤‡ä»½ä¸‹æ–‡ä»¶å†…å®¹ï¼‰</p><p>æ–¹æ³•äºŒ(æ¨è)<br>è®¾ç½®Gitå¤§å°å†™æ•æ„Ÿ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config core.ignorecase <span class="literal">false</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      mac/windows ç¯å¢ƒä¸‹ Gitåœ¨ä¸è®¾ç½®å¤§å°å†™æ•æ„Ÿè§„åˆ™çš„æ—¶å€™é»˜è®¤å¤§å°å†™æ˜¯ä¸æ•æ„Ÿ,æ‰“åŒ…æœºå™¨æ˜¯ Linux çš„ï¼Œè€Œ Linux ä¸‹ Gitæ˜¯é»˜è®¤å¤§å°å†™æ•æ„Ÿçš„ã€‚
    
    </summary>
    
      <category term="git" scheme="https://kitions.github.io/categories/git/"/>
    
    
      <category term="git" scheme="https://kitions.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Dockerå®‰è£…HomeAssisantåŠä½¿ç”¨</title>
    <link href="https://kitions.github.io/2022/04/23/Docker%E5%AE%89%E8%A3%85HomeAssisant%E5%8F%8A%E4%BD%BF%E7%94%A8/"/>
    <id>https://kitions.github.io/2022/04/23/Dockerå®‰è£…HomeAssisantåŠä½¿ç”¨/</id>
    <published>2022-04-23T13:39:56.000Z</published>
    <updated>2022-10-17T03:30:46.826Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Dockerå®‰è£…HomeAssisantåŠä½¿ç”¨"><a href="#Dockerå®‰è£…HomeAssisantåŠä½¿ç”¨" class="headerlink" title="Dockerå®‰è£…HomeAssisantåŠä½¿ç”¨"></a>Dockerå®‰è£…HomeAssisantåŠä½¿ç”¨</h1><hr><p>HA å¤§åé¼é¼ï¼Œæ˜¯åŸºäº Python3 çš„å¼€æºæ™ºèƒ½å®¶å±…ç³»ç»Ÿï¼Œéå¸¸é€‚åˆè¿è¡Œåœ¨æ ‘è“æ´¾æˆ–æœ¬åœ°æœåŠ¡å™¨ä¸Šã€‚å®ƒé›†æˆäº†ä¼—å¤šä¼˜ç§€çš„äº§å“ï¼Œæ¯”å¦‚ IFTTT ã€ Arduino ã€Google Assistant ã€ Home Kit ã€ MQTT ç­‰ã€‚ç‰¹ç‚¹æ˜¯è¿è¡Œåœ¨å±€åŸŸç½‘å†…çš„è®¾å¤‡ä¸Šï¼Œç›¸å¯¹æ¯”è¾ƒæ³¨é‡éšç§ã€‚</p><p>æ™ºèƒ½å®¶å±…çš„æœ€å¤§é—®é¢˜ä¹‹ä¸€ï¼Œå°±æ˜¯æ ‡å‡†æ— æ³•ç»Ÿä¸€ã€‚åœ¨å¼€æºç¤¾åŒºçš„åŠªåŠ›ä¸‹ï¼Œå·²ç»æ”¯æŒ 1000 å¤šç§ç¡¬ä»¶å’Œè½¯ä»¶æ¥å…¥ã€‚æ¥å…¥çš„è½¯ç¡¬ä»¶ï¼Œå¯ä»¥ç»Ÿä¸€ä¸²è”èµ·æ¥ï¼Œè®¾ç½®è‡ªåŠ¨åŒ–æµç¨‹ã€‚åŒ…æ‹¬æˆ‘æ‰‹å¤´ä¸Šé›¶é›¶ç¢ç¢çš„ç¡¬ä»¶ä¹Ÿæ˜¯å„ä¸ªå“ç‰Œçš„ï¼ŒåŸºäºè¿™ä¸ªå¹³å°çš„ç‰¹ç‚¹ï¼Œé€‰æ‹©ä½¿ç”¨è¯¥å¼€æºé¡¹ç›®ä½œä¸ºä¸»è¦çš„å¼€å‘å¹³å°ã€‚homeassistantæ”¯æŒä¼—å¤šçš„æ™ºèƒ½å®¶å±…å“ç‰Œå“ç±»ã€‚</p><p><strong>Home Assistant æ ¸å¿ƒæ¦‚å¿µç†è§£ï¼šç»„ä»¶ã€æœåŠ¡ã€çŠ¶æ€</strong></p><p>åœ¨ Home Assistant è®¾è®¡è‡ªåŠ¨åŒ–ä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯åœ¨å’Œè¿™å‡ ä¸ªå…³é”®æ¦‚å¿µæ‰“äº¤é“ï¼š</p><p>ç»„ä»¶ï¼šå¯ä»¥ç†è§£ä¸º HA å…è®¸æ¥å…¥çš„ç¡¬ä»¶æˆ–è€…è½¯ä»¶æœåŠ¡ï¼Œä¾‹å¦‚å°ç±³çš„ç¯ï¼ˆç¡¬ä»¶ï¼‰ã€æ‘„åƒå¤´ï¼ˆç¡¬ä»¶ï¼‰ã€éº¦å…‹é£ï¼ˆç¡¬ä»¶ï¼‰ã€è„šæœ¬ä¼ æ„Ÿå™¨ï¼ˆè½¯ä»¶ï¼‰ã€ç”šè‡³è‡ªå·±ç¼–å†™çš„ custom componentï¼ˆè½¯ä»¶ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬è¿™æ¬¡é¡¹ç›®ä¸­ä¸»è¦ä½¿ç”¨åˆ°çš„èƒ½ä¸²èµ·æ•´ä¸ªæµç¨‹çš„æ ¸å¿ƒç»„ä»¶ï¼‰</p><p>æœåŠ¡ï¼šä¸€ä¸ªç»„ä»¶ï¼Œä¼šå¯¹å¤–æä¾›æœåŠ¡ï¼Œä¾‹å¦‚ä¸€ç›ç¯å¯ä»¥æä¾›å¼€å…³ç¯çš„æœåŠ¡ï¼Œä¸€ä¸ªéº¦å…‹é£å¯ä»¥æä¾›è¯´è¯çš„æœåŠ¡ã€‚è‡ªå·±ç¼–å†™çš„ä¸€äº›è„šæœ¬ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥å¯¹å¤–æä¾›è§¦å‘çš„æœåŠ¡</p><p>çŠ¶æ€ï¼šä¸€ç›ç¯åœ¨å½“å‰æ˜¯å¦å¼€å¯ç€çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªçŠ¶æ€ï¼›</p><p>æ™ºèƒ½å®¶å±…æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„åœºæ™¯ï¼ŒHome Assistant ä½œä¸ºä¸€ä¸ªæ™ºèƒ½å®¶å±…å¹³å°ï¼Œåœ¨è®¾è®¡ä¹‹åˆå°±è¦è€ƒè™‘åˆ°å¼€æ”¾æ€§å’Œå¤æ‚æ€§ã€‚ç»„ä»¶ã€æœåŠ¡ã€çŠ¶æ€ï¼Œè¿™ä¸‰ä¸ªæ¦‚å¿µç›¸å½“ç®€æ´ï¼Œåˆå…¨é¢ï¼Œç¡®å®æ˜¯éå¸¸ä¼˜é›…çš„è®¾è®¡ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8tztvftj21070futab.jpg" alt="Untitled"></p><p>é…ç½®</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8u3eahtj216n0eq0ui.jpg" alt="Untitled"></p><p>å‘ç‚¹ï¼šè®°å¾—è¦é€‰hostè€Œä¸æ˜¯æ¡¥æ¥æ¨¡å¼ï¼Œå¦åˆ™åé¢ homekitæ°¸è¿œæ‰¾ä¸åˆ°</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8ubryxzj20hs0f374o.jpg" alt="Untitled"></p><p>è¿™ä¸ªå›¾çš„åŸå› å°±æ˜¯å› ä¸ºæ²¡é€‰host</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8uddbc1j20g40snac4.jpg" alt="Untitled"></p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8uemz3dj20yl0inq67.jpg" alt="Untitled"></p><p><code>http://&lt;ip&gt;:8123</code> ç«¯å£å·ï¼š8123</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8uiuctrj20fp0btjro.jpg" alt="Untitled"></p><p>ç™»å½•ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8xx2qivj20ev0dajrr.jpg" alt="Untitled"></p><p>è¿›å…¥åé¡µé¢ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8um6ctsj21jy0px41k.jpg" alt="Untitled"></p><p>hac:æ›´å¤šç»„ä»¶æ’ä»¶</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8up0eduj21k50qgdlu.jpg" alt="Untitled"></p><p>ç»„ä»¶ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8ur9ebkj215n0olmz4.jpg" alt="Untitled"></p><p>æœ‰å¤§ç¥çš„é›†æˆï¼Œç›´æ¥ä¸€é”®å‚»ç“œæ“ä½œ ï¼Œæ¯”å¦‚Xiaomi MIoT</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8uu0sb7j20fw0lht94.jpg" alt="Untitled"></p><p>homekit:</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8ux8wl9j20f40jwjrj.jpg" alt="Untitled"></p><p>ç»„ä»¶ï¼š</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8v0ity0j21kq0qmwid.jpg" alt="Untitled"></p><p>ä¸ªäººç°æœ‰ç±³å®¶è®¾å¤‡ï¼Œè®¾å¤‡æ¯”è¾ƒå°‘</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8v70isnj20u01sxdli.jpg" alt="IMG_2333.PNG"></p><p>homekit ç»‘å®šåæ•ˆæœ</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8ve1zlgj20u01sxwjq.jpg" alt="Untitled"></p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1o8vm7nu2j20u01sxdje.jpg" alt="IMG_2331.PNG"></p><p><img src="Docker%E5%AE%89%E8%A3%85HomeAssisant%E5%8F%8A%E4%BD%BF%E7%94%A8%20ce2fda36b06a43b0a806beb9524fcd4f/IMG_2332.png" alt="IMG_2332.PNG"></p>]]></content>
    
    <summary type="html">
    
      HA å¤§åé¼é¼ï¼Œæ˜¯åŸºäº Python3 çš„å¼€æºæ™ºèƒ½å®¶å±…ç³»ç»Ÿï¼Œéå¸¸é€‚åˆè¿è¡Œåœ¨æ ‘è“æ´¾æˆ–æœ¬åœ°æœåŠ¡å™¨ä¸Šã€‚å®ƒé›†æˆäº†ä¼—å¤šä¼˜ç§€çš„äº§å“ï¼Œæ¯”å¦‚ IFTTT ã€ Arduino ã€Google Assistant ã€ Home Kit ã€ MQTT ç­‰ã€‚ç‰¹ç‚¹æ˜¯è¿è¡Œåœ¨å±€åŸŸç½‘å†…çš„è®¾å¤‡ä¸Šï¼Œç›¸å¯¹æ¯”è¾ƒæ³¨é‡éšç§ã€‚
    
    </summary>
    
      <category term="HomeAssisant" scheme="https://kitions.github.io/categories/HomeAssisant/"/>
    
    
      <category term="HomeAssisant,æ™ºèƒ½å®¶å±…" scheme="https://kitions.github.io/tags/HomeAssisant-%E6%99%BA%E8%83%BD%E5%AE%B6%E5%B1%85/"/>
    
  </entry>
  
  <entry>
    <title>i18n+ Next.jså›½é™…åŒ–</title>
    <link href="https://kitions.github.io/2021/12/19/i18n+%20Next.js/"/>
    <id>https://kitions.github.io/2021/12/19/i18n+ Next.js/</id>
    <published>2021-12-19T06:15:39.000Z</published>
    <updated>2022-10-17T03:30:46.828Z</updated>
    
    <content type="html"><![CDATA[<h2 id="i18n-Next-js"><a href="#i18n-Next-js" class="headerlink" title="i18n+ Next.js"></a>i18n+ Next.js</h2><h3 id="1-i18n-ts"><a href="#1-i18n-ts" class="headerlink" title="1. i18n.ts"></a>1. i18n.ts</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> LanguageDetector <span class="keyword">from</span> <span class="string">"i18next-browser-languagedetector"</span>;</span><br><span class="line"><span class="keyword">import</span> i18n <span class="keyword">from</span> <span class="string">"i18next"</span>;</span><br><span class="line"><span class="keyword">import</span> getConfig <span class="keyword">from</span> <span class="string">"next/config"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; initReactI18next &#125; <span class="keyword">from</span> <span class="string">"react-i18next"</span>;</span><br><span class="line"><span class="keyword">import</span> enUsTrans <span class="keyword">from</span> <span class="string">"./locales/en-US.json"</span>;</span><br><span class="line"><span class="keyword">import</span> zhCnTrans <span class="keyword">from</span> <span class="string">"./locales/zh-CN.json"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡é…ç½®æ–‡ä»¶è·å–é»˜è®¤è¯­è¨€</span></span><br><span class="line"><span class="keyword">const</span> defalutLanguage = getConfig().publicRuntimeConfig.language</span><br><span class="line">? getConfig().publicRuntimeConfig.language</span><br><span class="line">: <span class="string">"zh_CN"</span>;</span><br><span class="line"></span><br><span class="line">i18n</span><br><span class="line">.use(LanguageDetector) <span class="comment">// å—…æ¢å½“å‰æµè§ˆå™¨è¯­è¨€</span></span><br><span class="line">.use(initReactI18next) <span class="comment">// init i18next</span></span><br><span class="line">.init(&#123;</span><br><span class="line"><span class="comment">// å¼•å…¥èµ„æºæ–‡ä»¶</span></span><br><span class="line">resources: &#123;</span><br><span class="line">zh_CN: &#123;</span><br><span class="line">translation: zhCnTrans</span><br><span class="line">&#125;,</span><br><span class="line">en_US: &#123;</span><br><span class="line">translation: enUsTrans</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">lng: defalutLanguage, <span class="comment">// é€‰æ‹©é»˜è®¤è¯­è¨€ï¼Œé€‰æ‹©å†…å®¹ä¸ºä¸Šè¿°é…ç½®ä¸­çš„keyï¼Œå³en/zh å¦‚æœå¼€å¯äº† LanguageDetector åˆ™å¯ä»¥ä¸ç”¨é»˜è®¤è¯­è¨€ï¼Œä¼šè‡ªåŠ¨åŒ¹é…æœªå—…æ¢åˆ°çš„è¯­è¨€</span></span><br><span class="line">fallbackLng: <span class="string">"zh_CN"</span>, <span class="comment">// æœªæ‰¾åˆ°å¯¹åº”è¯­è¨€åŒ…æ—¶å€™çš„å¤±è´¥è¯­è¨€åŒ…</span></span><br><span class="line">debug: <span class="literal">false</span>,</span><br><span class="line">interpolation: &#123;</span><br><span class="line">escapeValue: <span class="literal">false</span> <span class="comment">// not needed for react as it escapes by default</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> i18n;</span><br></pre></td></tr></table></figure><h3 id="2-package-json"><a href="#2-package-json" class="headerlink" title="2. package.json"></a>2. package.json</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"i18next": "^20.3.5",</span><br><span class="line">"i18next-browser-languagedetector": "^6.1.2",</span><br><span class="line">"react-i18next": "^11.11.3",</span><br></pre></td></tr></table></figure><h3 id="3-å¤šè¯­è¨€æ–‡ä»¶-json"><a href="#3-å¤šè¯­è¨€æ–‡ä»¶-json" class="headerlink" title="3. å¤šè¯­è¨€æ–‡ä»¶.json"></a>3. å¤šè¯­è¨€æ–‡ä»¶.json</h3><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxkaybk94zj305x01smwz.jpg" alt="image-20211220145350846"></p><h3 id="4-åŒ¹é…ç°æœ‰é¡¹ç›®çš„UIåº“å¤šè¯­è¨€"><a href="#4-åŒ¹é…ç°æœ‰é¡¹ç›®çš„UIåº“å¤šè¯­è¨€" class="headerlink" title="4. åŒ¹é…ç°æœ‰é¡¹ç›®çš„UIåº“å¤šè¯­è¨€"></a>4. åŒ¹é…ç°æœ‰é¡¹ç›®çš„UIåº“å¤šè¯­è¨€</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŒ¹é…antd</span></span><br><span class="line"><span class="keyword">import</span> zh_CN <span class="keyword">from</span> <span class="string">"antd/lib/locale-provider/zh_CN"</span>;</span><br><span class="line"><span class="keyword">import</span> en_US <span class="keyword">from</span> <span class="string">"antd/lib/locale-provider/en_US"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMatchedLocal = <span class="function">(<span class="params">language: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">let</span> target = zh_CN; <span class="comment">// é»˜è®¤è¯­è¨€</span></span><br><span class="line"><span class="keyword">switch</span> (language) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">"zh_CN"</span>:</span><br><span class="line">target = zh_CN;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">"en_US"</span>:</span><br><span class="line">target = en_US;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> target;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="5-æ³¨å…¥ConfigProvider"><a href="#5-æ³¨å…¥ConfigProvider" class="headerlink" title="5. æ³¨å…¥ConfigProvider"></a>5. æ³¨å…¥ConfigProvider</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import &#123; ConfigProvider &#125; from &quot;antd&quot;;</span><br><span class="line">import &#123; useTranslation &#125; from &quot;react-i18next&quot;;</span><br><span class="line">import &quot;../i18n&quot;;</span><br><span class="line"></span><br><span class="line">const APP = () =&gt; &#123;</span><br><span class="line">  const &#123; t, i18n &#125; = useTranslation();</span><br><span class="line"></span><br><span class="line">return(</span><br><span class="line">  &lt;ConfigProvider locale=&#123;getMatchedLocal(i18n.language)&#125;&gt;</span><br><span class="line">    &lt;Button onClick=&#123;() =&gt; i18n.changeLanguage(&apos;zh-CN&apos;)&#125;&gt;&#123;t(&apos;åˆ‡æ¢åˆ°ä¸­æ–‡&apos;)&#125;&lt;/Button&gt;</span><br><span class="line"></span><br><span class="line">&#123;t(&quot;title&quot;)&#125;</span><br><span class="line">&lt;/ConfigProvider&gt;</span><br><span class="line">)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      å¦‚é¢˜
    
    </summary>
    
      <category term="React" scheme="https://kitions.github.io/categories/React/"/>
    
    
      <category term="i18n" scheme="https://kitions.github.io/tags/i18n/"/>
    
  </entry>
  
  <entry>
    <title>2022ç½‘ç»œå®‰å…¨é¢˜ç›®</title>
    <link href="https://kitions.github.io/2021/12/11/2022%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/"/>
    <id>https://kitions.github.io/2021/12/11/2022ç½‘ç»œå®‰å…¨é˜²æŠ¤/</id>
    <published>2021-12-11T12:55:59.000Z</published>
    <updated>2022-10-17T03:30:46.826Z</updated>
    
    <content type="html"><![CDATA[<p>2022ç½‘ç»œå®‰å…¨é¢˜ç›®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&gt; å•é€‰</span><br><span class="line"><span class="number">5.</span> Raid <span class="number">0</span> <span class="number">1</span> <span class="number">5</span> </span><br><span class="line"></span><br><span class="line"><span class="number">6.</span> .vhdæ–‡ä»¶ç”¨ä»€ä¹ˆæ‰“å¼€ (è™šæ‹Ÿç£ç›˜æ–‡ä»¶)</span><br><span class="line">A. è§†é¢‘æ’­æ”¾è½¯ä»¶ D.æ•°æ®åº“ </span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> çº¿ç¨‹ä¸è¿›ç¨‹ </span><br><span class="line">B. è¿›ç¨‹åˆ‡æ¢å¼€é”€è¿œå°äºçº¿ç¨‹(âŒ)  D.ä»æ“ä½œç³»ç»Ÿå±‚é¢çœ‹ï¼Œåˆ†ä¸ºç³»ç»Ÿè¿›ç¨‹å’Œç”¨æˆ·è¿›ç¨‹</span><br><span class="line"></span><br><span class="line"><span class="number">10.</span> äºŒå‰æ ‘å‰åºéå†ä¸º&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;ï¼Œä¸­åºéå†ä¸º&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">4</span>&#125;,ååºéå†æ˜¯()</span><br><span class="line"></span><br><span class="line"><span class="number">11.</span> æ—¶é—´å¤æ‚åº¦ä¸åŒçš„ä¸€é¡¹æ˜¯</span><br><span class="line">A.å†’æ³¡æ’åº B.æ’å…¥æ’åº C.å¿«é€Ÿæ’åº D.é€‰æ‹©æ’åº</span><br><span class="line"></span><br><span class="line"><span class="number">12.</span> Cè¯­è¨€ä¸­ i,jä¸ºintç±»å‹ </span><br><span class="line">A.i++j B.i+++j C.i++++j D.++(i++)</span><br><span class="line"></span><br><span class="line"><span class="number">14.</span>äºŒè¿›åˆ¶æ•°<span class="number">00001011</span>ï¼ŒåŠ åè¿›åˆ¶æ•°<span class="number">11</span></span><br><span class="line">A.åå…­è¿›åˆ¶<span class="number">0x61</span>  B.åå…­è¿›åˆ¶<span class="number">0x16</span></span><br><span class="line"></span><br><span class="line"><span class="number">16.</span> ping é‡‡ç”¨çš„æ˜¯ä½•ç§åè®® ï¼ˆipï¼‰</span><br><span class="line"></span><br><span class="line"><span class="number">17.</span> ä¸‰æ¬¡æ¡æ‰‹</span><br><span class="line"></span><br><span class="line"><span class="number">20.</span> RSAç®—æ³•ï¼Œåªæ˜æ–‡ã€å¯†æ–‡.....</span><br><span class="line"></span><br><span class="line"><span class="number">22.</span> linuxä¸­ å¯æ‰§è¡Œç¨‹åºæ˜¯ä»€ä¹ˆ</span><br><span class="line"></span><br><span class="line"><span class="number">23.</span> linuxä¸­ rootå†å²æ‰§è¡Œè®°å½• ç”¨()å‘½ä»¤æŸ¥çœ‹</span><br><span class="line"></span><br><span class="line"><span class="number">26.</span> windowsæ“ä½œç³»ç»Ÿä¸­å®‰å…¨ç­–ç•¥ã€å®¡æ ¸éªŒè¯ã€æ‰§è¡Œå®‰å…¨ç®¡ç†</span><br><span class="line">A.SAM B.LSA C.SRM D.LAZANGE</span><br><span class="line"></span><br><span class="line"><span class="number">28.</span> é˜²ç¼“å†²åŒºæº¢å‡ºæ”»å‡»</span><br><span class="line"></span><br><span class="line"><span class="number">29.</span> å…³äºè •è™«ç—…æ¯’ï¼Œä¸æ­£ç¡®çš„æ˜¯</span><br><span class="line">A.é‡‡ç”¨peæ’å…¥ B.ç†ŠçŒ«çƒ§é¦™æ˜¯è •è™«ç—…æ¯’ </span><br><span class="line"></span><br><span class="line"><span class="number">31.</span> æš´åŠ›ç ´è§£FTPã€sshçš„è½¯ä»¶æœ‰</span><br><span class="line">A. hydra B. winDump C.wireshark D.proxychains</span><br><span class="line"></span><br><span class="line"><span class="number">34.</span> ADBæ‹·è´æ•°æ®åˆ°ç”µè„‘å‘½ä»¤</span><br><span class="line">A. ADB pull B.ADB push</span><br><span class="line"></span><br><span class="line"><span class="number">40.</span> mysqlæ•°æ®åº“è‡ªå®šä¹‰å‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt; ä»¥ä¸‹ä¸ºå¤šé€‰é€‰æ‹©</span><br><span class="line"><span class="number">55.</span> Javaæ¡†æ¶ </span><br><span class="line">A.struts B.Spring  C.django D.shiro</span><br><span class="line"></span><br><span class="line"><span class="number">60.</span> IP:<span class="number">192.168</span><span class="number">.100</span><span class="number">.10</span> å­ç½‘æ©ç ï¼š<span class="number">255.255</span><span class="number">.255</span><span class="number">.192</span>ã€‚å±äºåŒä¸€å­ç½‘çš„æ˜¯</span><br><span class="line">A<span class="number">.192</span><span class="number">.168</span><span class="number">.100</span><span class="number">.124</span>  B<span class="number">.192</span><span class="number">.168</span><span class="number">.100</span><span class="number">.64</span></span><br><span class="line">C<span class="number">.192</span><span class="number">.168</span><span class="number">.100</span><span class="number">.44</span>   D<span class="number">.192</span><span class="number">.168</span><span class="number">.100</span><span class="number">.4</span></span><br><span class="line"></span><br><span class="line"><span class="number">65.</span> windowsæ“ä½œç³»ç»Ÿæ—¥å¿—æ–‡ä»¶</span><br><span class="line">A.åº”ç”¨ç¨‹åºæ—¥å¿— B.å®‰å…¨æ—¥å¿—  C.ç³»ç»Ÿæ—¥å¿— D.è´¦æˆ·æ—¥å¿—</span><br><span class="line"></span><br><span class="line"><span class="number">67.</span> linuxå‘½ä»¤</span><br><span class="line"></span><br><span class="line"><span class="number">72.</span> ls -l</span><br><span class="line"></span><br><span class="line"><span class="number">73.</span> LinuxæŸ¥çœ‹æ–‡ä»¶å†…å®¹ </span><br><span class="line">A. less B.tac C.more D.touch</span><br><span class="line"></span><br><span class="line"><span class="number">74.</span> æ ¡éªŒæ–‡ä»¶çš„å®Œæ•´æ€§</span><br><span class="line">A. sha1sum B.md5sum C.sha256sum D.sha1024sum</span><br><span class="line"></span><br><span class="line"><span class="number">76.</span> ç›®å½•æ‰«ææ–‡ä»¶è½¯ä»¶</span><br><span class="line">A.DVWA B<span class="number">.7</span>kbscan C.cobalt strike D.dirsearch</span><br><span class="line"></span><br><span class="line"><span class="number">80.</span>é˜²å¾¡SQLæ‰‹æ®µ</span><br><span class="line">A.è¿‡æ»¤ç©ºæ ¼  B.æ¢Script  C.æ¢åæ–œæ  D.æ¢å•åŒå¼•å·</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt; åˆ¤æ–­</span><br><span class="line"><span class="number">90.</span> ä¼ è¾“å±‚</span><br><span class="line"></span><br><span class="line"><span class="number">96.</span>systeminfo æ˜¯çœ‹è¡¥ä¸çš„å®‰è£…æƒ…å†µçš„</span><br><span class="line"></span><br><span class="line"><span class="number">99.</span> wapi wifi  é€šè¿‡å…¬é’¥å¯†ç </span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      2022ç½‘ç»œå®‰å…¨ç®€å•é¢˜ç›®
    
    </summary>
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="https://kitions.github.io/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="ç½‘ç»œå®‰å…¨" scheme="https://kitions.github.io/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>SCSS ä¸åŒä¸»é¢˜æ¢è‚¤</title>
    <link href="https://kitions.github.io/2021/11/16/scss%20%E4%B8%8D%E5%90%8C%E4%B8%BB%E9%A2%98%E6%8D%A2%E8%82%A4/"/>
    <id>https://kitions.github.io/2021/11/16/scss ä¸åŒä¸»é¢˜æ¢è‚¤/</id>
    <published>2021-11-16T03:02:10.000Z</published>
    <updated>2022-10-17T03:30:46.829Z</updated>
    
    <content type="html"><![CDATA[<h1 id="scss-ä¸åŒä¸»é¢˜æ¢è‚¤"><a href="#scss-ä¸åŒä¸»é¢˜æ¢è‚¤" class="headerlink" title="scss ä¸åŒä¸»é¢˜æ¢è‚¤"></a>scss ä¸åŒä¸»é¢˜æ¢è‚¤</h1><p>Basic.scss</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$font_common</span>: <span class="number">14px</span>; <span class="comment">//å¤§å¤šæ•°æ–‡å­—</span></span><br><span class="line"><span class="variable">$font_color</span>: <span class="number">#1D253E</span>; <span class="comment">//å¤§å¤šæ•°æ–‡å­—é¢œè‰²</span></span><br><span class="line"><span class="variable">$font_header_title</span>: <span class="number">#CFCFCF</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$themes</span>: (</span><br><span class="line">blue_theme: (</span><br><span class="line">color_main:<span class="number">#3054EB</span>, //ä¸»è‰²</span><br><span class="line">        color_main_bg: linear-gradient(<span class="number">106deg</span>, <span class="number">#4345FA</span> <span class="number">0%</span>, <span class="number">#6F4CFF</span> <span class="number">100%</span>), //ä¸»èƒŒæ™¯</span><br><span class="line">        color_btn_bg:rgba(<span class="number">48</span>, <span class="number">84</span>, <span class="number">235</span>, <span class="number">0.08</span>), //æŒ‰é’®èƒŒæ™¯</span><br><span class="line">        color_pale_bg: <span class="number">#B0BFFF</span>, //æ·¡èƒŒæ™¯</span><br><span class="line"></span><br><span class="line">        color_header_bg: linear-gradient(<span class="number">106deg</span>, <span class="number">#4345FA</span> <span class="number">0%</span>, <span class="number">#6F4CFF</span> <span class="number">100%</span>), // header èƒŒæ™¯è‰²</span><br><span class="line">        color_header_txt_hover: <span class="number">#FFF</span>, // headerå­—ä½“hover</span><br><span class="line"></span><br><span class="line">    ),</span><br><span class="line">    orange_theme: (color_main:<span class="number">#FF7919</span>, //ä¸»è‰²</span><br><span class="line">        color_main_bg: <span class="number">#FF7919</span>, //ä¸»èƒŒæ™¯</span><br><span class="line">        color_btn_bg:rgba(<span class="number">255</span>, <span class="number">121</span>, <span class="number">25</span>, <span class="number">0.08</span>), //æŒ‰é’®èƒŒæ™¯</span><br><span class="line">        color_pale_bg: <span class="number">#FFC79E</span>, //æ·¡èƒŒæ™¯</span><br><span class="line"></span><br><span class="line">        color_header_bg: <span class="number">#1D253E</span>, // header èƒŒæ™¯è‰²</span><br><span class="line">        color_header_txt_hover: <span class="number">#FF7919</span>, // headerå­—ä½“hover</span><br><span class="line">    ),</span><br><span class="line">    red_theme: (color_main:<span class="number">#D7000F</span>, //ä¸»è‰²</span><br><span class="line">        color_main_bg: <span class="number">#D7000F</span>, //ä¸»èƒŒæ™¯</span><br><span class="line">        color_btn_bg:rgba(<span class="number">215</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">0.08</span>), //æŒ‰é’®èƒŒæ™¯</span><br><span class="line">        color_pale_bg: <span class="number">#FFB6BB</span>, //æ·¡èƒŒæ™¯</span><br><span class="line"></span><br><span class="line">        color_header_bg: <span class="number">#1D253E</span>, // header èƒŒæ™¯è‰²</span><br><span class="line">        color_header_txt_hover: <span class="number">#D7000F</span>, // headerå­—ä½“hover</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">@<span class="keyword">mixin</span> themeify &#123;</span><br><span class="line">    @<span class="keyword">each</span> <span class="variable">$theme-name</span>,</span><br><span class="line">    <span class="variable">$theme-map</span> in <span class="variable">$themes</span> &#123;</span><br><span class="line">        <span class="variable">$theme-map</span>: <span class="variable">$theme-map</span> !global;</span><br><span class="line"></span><br><span class="line">        <span class="selector-attr">[data-theme=#&#123;$theme-name&#125;]</span> &amp; &#123;</span><br><span class="line">            @<span class="keyword">content</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@function themed(<span class="variable">$key</span>) &#123;</span><br><span class="line">    @return map-get(<span class="variable">$theme-map</span>, <span class="variable">$key</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">mixin</span> text_color(<span class="variable">$color</span>) &#123;</span><br><span class="line">@<span class="keyword">include</span> themeify &#123;</span><br><span class="line">        <span class="attribute">color</span>: themed(<span class="variable">$color</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">mixin</span> bg_color(<span class="variable">$color</span>) &#123;</span><br><span class="line">    @<span class="keyword">include</span> themeify &#123;</span><br><span class="line">        <span class="attribute">background</span>: themed(<span class="variable">$color</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">mixin</span> ellipsis(<span class="variable">$width</span>) &#123;</span><br><span class="line">    <span class="comment">//æ¨ªæ’çœç•¥å·</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="variable">$width</span>;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    -o-<span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">mixin</span> Hellipsis(<span class="variable">$num</span>, <span class="variable">$height</span>) &#123;</span><br><span class="line">    <span class="comment">//ç«–æ’çœç•¥å·</span></span><br><span class="line">    <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">    -webkit-line-clamp: <span class="variable">$num</span>;</span><br><span class="line">    -webkit-box-orient: vertical;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="variable">$height</span> / <span class="variable">$num</span>;</span><br><span class="line">    <span class="attribute">max-height</span>: <span class="variable">$height</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¾ç½®é¡µé¢æ ‡ç­¾</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.documentElement.setAttribute(</span><br><span class="line"><span class="string">'data-theme'</span>,</span><br><span class="line"><span class="string">'blue-theme'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      scssæ¢è‚¤æ ¹æ®é¡µé¢è®¾ç½®data-themeæ ‡ç­¾å®ç°ã€‚
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="SCSS" scheme="https://kitions.github.io/tags/SCSS/"/>
    
  </entry>
  
  <entry>
    <title>ANTD table è™šæ‹Ÿæ»šåŠ¨</title>
    <link href="https://kitions.github.io/2021/07/04/ANTD%20table%20%E8%99%9A%E6%8B%9F%E6%BB%9A%E5%8A%A8/"/>
    <id>https://kitions.github.io/2021/07/04/ANTD table è™šæ‹Ÿæ»šåŠ¨/</id>
    <published>2021-07-04T02:38:31.000Z</published>
    <updated>2022-10-17T03:30:46.826Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ANTD-table-è™šæ‹Ÿæ»šåŠ¨"><a href="#ANTD-table-è™šæ‹Ÿæ»šåŠ¨" class="headerlink" title="ANTD table è™šæ‹Ÿæ»šåŠ¨"></a>ANTD table è™šæ‹Ÿæ»šåŠ¨</h1><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Antdå›¢é˜Ÿ 2016 å¹´å°±è¦æ³¨æ„åˆ° antd é•¿åˆ—è¡¨é¡¹ç›®çš„æ€§èƒ½é—®é¢˜äº†ï¼Œå½“æ—¶è®©é åˆ†é¡µæ¥è§£å†³,é—®é¢˜æ˜¯å¾ˆå¤šéœ€æ±‚æ˜¯è¦å•å±å±•ç¤ºçš„ï¼Œå›¢é˜Ÿä¹Ÿå¾ˆæ¸…æ¥šç”¨è™šæ‹Ÿæ»šåŠ¨å¯ä»¥æœ‰æ•ˆåœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ç›®çš„æ˜¯å®ç°ä¸‡çº§ä»¥ä¸Šæ•°æ®çš„é«˜æ€§èƒ½è¡¨æ ¼ã€‚</p><p>ç®€å•ç²—æš´ç›´æ¥ä¸Šä»£ç </p><h3 id="æœç´¢æ–¹æ³•"><a href="#æœç´¢æ–¹æ³•" class="headerlink" title="æœç´¢æ–¹æ³•"></a>æœç´¢æ–¹æ³•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">const inputRef = useRef&lt;Input&gt;(null);</span><br><span class="line"></span><br><span class="line">// æœç´¢</span><br><span class="line">const getColumnSearchProps = (dataIndex: any, title: string) =&gt; (&#123;</span><br><span class="line">filterDropdown: (&#123;</span><br><span class="line">setSelectedKeys,</span><br><span class="line">selectedKeys,</span><br><span class="line">confirm,</span><br><span class="line">clearFilters</span><br><span class="line">&#125;: any) =&gt; (</span><br><span class="line">&lt;div style=&#123;&#123; padding: 8 &#125;&#125;&gt;</span><br><span class="line">&lt;Input</span><br><span class="line">ref=&#123;inputRef&#125;</span><br><span class="line">placeholder=&#123;`æœç´¢$&#123;title&#125;`&#125;</span><br><span class="line">value=&#123;selectedKeys[0]&#125;</span><br><span class="line">onChange=&#123;e =&gt;</span><br><span class="line">setSelectedKeys(e.target.value ? [e.target.value] : [])</span><br><span class="line">&#125;</span><br><span class="line">onPressEnter=&#123;() =&gt;</span><br><span class="line">handleSearch(selectedKeys, confirm, dataIndex)</span><br><span class="line">&#125;</span><br><span class="line">style=&#123;&#123; width: 188, marginBottom: 8, display: &apos;block&apos; &#125;&#125;</span><br><span class="line">/&gt;</span><br><span class="line">&lt;Button</span><br><span class="line">type=&quot;primary&quot;</span><br><span class="line">onClick=&#123;() =&gt;</span><br><span class="line">handleSearch(selectedKeys, confirm, dataIndex)</span><br><span class="line">&#125;</span><br><span class="line">icon=&#123;&lt;SearchOutlined /&gt;&#125;</span><br><span class="line">size=&quot;small&quot;</span><br><span class="line">style=&#123;&#123; width: 90, marginRight: 8 &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">æœç´¢</span><br><span class="line">&lt;/Button&gt;</span><br><span class="line">&lt;Button</span><br><span class="line">onClick=&#123;() =&gt; handleReset(clearFilters)&#125;</span><br><span class="line">size=&quot;small&quot;</span><br><span class="line">style=&#123;&#123; width: 90 &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">é‡ç½®</span><br><span class="line">&lt;/Button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">),</span><br><span class="line">filterIcon: (filtered: any) =&gt; (</span><br><span class="line">&lt;SearchOutlined</span><br><span class="line">style=&#123;&#123; color: filtered ? &apos;#1890ff&apos; : undefined &#125;&#125;</span><br><span class="line">/&gt;</span><br><span class="line">),</span><br><span class="line">onFilter: (value: any, record: any) =&gt;</span><br><span class="line">record[dataIndex]</span><br><span class="line">? record[dataIndex]</span><br><span class="line">.toString()</span><br><span class="line">.toLowerCase()</span><br><span class="line">.includes(value.toLowerCase())</span><br><span class="line">: &apos;&apos;,</span><br><span class="line">onFilterDropdownVisibleChange: (visible: any) =&gt; &#123;</span><br><span class="line">if (visible) &#123;</span><br><span class="line">setTimeout(() =&gt; inputRef?.current?.select());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const handleSearch = (</span><br><span class="line">_selectedKeys: any[],</span><br><span class="line">confirm: () =&gt; void,</span><br><span class="line">_dataIndex: any</span><br><span class="line">) =&gt; &#123;</span><br><span class="line">confirm();</span><br><span class="line">&#125;;</span><br><span class="line">const handleReset = (clearFilters: () =&gt; void) =&gt; &#123;</span><br><span class="line">clearFilters();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æ’åºæ–¹æ³•"><a href="#æ’åºæ–¹æ³•" class="headerlink" title="æ’åºæ–¹æ³•"></a>æ’åºæ–¹æ³•</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// columnså¤„ç†å‡½æ•°åŒ…å«æ’åºsorter</span></span><br><span class="line"><span class="keyword">const</span> formatColumns = <span class="function">(<span class="params">fields: DataCompareField[]</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">return</span> fields.map(<span class="function">(<span class="params">field</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">const</span> dataIndex = field.item_id ? field.item_id : <span class="string">'æ—¥æœŸ'</span>;</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">title: <span class="string">`<span class="subst">$&#123;field.item_name&#125;</span><span class="subst">$&#123;field.unit &amp;&amp; `ï¼ˆ$&#123;field.unit&#125;</span>ï¼‰`</span>&#125;<span class="string">`,</span></span><br><span class="line"><span class="string">dataIndex: getKey(field), //ç‰¹æ®Šåˆ—item_idä¸ºç©º</span></span><br><span class="line"><span class="string">type: field.value_type,</span></span><br><span class="line"><span class="string">width: 190,</span></span><br><span class="line"><span class="string">showSorterTooltip: false,</span></span><br><span class="line"><span class="string">sorter: (a: any, b: any) =&gt; &#123;</span></span><br><span class="line"><span class="string">if (</span></span><br><span class="line"><span class="string">field.value_type == 'integer' ||</span></span><br><span class="line"><span class="string">field.value_type == 'float'</span></span><br><span class="line"><span class="string">) &#123;</span></span><br><span class="line"><span class="string">return (</span></span><br><span class="line"><span class="string">compareColumn(a[dataIndex] || 0) -</span></span><br><span class="line"><span class="string">compareColumn(b[dataIndex] || 0)</span></span><br><span class="line"><span class="string">);</span></span><br><span class="line"><span class="string">&#125; else &#123;</span></span><br><span class="line"><span class="string">return String(a[dataIndex]).localeCompare(b[dataIndex]);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;,</span></span><br><span class="line"><span class="string">...getColumnSearchProps(dataIndex, field.item_name)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  const compareColumn = (text: string | number) =&gt; &#123;</span></span><br><span class="line"><span class="string">    if (text == '-') text = 0;</span></span><br><span class="line"><span class="string">    return Number(text.toString().replace(',', ''));</span></span><br><span class="line"><span class="string">  &#125;;</span></span><br></pre></td></tr></table></figure><h3 id="å‘ç‚¹"><a href="#å‘ç‚¹" class="headerlink" title="å‘ç‚¹"></a>å‘ç‚¹</h3><p>æœ€æœ€å…³é”®çš„ï¼Œå®˜æ–¹æ–‡æ¡£æœªå®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¯¼è‡´ç‚¹å‡»æ’åºæˆ–è€…æœç´¢æ–¹æ³•ä¼šæŠ¥scrollTop of undefined</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [connectObject] = useState&lt;any&gt;<span class="function">(<span class="params">(</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">"scrollLeft"</span>, &#123;</span><br><span class="line">get: <span class="function"><span class="params">()</span> =&gt;</span> <span class="literal">null</span>,</span><br><span class="line">set: <span class="function">(<span class="params">scrollLeft: number</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (gridRef.current) &#123;</span><br><span class="line">gridRef.current.scrollTo(&#123; scrollLeft &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#125;)</span><br><span class="line">  <span class="comment">// å°±æ˜¯è¿™ä¸ª   å¯çœ‹issues  </span></span><br><span class="line">    <span class="comment">// https://github.com/ant-design/ant-design/issues/24383</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">"ownerDocument"</span>, &#123;</span><br><span class="line">get: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">document</span>.body.ownerDocument</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> obj</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="å®Œæ•´çš„VirtualTableç»„ä»¶"><a href="#å®Œæ•´çš„VirtualTableç»„ä»¶" class="headerlink" title="å®Œæ•´çš„VirtualTableç»„ä»¶"></a>å®Œæ•´çš„VirtualTableç»„ä»¶</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line">// å®Œæ•´çš„VirtualTable</span><br><span class="line"></span><br><span class="line">import React, &#123; FC, useEffect, useRef, useState &#125; from &quot;react&quot;</span><br><span class="line">import &#123; Table, Tooltip &#125; from &quot;antd&quot;</span><br><span class="line">import ResizeObserver from &quot;rc-resize-observer&quot;</span><br><span class="line">import &#123; VariableSizeGrid as Grid &#125; from &quot;react-window&quot;</span><br><span class="line">import &#123; TableProps &#125; from &quot;antd/lib/table&quot;</span><br><span class="line"></span><br><span class="line">import &#123; strLen &#125; from &quot;@Common/utils/util&quot;</span><br><span class="line"></span><br><span class="line">import Style from &quot;./index.module.scss&quot;</span><br><span class="line"></span><br><span class="line">interface IProps &#123;</span><br><span class="line">data: &#123;</span><br><span class="line">[key: string]: string | number | null</span><br><span class="line">&#125;[]</span><br><span class="line">columns: IColumn[]</span><br><span class="line">c_size: &#123;</span><br><span class="line">y: number</span><br><span class="line">x: number | undefined</span><br><span class="line">&#125;</span><br><span class="line">isSort?: boolean</span><br><span class="line">&#125;</span><br><span class="line">interface TConfig &#123;</span><br><span class="line">LineHeight: number</span><br><span class="line">AntdThPadding: number</span><br><span class="line">AntdThVPadding: number</span><br><span class="line">AntdTdPadding: number</span><br><span class="line">AntdRowHeight: number</span><br><span class="line">AntdFontSize: number</span><br><span class="line">ThtdBorder: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface IColumn &#123;</span><br><span class="line">title: string</span><br><span class="line">dataIndex: string</span><br><span class="line">width?: number</span><br><span class="line">sort?: (a: any, b: any) =&gt; any</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const VirtualTable: FC&lt;IProps &amp; Partial&lt;TConfig&gt; &amp; TableProps&lt;any&gt;&gt; = (props) =&gt; &#123;</span><br><span class="line">const &#123; columns, c_size, data, isSort &#125; = props</span><br><span class="line">let TConfig: TConfig = &#123;</span><br><span class="line">LineHeight: props.LineHeight || 30,</span><br><span class="line">AntdFontSize: props.AntdFontSize || 14,</span><br><span class="line">AntdRowHeight: props.AntdRowHeight || 40,</span><br><span class="line">AntdThPadding: props.AntdThPadding || 10 * 2,</span><br><span class="line">AntdTdPadding: props.AntdTdPadding || 10 * 2,</span><br><span class="line">AntdThVPadding: props.AntdThVPadding || 5 * 2,</span><br><span class="line">ThtdBorder: props.ThtdBorder || 1,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const gridRef = useRef&lt;any&gt;()</span><br><span class="line"></span><br><span class="line">const [tableWidth, setTableWidth] = useState(0)</span><br><span class="line">const [connectObject] = useState&lt;any&gt;(() =&gt; &#123;</span><br><span class="line">const obj = &#123;&#125;</span><br><span class="line">Object.defineProperty(obj, &quot;scrollLeft&quot;, &#123;</span><br><span class="line">get: () =&gt; null,</span><br><span class="line">set: (scrollLeft: number) =&gt; &#123;</span><br><span class="line">if (gridRef.current) &#123;</span><br><span class="line">gridRef.current.scrollTo(&#123; scrollLeft &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#125;)</span><br><span class="line">Object.defineProperty(obj, &quot;ownerDocument&quot;, &#123;</span><br><span class="line">get: () =&gt; document.body.ownerDocument</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">return obj</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// åˆå¹¶åçš„åˆ—æ•°</span><br><span class="line">const mergedColumns = ((columns: IColumn[]) =&gt; &#123;</span><br><span class="line">const widthColumnCount = columns.filter((&#123; width &#125;) =&gt; !width).length</span><br><span class="line">return columns.map((column) =&gt; &#123;</span><br><span class="line">if (column.width) &#123;</span><br><span class="line">return column</span><br><span class="line">&#125;</span><br><span class="line">return &#123;</span><br><span class="line">...column,</span><br><span class="line">width: Math.ceil(tableWidth / widthColumnCount),</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)(columns)</span><br><span class="line">  </span><br><span class="line">  const strLen = (str: string) =&gt; &#123;</span><br><span class="line">    let len = 0</span><br><span class="line">    for (let i = 0; i &lt; str.length; i++) &#123;</span><br><span class="line">      const c = str.charCodeAt(i)</span><br><span class="line">      //å•å­—èŠ‚åŠ 1</span><br><span class="line">      if ((c &gt;= 0x0001 &amp;&amp; c &lt;= 0x007e) || (0xff60 &lt;= c &amp;&amp; c &lt;= 0xff9f)) &#123;</span><br><span class="line">        len++</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        len += 2</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return len</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">// æ ‡é¢˜æœ€é•¿é•¿åº¦</span><br><span class="line">const getMaxHeightTh = (columns: IColumn[], scrollbarSize: number) =&gt; &#123;</span><br><span class="line">let _max = &#123;</span><br><span class="line">index: 0,</span><br><span class="line">len: 0,</span><br><span class="line">width: 0,</span><br><span class="line">ratio: 0,</span><br><span class="line">&#125;</span><br><span class="line">columns.map((column, i) =&gt; &#123;</span><br><span class="line">const titleLen = strLen(column.title)</span><br><span class="line">if (column.width) &#123;</span><br><span class="line">const columnLen = i !== columns.length - 1 ? column.width : column.width - scrollbarSize</span><br><span class="line">const ratio = titleLen / columnLen</span><br><span class="line">if (ratio &gt; _max.ratio) &#123;</span><br><span class="line">_max.ratio = ratio</span><br><span class="line">_max.index = i</span><br><span class="line">_max.len = titleLen</span><br><span class="line">_max.width = columnLen</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">return _max</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æ»šåŠ¨æ¡é«˜åº¦</span><br><span class="line">const getScrollY = (containerHeight: number, scrollbarSize: number) =&gt; &#123;</span><br><span class="line">const maxHeightTh = getMaxHeightTh(mergedColumns, scrollbarSize)</span><br><span class="line">const containChars = Math.floor((maxHeightTh.width - TConfig.AntdThPadding - TConfig.ThtdBorder) / TConfig.AntdFontSize) * 2</span><br><span class="line">const titleHeight = TConfig.AntdThVPadding + TConfig.LineHeight * Math.ceil(maxHeightTh.len / containChars) //è¡¨å¤´åŸºç¡€é«˜åº¦x px,è¶…è¿‡yä¸ªçº¯å­—ç¬¦æ¢è¡Œï¼Œæ¯æ¢è¡Œå¢åŠ z px</span><br><span class="line">let columnsBoxHeight = containerHeight - titleHeight //æœ€å°é«˜åº¦æœ€å¤§å€¼ï¼›å³å®¹å™¨é«˜åº¦</span><br><span class="line">if(isSort) columnsBoxHeight -= 30 </span><br><span class="line">return columnsBoxHeight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const resetVirtualGrid = () =&gt; &#123;</span><br><span class="line">if(gridRef.current)&#123;</span><br><span class="line">gridRef.current.resetAfterIndices(&#123;</span><br><span class="line">columnIndex: 0,</span><br><span class="line">shouldForceUpdate: true, //TODO</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è°ƒæ•´å¤§å°æ—¶ä¼šé¢‘ç¹æ¸²æŸ“ï¼Œå¯èƒ½æœ‰ä¼˜åŒ–ç©ºé—´</span><br><span class="line">const renderVirtualList = (rawData: any[], &#123; scrollbarSize, ref, onScroll &#125;: any) =&gt; &#123;</span><br><span class="line">ref.current = connectObject</span><br><span class="line">const scrollY = getScrollY(c_size.y, scrollbarSize)</span><br><span class="line">const columnsBoxHeight = scrollY</span><br><span class="line">const columnsRealHeight = rawData.length * TConfig.AntdRowHeight //dataæ‰€å é«˜åº¦ï¼›å³åˆ—å®é«˜</span><br><span class="line">const minHeight = columnsRealHeight &gt; columnsBoxHeight ? columnsBoxHeight : columnsRealHeight</span><br><span class="line">const maxHeight = columnsRealHeight &gt; columnsBoxHeight ? columnsBoxHeight : columnsRealHeight + scrollbarSize</span><br><span class="line"></span><br><span class="line">return !!rawData.length ? (</span><br><span class="line">&lt;Grid</span><br><span class="line">ref=&#123;gridRef&#125;</span><br><span class="line">className=&quot;gridContent&quot;</span><br><span class="line">columnCount=&#123;mergedColumns.length&#125;</span><br><span class="line">columnWidth=&#123;(index) =&gt; &#123;</span><br><span class="line">const &#123; width &#125; = mergedColumns[index]</span><br><span class="line">return columnsRealHeight &gt; columnsBoxHeight &amp;&amp; </span><br><span class="line">index === mergedColumns.length - 1 </span><br><span class="line">? width! - scrollbarSize </span><br><span class="line">: width!</span><br><span class="line">&#125;&#125;</span><br><span class="line">width=&#123;tableWidth&#125;</span><br><span class="line">rowCount=&#123;rawData.length&#125;</span><br><span class="line">rowHeight=&#123;() =&gt; TConfig.AntdRowHeight&#125;</span><br><span class="line">height=&#123;columnsRealHeight &gt; columnsBoxHeight ? columnsBoxHeight : columnsRealHeight + scrollbarSize&#125;</span><br><span class="line">onScroll=&#123;(&#123; scrollLeft &#125;) =&gt; &#123;</span><br><span class="line">onScroll(&#123; scrollLeft &#125;)</span><br><span class="line">&#125;&#125;</span><br><span class="line">style=&#123;&#123;</span><br><span class="line">height: &quot;auto&quot;,</span><br><span class="line">minHeight: minHeight,</span><br><span class="line">maxHeight: maxHeight,</span><br><span class="line">&#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">&#123;(&#123; columnIndex, rowIndex, style &#125;) =&gt; &#123;</span><br><span class="line">const value = (rawData[rowIndex] as any)[mergedColumns[columnIndex].dataIndex]</span><br><span class="line">const columnWidth = columns[columnIndex].width</span><br><span class="line">const containChars = Math.floor((columnWidth! - TConfig.AntdTdPadding - TConfig.ThtdBorder) / TConfig.AntdFontSize) * 2</span><br><span class="line">return (</span><br><span class="line">&lt;div className=&#123;Style.virtualTableCell&#125; style=&#123;style&#125;&gt;</span><br><span class="line">&#123;columnWidth &amp;&amp; strLen(String(value)) &gt; containChars ? &lt;Tooltip title=&#123;value&#125;&gt;&#123;value&#125;&lt;/Tooltip&gt; : value&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">)</span><br><span class="line">&#125;&#125;</span><br><span class="line">&lt;/Grid&gt;</span><br><span class="line">) : undefined</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">useEffect(() =&gt; resetVirtualGrid, [tableWidth, columns])</span><br><span class="line"></span><br><span class="line">const shouldHeaderScroll = data.length == 0</span><br><span class="line"></span><br><span class="line">return (</span><br><span class="line">&lt;ResizeObserver</span><br><span class="line">onResize=&#123;(&#123; width, height &#125;) =&gt; &#123;</span><br><span class="line">setTableWidth(width)</span><br><span class="line">&#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">&lt;Table</span><br><span class="line">&#123;...props&#125;</span><br><span class="line">scroll=&#123;&#123; y: getScrollY(c_size.y, 0), x: undefined &#125;&#125;</span><br><span class="line">className=&#123;[Style.virtualTable, shouldHeaderScroll ? Style.antdHdScroll : &quot;&quot;].join(&quot; &quot;)&#125;</span><br><span class="line">columns=&#123;mergedColumns&#125;</span><br><span class="line">dataSource=&#123;data&#125;</span><br><span class="line">style=&#123;&#123; width: mergedColumns.length != 0 &amp;&amp; mergedColumns[0].width ? mergedColumns.length * mergedColumns[0].width + 1 : &quot;auto&quot; &#125;&#125;</span><br><span class="line">bordered</span><br><span class="line">pagination=&#123;false&#125;</span><br><span class="line">components=&#123;&#123;</span><br><span class="line">body: renderVirtualList,</span><br><span class="line">&#125;&#125;</span><br><span class="line">/&gt;</span><br><span class="line">&lt;/ResizeObserver&gt;</span><br><span class="line">)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default VirtualTable</span><br></pre></td></tr></table></figure><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.virtualTable</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line"><span class="selector-class">.virtualTableCell</span> &#123;</span><br><span class="line"><span class="attribute">box-sizing</span>: border-box;</span><br><span class="line"></span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line"><span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line"><span class="attribute">white-space</span>: nowrap;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">include</span> border_color(<span class="string">"color_divide"</span>, 1px, right);</span><br><span class="line">@<span class="keyword">include</span> border_color(<span class="string">"color_divide"</span>, 1px, bottom);</span><br><span class="line">@<span class="keyword">include</span> text_color(<span class="string">"color_font"</span>);</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.antdHdScroll</span> &#123;</span><br><span class="line">:global &#123;</span><br><span class="line">.ant-table-header &#123;</span><br><span class="line">overflow: auto <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨VirtualTableç»„ä»¶"><a href="#ä½¿ç”¨VirtualTableç»„ä»¶" class="headerlink" title="ä½¿ç”¨VirtualTableç»„ä»¶"></a>ä½¿ç”¨VirtualTableç»„ä»¶</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">import ResizeObserver from &quot;rc-resize-observer&quot;</span><br><span class="line"></span><br><span class="line">export const Tables: FC&lt;IProps&gt; = () =&gt; &#123;</span><br><span class="line"></span><br><span class="line">const [panelHeight, setPanelHeight] = useState(0)</span><br><span class="line">const formatData = (</span><br><span class="line">fields: Field[],</span><br><span class="line">data: (ReactText | null)[][]</span><br><span class="line">): &#123;</span><br><span class="line">[key: string]: ReactText</span><br><span class="line">&#125;[] =&gt; &#123;</span><br><span class="line">return data</span><br><span class="line">.map((rowValues, i) =&gt; &#123;</span><br><span class="line">let obj: &#123;</span><br><span class="line">[key: string]: any</span><br><span class="line">&#125; = &#123;&#125;</span><br><span class="line">fields.map((field, j) =&gt; &#123;</span><br><span class="line">let key = getKey(field)</span><br><span class="line">obj[key] == undefined &amp;&amp;</span><br><span class="line">Object.defineProperty(obj, getKey(field), &#123;</span><br><span class="line">value: formatValue(rowValues[j], &#123;</span><br><span class="line">type: field.value_type,</span><br><span class="line">&#125;),</span><br><span class="line">enumerable: true,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">return obj</span><br><span class="line">&#125;)</span><br><span class="line">.filter((rowObj) =&gt; Object.keys(rowObj).length !== 0)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return(</span><br><span class="line">  &lt;ResizeObserver</span><br><span class="line">          onResize=&#123;(&#123; height &#125;) =&gt; &#123;</span><br><span class="line">            let headerHeight = headerRef.current ? headerRef.current.clientHeight : 0</span><br><span class="line">            setPanelHeight(height - headerHeight - (isFullScreen ? FULLSCREEN_PADDING * 2 : 0))</span><br><span class="line">          &#125;&#125;</span><br><span class="line">        &gt;</span><br><span class="line">    &lt;div className=&#123;Style.panelBody&#125;&gt;</span><br><span class="line">      &#123;data &amp;&amp; data.fields &amp;&amp; data.fields.length ? (</span><br><span class="line">        &lt;Spin spinning=&#123;spinning&#125;&gt;</span><br><span class="line">          &lt;VirtualTable columns=&#123;formatColumns(data.fields)&#125; data=&#123;formatData(data.fields, data.data)&#125; c_size=&#123;&#123; y: panelHeight, x: undefined &#125;&#125; isSort=&#123;true&#125;/&gt;</span><br><span class="line">        &lt;/Spin&gt;</span><br><span class="line">      ) : (</span><br><span class="line">        &lt;Empty image=&#123;Empty.PRESENTED_IMAGE_SIMPLE&#125; /&gt;</span><br><span class="line">      )&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/ResizeObserver&gt;</span><br><span class="line">)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>è¡¨æ ¼çš„onchangeäº‹ä»¶ã€‚æ¸…ç©ºç­›é€‰é¡¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [filteredInfo, setFilteredInfo] = useState&lt;any&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TableOnChange = <span class="function">(<span class="params">pagination: TablePaginationConfig, filters: Record&lt;string, Key[] | <span class="literal">null</span>&gt;, sorter: SorterResult&lt;any&gt; | SorterResult&lt;any&gt;[], extra: TableCurrentDataSource&lt;any&gt;</span>) =&gt;</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!filters) <span class="keyword">return</span>;</span><br><span class="line">setFilteredInfo(filters);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">formatColumns = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    filteredValue: (filteredInfo &amp;&amp; filteredInfo[dataIndex]) || <span class="literal">null</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h3><p><a href="https://ant.design/components/table-cn/#components-table-demo-virtual-list" target="_blank" rel="noopener">antdè™šæ‹Ÿæ»šåŠ¨</a></p><p><a href="https://www.zhihu.com/column/antdesign" target="_blank" rel="noopener">çŸ¥ä¹AntDè¯é¢˜</a></p><p><a href="https://zhuanlan.zhihu.com/p/102037418" target="_blank" rel="noopener">Ant Design 4.0 çš„ä¸€äº›æ‚äº‹å„¿ - Table ç¯‡</a></p><p><a href="https://github.com/ctq123/ant-virtual-table" target="_blank" rel="noopener">github å¼€æºant-virtual-tableï¼Œæ²¡çœ‹æºç ï¼Œåº”è¯¥å’Œä¸Šè¿°å®ç°å·®ä¸å¤š</a></p>]]></content>
    
    <summary type="html">
    
      Antd Tableè™šæ‹Ÿæ»šåŠ¨å®Œæ•´å®ç°ï¼ŒåŒ…å«æœç´¢ï¼Œæ’åº
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="React" scheme="https://kitions.github.io/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>ESLintç›¸å…³ +  prettier</title>
    <link href="https://kitions.github.io/2021/04/01/ESLint%E7%9B%B8%E5%85%B3/"/>
    <id>https://kitions.github.io/2021/04/01/ESLintç›¸å…³/</id>
    <published>2021-04-01T07:45:55.000Z</published>
    <updated>2022-10-17T03:30:46.827Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ESLintç›¸å…³"><a href="#ESLintç›¸å…³" class="headerlink" title="ESLintç›¸å…³"></a>ESLintç›¸å…³</h1><p>ç»§æ‰¿çš„ä¸»è¦æ˜¯çˆ±å½¼è¿ã€eslintæ¨èã€typescript-eslintæ¨èã€reactæ¨èè§„åˆ™ï¼Œè‡ªå·±æ”¹äº†ç‚¹å°è§„åˆ™ã€‚.eslintrcå…·ä½“ç»†åˆ™è¿˜ä¸æ˜¯ç‰¹åˆ«å®Œå–„ã€‚å„ä½å¤§ä½¬ä½¿ç”¨ä¸­å‘ç°é—®é¢˜çš„è¯ï¼Œæ±‚è½»å–·ã€‚å¸Œæœ›å¤§å®¶ä¸€èµ·å®Œå–„ã€‚</p><p>ç›®å‰eslintæé†’ä¸»è¦æ˜¯errorï¼Œwarningï¼Œerrorçº¢è‰²ï¼Œç¼–è¯‘ä¸é€šè¿‡ï¼Œwaringé»„è‰²è­¦å‘Šï¼Œä¸å½±å“é¡¹ç›®ç¼–è¯‘ã€‚æœ‰å¼ºè¿«ç—‡çš„äººä¼°è®¡ä¸€å®šä¼šæ”¹æ‰ã€‚</p><h3 id="1-package-jsonå¼•å…¥"><a href="#1-package-jsonå¼•å…¥" class="headerlink" title="1 package.jsonå¼•å…¥"></a>1 package.jsonå¼•å…¥</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">"@typescript-eslint/eslint-plugin": "^4.16.1",</span><br><span class="line">"@typescript-eslint/parser": "^4.16.1",</span><br><span class="line">"eslint": "^7.21.0",</span><br><span class="line">"eslint-config-airbnb": "^18.2.1",</span><br><span class="line">"eslint-config-prettier": "^8.1.0",</span><br><span class="line">"eslint-plugin-import": "^2.22.1",</span><br><span class="line">"eslint-plugin-jsx-a11y": "^6.4.1",</span><br><span class="line">"eslint-plugin-react": "^7.22.0",</span><br><span class="line">"husky": "^5.1.3",</span><br><span class="line">"prettier": "^2.2.1"</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// è§„åˆ™è§é™„</span><br><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">&quot;lint&quot;: &quot;eslint --ignore-path .eslintignore . --fix&quot;,</span><br><span class="line">&quot;lint_quiet&quot;: &quot;eslint --quiet  --ignore-path .eslintignore . --fix&quot;,</span><br><span class="line">&quot;lint_husky&quot;: &quot;eslint --quiet  --ignore-path .eslintignore . &quot;,</span><br><span class="line">&quot;fix&quot;: &quot;npx prettier --write .&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>åœ¨package.jsoné‡ŒåŠ å…¥ä¸€æ¡`&quot;lint_husky&quot;: &quot;eslint --ignore-path .eslintignore . &quot;,`</code></pre><p>åœ¨gitæäº¤çš„é’©å­å‡½æ•°ï¼ˆhuskyï¼‰é‡Œä½¿ç”¨ npm run lint_husky</p><p>è¿™ä¸ªä¹‹å‰æœ‰ä¸ªBugï¼Œå¦‚æœæ‰§è¡Œeslintçš„<code>--fix</code>ä¿®å¤ä»£ç æ“ä½œï¼Œä¼šåœ¨gitæäº¤åå†ä¿®å¤ï¼Œæ•…åœ¨æ‰§è¡Œé’©å­æ—¶ä¸ä¿®å¤ä»£ç ï¼Œåªæ˜¯å•çº¯çš„æ£€æµ‹erroré”™è¯¯ã€‚</p><p><code>Nextjs-v11</code>ç‰ˆæœ¬æœ‰äº†å®˜æ–¹çš„eslintè§„åˆ™ï¼Œåç»­å‡çº§11ç‰ˆæœ¬çš„è¯ï¼Œå¯ä»¥åŠ è¿›å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">extends: [</span><br><span class="line">&quot;next&quot;,</span><br><span class="line">&quot;next/core-web-vitals&quot;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">    &quot;eslint-config-next&quot;: &quot;^11.0.1&quot;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="2-eslintrc-js"><a href="#2-eslintrc-js" class="headerlink" title="2 .eslintrc.js"></a>2 .eslintrc.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">env: &#123;</span><br><span class="line">browser: <span class="literal">true</span>,</span><br><span class="line">es2021: <span class="literal">true</span>,</span><br><span class="line">node: <span class="literal">true</span></span><br><span class="line">&#125;,</span><br><span class="line">extends: [</span><br><span class="line"><span class="string">"prettier"</span>,</span><br><span class="line"><span class="string">"airbnb"</span>,</span><br><span class="line"><span class="string">"eslint:recommended"</span>,</span><br><span class="line"><span class="string">"plugin:react/recommended"</span>,</span><br><span class="line"><span class="string">"plugin:@typescript-eslint/recommended"</span></span><br><span class="line">],</span><br><span class="line">settings: &#123;</span><br><span class="line"><span class="string">"import/extensions"</span>: [</span><br><span class="line"><span class="string">"2"</span>,</span><br><span class="line"><span class="string">"ignorePackages"</span>,</span><br><span class="line">&#123;</span><br><span class="line">ts: <span class="string">"never"</span>,</span><br><span class="line">tsx: <span class="string">"never"</span>,</span><br><span class="line">json: <span class="string">"never"</span>,</span><br><span class="line">js: <span class="string">"never"</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;,</span><br><span class="line">parser: <span class="string">"@typescript-eslint/parser"</span>,</span><br><span class="line">parserOptions: &#123;</span><br><span class="line">ecmaFeatures: &#123;</span><br><span class="line">jsx: <span class="literal">true</span></span><br><span class="line">&#125;,</span><br><span class="line">ecmaVersion: <span class="number">2018</span></span><br><span class="line">&#125;,</span><br><span class="line">plugins: [<span class="string">"react"</span>, <span class="string">"@typescript-eslint"</span>],</span><br><span class="line">rules: &#123;</span><br><span class="line">indent: [<span class="string">"error"</span>, <span class="string">"tab"</span>], <span class="comment">// todo</span></span><br><span class="line"><span class="string">"no-tabs"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"quote-props"</span>: <span class="number">0</span>,</span><br><span class="line">semi: <span class="number">0</span>,</span><br><span class="line">quotes: <span class="number">0</span>,</span><br><span class="line"><span class="string">"comma-dangle"</span>: [<span class="string">"error"</span>, <span class="string">"never"</span>],</span><br><span class="line"><span class="string">"arrow-parens"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"react/react-in-jsx-scope"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"react/jsx-indent"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"react/jsx-indent-props"</span>: [<span class="number">2</span>, <span class="string">"tab"</span>],</span><br><span class="line"><span class="string">"react/jsx-filename-extension"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"react/jsx-props-no-spreading"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"react/jsx-no-target-blank"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"import/no-unresolved"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"import/extensions"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"@typescript-eslint/no-var-requires"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"global-require"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"no-nested-ternary"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"max-classes-per-file"</span>: <span class="number">0</span>, <span class="comment">// ä¸€ä¸ªé¡µé¢æœ€å¤šä¸€ä¸ªclass</span></span><br><span class="line"><span class="string">"no-plusplus"</span>: <span class="number">0</span>, <span class="comment">// å…è®¸ä½¿ç”¨++ --</span></span><br><span class="line"><span class="string">"no-new"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"no-useless-constructor"</span>: <span class="number">0</span>, <span class="comment">// constructorå…è®¸&#123;&#125;</span></span><br><span class="line"><span class="string">"no-use-before-define"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"no-underscore-dangle"</span>: <span class="number">0</span>, <span class="comment">// _</span></span><br><span class="line"><span class="string">"no-param-reassign"</span>: <span class="number">1</span>, <span class="comment">// å½¢å‚èµ‹å€¼</span></span><br><span class="line"><span class="string">"import/prefer-default-export"</span>: <span class="number">0</span>, <span class="comment">// å•ä¸ªæ–¹æ³•ã€ç±»æ˜¯å¦é»˜è®¤å¯¼å‡º</span></span><br><span class="line">camelcase: <span class="number">1</span>, <span class="comment">// todo æ˜¯å¦é©¼å³°</span></span><br><span class="line"><span class="string">"no-restricted-syntax"</span>: <span class="number">0</span>, <span class="comment">// ä¸å—é™åˆ¶çš„è¯­æ³•</span></span><br><span class="line"><span class="string">"guard-for-in"</span>: <span class="number">1</span>, <span class="comment">// åˆ¤æ–­Object.prototype.hasOwnProperty.call(foo, key)</span></span><br><span class="line"><span class="string">"max-len"</span>: [<span class="number">1</span>, &#123; <span class="attr">code</span>: <span class="number">200</span> &#125;],</span><br><span class="line"><span class="string">"no-return-await"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"new-cap"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">"jsx-a11y/label-has-associated-control"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"jsx-a11y/anchor-is-valid"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="string">"jsx-a11y/click-events-have-key-events"</span>: <span class="number">0</span>, <span class="comment">// å…³çˆ±æ®‹éšœäººå£«æ ‡ç­¾ å¼ºåˆ¶æ‰§è¡ŒonClickæ˜¯ä¼´éšç€ä»¥ä¸‹çš„è‡³å°‘ä¸€ä¸ªï¼šonKeyUpï¼ŒonKeyDownï¼ŒonKeyPress</span></span><br><span class="line"><span class="string">"jsx-a11y/no-static-element-interactions"</span>: <span class="number">0</span>, <span class="comment">// å…³çˆ±æ®‹éšœäººå£«æ ‡ç­¾ span divç­‰ åŠ role</span></span><br><span class="line"><span class="string">"jsx-a11y/no-noninteractive-element-interactions"</span>: <span class="number">0</span>, <span class="comment">// å…³çˆ±æ®‹éšœäººå£«æ ‡ç­¾ éäº¤äº’å…ƒä»¶</span></span><br><span class="line"><span class="string">"no-script-url"</span>: <span class="number">1</span>, <span class="comment">// javascript:;</span></span><br><span class="line"><span class="string">"class-methods-use-this"</span>: <span class="number">0</span>,</span><br><span class="line">eqeqeq: <span class="number">1</span>, <span class="comment">// todo ===</span></span><br><span class="line"><span class="string">"@typescript-eslint/ban-types"</span>: <span class="number">1</span>, <span class="comment">// Object &#123;&#125;ç­‰</span></span><br><span class="line"><span class="string">"react/display-name"</span>: <span class="number">0</span>, <span class="comment">// display-name</span></span><br><span class="line"><span class="string">"react/prop-types"</span>: <span class="number">0</span>, <span class="comment">// .propTypes</span></span><br><span class="line"><span class="string">"react/destructuring-assignment"</span>: <span class="number">1</span>, <span class="comment">// todo props stateè§£æ„</span></span><br><span class="line"><span class="string">"react/no-array-index-key"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">"no-unused-expressions"</span>: [<span class="string">"error"</span>, &#123; <span class="attr">allowShortCircuit</span>: <span class="literal">true</span> &#125;],</span><br><span class="line"><span class="string">"consistent-return"</span>: <span class="number">2</span>,</span><br><span class="line"><span class="string">"no-prototype-builtins"</span>: <span class="number">1</span>, <span class="comment">//  bad: foo.hasOwnProperty("bar") good:Object.prototype.hasOwnProperty.call(foo, "bar");</span></span><br><span class="line"><span class="string">"no-shadow"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">"@typescript-eslint/no-empty-function"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">"no-async-promise-executor"</span>: <span class="number">0</span>, <span class="comment">// ç¦æ­¢å°†å¼‚æ­¥åŠŸèƒ½ç”¨ä½œPromiseæ‰§è¡Œå™¨</span></span><br><span class="line"><span class="string">"@typescript-eslint/no-empty-interface"</span>: <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">"@typescript-eslint/explicit-module-boundary-types"</span>: <span class="number">0</span>, <span class="comment">// 300 å¯ä»¥è‡ªåŠ¨æ¨å€’</span></span><br><span class="line"><span class="string">"no-console"</span>: <span class="string">"off"</span>,</span><br><span class="line"><span class="string">"@typescript-eslint/no-unused-vars"</span>: <span class="number">1</span>, <span class="comment">// 20 æœªä½¿ç”¨çš„å˜é‡</span></span><br><span class="line"><span class="string">"func-names"</span>: <span class="number">0</span>, <span class="comment">// åŒ¿åå‡½æ•°</span></span><br><span class="line"><span class="string">"@typescript-eslint/no-explicit-any"</span>: <span class="number">1</span>, <span class="comment">// 100 // any ç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="string">"@typescript-eslint/no-this-alias"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">"prefer-destructuring"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">"no-case-declarations"</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="3-eslintignore-å’Œ-prettierignore"><a href="#3-eslintignore-å’Œ-prettierignore" class="headerlink" title="3 .eslintignore å’Œ .prettierignore"></a>3 .eslintignore å’Œ .prettierignore</h3><p>çœ‹è¯¸ä½é¡¹ç›®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/node_modules/</span><br><span class="line">/src/_next/</span><br><span class="line">/src/dist/</span><br><span class="line">/src/<span class="keyword">static</span>/</span><br><span class="line">  </span><br><span class="line">  or</span><br><span class="line"></span><br><span class="line">/node_modules/</span><br><span class="line">/src/_next/</span><br><span class="line">/src/dist/</span><br><span class="line">/src/<span class="keyword">static</span>/</span><br><span class="line">/src/server/proto</span><br></pre></td></tr></table></figure><h3 id="4-prettier-config-js"><a href="#4-prettier-config-js" class="headerlink" title="4 prettier.config.js"></a>4 prettier.config.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"><span class="string">"printWidth"</span>: <span class="number">80</span>,</span><br><span class="line"><span class="string">"tabWidth"</span>: <span class="number">4</span>,</span><br><span class="line"><span class="string">"singleQuote"</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="string">"semi"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">"trailingComma"</span>: <span class="string">"none"</span>,</span><br><span class="line"><span class="string">"bracketSpacing"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">"arrowParens"</span>: <span class="string">"avoid"</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-editorconfig"><a href="#5-editorconfig" class="headerlink" title="5 .editorconfig"></a>5 .editorconfig</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># http://editorconfig.org</span><br><span class="line"></span><br><span class="line">root = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[*]</span><br><span class="line">charset = utf<span class="number">-8</span></span><br><span class="line">indent_style = tab</span><br><span class="line">insert_final_newline = <span class="literal">true</span></span><br><span class="line">trim_trailing_whitespace = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[*.md]</span><br><span class="line">max_line_length = off</span><br></pre></td></tr></table></figure><h3 id="6-Vscodeæ’ä»¶"><a href="#6-Vscodeæ’ä»¶" class="headerlink" title="6. Vscodeæ’ä»¶"></a>6. Vscodeæ’ä»¶</h3><p><code>Prettier Eslint</code> è§„åˆ™ä¼šä½¿ç”¨eslintä¸­çš„è§„åˆ™ï¼Œæ­¤æ’ä»¶ä»…åœ¨eslinté¡¹ç›®ä¸‹æ ¼å¼åŒ–æœ‰æ•ˆã€‚</p><p><code>Prettier - Code formatter</code> ä¼šä½¿ç”¨prettier.config.jsçš„è§„åˆ™</p><p>ä¾æ®ä¸ªäººéœ€æ±‚ï¼Œé€‰æ‹©æ˜¯å¦ä¿å­˜å¹¶æ ¼å¼åŒ–</p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gomwg68xzpj30ay03l0tc.jpg" alt="image-20210317144545343"></p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gomwgmfjo7j30ai01vaa5.jpg" alt="image-20210317144611017"></p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEly1gosszl3ze5j30cv03ddg5.jpg" alt="image-20210322171921452"></p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gomwh86scbj30n0096tb3.jpg" alt="image-20210317144645630"></p><h3 id="7-npm-run-fix-amp-amp-npm-run-lint"><a href="#7-npm-run-fix-amp-amp-npm-run-lint" class="headerlink" title="7. npm run fix &amp;&amp; npm run lint"></a>7. npm run fix &amp;&amp; npm run lint</h3><p>ç¬¬ä¸€æ¬¡å¼•å…¥é¡¹ç›®å…ˆæ‰§è¡Œnpm run fixï¼Œç›®çš„æ˜¯ç»Ÿä¸€é¡¹ç›®ä¸­æ‰€æœ‰å•åŒå¼•å·ï¼Œç¼©è¿›ï¼Œæ ¼å¼ã€‚åæ‰§è¡Œnpm run lint ã€‚npm run lint(eslint â€“fix)å¯¹ä¸€äº›ç¼©è¿›æ ¼å¼ä¸æ˜¯ç‰¹åˆ«æ•æ„Ÿï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œä¸€éfixï¼Œå†æ‰§è¡Œlintã€‚ ä»¥åé¡¹ç›®å¯ä¸å†æ‰§è¡Œnpm run fixï¼Œç¼–è¾‘æäº¤æ—¶åªæ‰§è¡Œnpm run lintã€‚</p><p>npm run fix åœ¨ä½ å¼•å…¥åˆ°ç°æœ‰é¡¹ç›®åæ‰§è¡Œï¼Œå¸®ä½ æŠŠä»£ç æ ¼å¼åŒ–åˆ°prettierçš„é…ç½®</p><p>npm run lint  å¸¦äº†<code>--fix</code>ï¼Œå®ƒä¼šæ ¼å¼åŒ–ä»£ç ï¼Œä¼šä¿®å¤ä¸€äº›è§„åˆ™ã€‚</p><p>å¼•å…¥è€é¡¹ç›®åã€‚å‘ç°æœ‰ç‚¹å¥”æºƒğŸ˜¿</p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gomwjnrwyoj304002zdfu.jpg" alt="image-20210317144905929"></p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gomwxinde9j307w0pedhf.jpg" alt="image-20210317150225545"></p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gomwx1h4tnj30ov0hn45i.jpg" alt="image-20210317150157795"></p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gomwhtbic7j30m70idjv6.jpg" alt="image-20210317144719347"></p><p>ç»è¿‡ä¿®å¤å</p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gp409inu2kj30kb088myp.jpg" alt="image-20210401095218422"></p><h3 id="8-husky"><a href="#8-husky" class="headerlink" title="8 husky"></a>8 husky</h3><p><a href="https://github.com/typicode/husky" target="_blank" rel="noopener">husky</a>ä¸€ä¸ªGit Hook å·¥å…·ï¼Œ<a href="https://typicode.github.io/husky/#/" target="_blank" rel="noopener">æ–‡æ¡£</a> å°†å…¶å®‰è£…åˆ°æ‰€åœ¨ä»“åº“çš„è¿‡ç¨‹ä¸­å®ƒä¼šè‡ªåŠ¨åœ¨ .git/ ç›®å½•ä¸‹å¢åŠ ç›¸åº”çš„é’©å­å®ç°åœ¨ pre-commit é˜¶æ®µå°±æ‰§è¡Œä¸€ç³»åˆ—æµç¨‹ä¿è¯æ¯ä¸€ä¸ª commit çš„æ­£ç¡®æ€§ã€‚</p><p><code>npm install husky --save-dev &amp;&amp; npx husky init</code></p><p>or</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">npm install husky --save-dev  ||  yarn add husky --save-dev</span><br><span class="line"></span><br><span class="line">npx husky install || yarn husky install</span><br><span class="line">  æˆ–è€…ä¹Ÿå¯ä»¥åœ¨é¡¹ç›®å†…å®¹install</span><br><span class="line">  // package.json</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;scripts&quot;: &#123;</span><br><span class="line">      &quot;prepare&quot;: &quot;husky install&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><img src="/Users/linkai/Library/Application Support/typora-user-images/image-20210317150442297.png" alt="image-20210317150442297"></p><p>æ·»åŠ é’©å­</p><p><code>npx husky add .husky/pre-commit &quot;npm run lint&quot;</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">. <span class="string">"<span class="variable">$(dirname "$0")</span>/_/husky.sh"</span></span><br><span class="line"></span><br><span class="line">    npm run lint</span><br></pre></td></tr></table></figure><p><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gomwtcpi8hj306t02fwef.jpg" alt="image-20210317145824823"></p><h3 id="9-æ”¹ä»£ç "><a href="#9-æ”¹ä»£ç " class="headerlink" title="9 æ”¹ä»£ç "></a>9 æ”¹ä»£ç </h3><p>come onï¼</p><h2 id="é™„"><a href="#é™„" class="headerlink" title="é™„"></a>é™„</h2><h3 id="1-Eslintå¸¸ç”¨é…ç½®é¡¹"><a href="#1-Eslintå¸¸ç”¨é…ç½®é¡¹" class="headerlink" title="1. Eslintå¸¸ç”¨é…ç½®é¡¹"></a>1. Eslintå¸¸ç”¨é…ç½®é¡¹</h3><p>åŠ å…¥script ã€‚å…·ä½“å†…éƒ¨é…ç½®è¯¸ä½é…Œæƒ…ä½¿ç”¨ï¼Œä¸å¸¸ç”¨çš„è§<a href="https://eslint.bootcss.com/docs/user-guide/command-line-interface" target="_blank" rel="noopener">æ–‡æ¡£</a></p><ul><li><code>.</code>ä»£è¡¨çš„æ˜¯æ‰€æœ‰æ–‡ä»¶ã€‚ä¹Ÿå¯ä»¥å†™å…·ä½“çš„ç›®å½•ï¼Œæ¯”å¦‚<code>pages</code>ï¼Œ<code>utils</code>ç­‰</li><li><code>--fix</code>ä¿®å¤æ–‡ä»¶ï¼Œå‰©ä¸‹çš„æœªä¿®å¤çš„é—®é¢˜æ‰ä¼šè¾“å‡ºåˆ°å‘½ä»¤è¡Œ</li><li><code>--fix-dry-run</code>ï¼šè¯¥é€‰é¡¹ä¸ <code>--fix</code> æœ‰ç›¸åŒçš„æ•ˆæœï¼Œå”¯ä¸€ä¸€ç‚¹ä¸åŒæ˜¯ï¼Œä¿®å¤ä¸ä¼šä¿å­˜åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚</li><li><code>--ext</code>ï¼šå¯ä»¥æŒ‡å®šåœ¨æŒ‡å®šç›®å½•ä¸­æœç´¢JavaScriptæ–‡ä»¶æ—¶ï¼ŒESLintå°†ä½¿ç”¨å“ªäº›æ–‡ä»¶æ‰©å±•åã€‚é»˜è®¤æ‰©å±•åä¸º<code>.js</code>ã€‚</li><li><code>--global</code>ï¼šç”¨äºå®šä¹‰å…¨å±€å˜é‡ã€‚ä»»ä½•æŒ‡å®šçš„å…¨å±€å˜é‡é»˜è®¤æ˜¯åªè¯»çš„ï¼Œåœ¨å˜é‡åå­—ååŠ ä¸Š <code>:true</code> åä¼šä½¿å®ƒå˜ä¸ºå¯å†™ã€‚è¦æŒ‡å®šå¤šä¸ªå˜é‡ï¼Œä½¿ç”¨é€—å·åˆ†éš”å®ƒä»¬ï¼Œæˆ–å¤šæ¬¡ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ã€‚</li><li><code>--quiet</code>åªä¼šæŠ¥å‘Šé”™è¯¯error</li><li><code>--max-warnings</code>æŒ‡å®šä¸€ä¸ªè­¦å‘Šçš„é˜ˆå€¼,å½“ä½ çš„é¡¹ç›®ä¸­æœ‰å¤ªå¤šè¿åè§„åˆ™çš„è­¦å‘Šæ—¶ï¼Œè¿™ä¸ªé˜ˆå€¼è¢«ç”¨æ¥å¼ºåˆ¶ ESLint ä»¥é”™è¯¯çŠ¶æ€é€€å‡º  ç¤ºä¾‹:<code>eslint --max-warnings 10 file.js</code></li><li><code>-o</code>å°†æŠ¥å‘Šå†™åˆ°ä¸€ä¸ªæ–‡ä»¶ã€‚ç¤ºä¾‹ :<code>eslint -o ./test/test.html</code></li><li><code>--cache</code>ç¼“å­˜é»˜è®¤è¢«å­˜å‚¨åœ¨ <code>.eslintcache</code>å¯ç”¨è¿™ä¸ªé€‰é¡¹å¯ä»¥æ˜¾è‘—æ”¹å–„ ESLint çš„è¿è¡Œæ—¶é—´ï¼Œç¡®ä¿åªå¯¹æœ‰æ”¹å˜çš„æ–‡ä»¶è¿›è¡Œæ£€æµ‹ã€‚<br><img src="https://tva1.sinaimg.cn/large/008eGmZEgy1gomw6os2fmj30x80g87a8.jpg"></li></ul><h3 id="2-Exit-codes"><a href="#2-Exit-codes" class="headerlink" title="2. Exit codes"></a>2. Exit codes</h3><p> å½“æ£€æµ‹å®Œæ¯•åï¼Œeslintä¼šæœ‰çŠ¶æ€ç æé†’</p><ul><li><code>0</code>: æ£€æµ‹æˆåŠŸï¼Œæ²¡æœ‰é”™è¯¯ã€‚å¦‚æœ <code>--max-warnings</code> æ ‡å¿—è¢«è®¾ç½®ä¸º <code>n</code>ï¼Œé‚£ä¹ˆè­¦å‘Šæ•°é‡æœ€å¤šä¸º<code>n</code>ã€‚</li><li><code>1</code>: æ£€æµ‹æˆåŠŸï¼Œå¹¶ä¸”è‡³å°‘æœ‰ä¸€ä¸ªé”™è¯¯ï¼Œæˆ–è€…è­¦å‘Šå¤šäº <code>--max-warnings</code> é€‰é¡¹æ‰€å…è®¸çš„è­¦å‘Šã€‚</li><li><code>2</code>: ç”±äºé…ç½®é—®é¢˜æˆ–å†…éƒ¨é”™è¯¯ï¼Œæ£€æµ‹æœªèƒ½æˆåŠŸã€‚</li></ul><h3 id="3-å¿½ç•¥ç›¸å…³"><a href="#3-å¿½ç•¥ç›¸å…³" class="headerlink" title="3. å¿½ç•¥ç›¸å…³"></a>3. å¿½ç•¥ç›¸å…³</h3><ol><li>åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ è§„åˆ™ï¼Œæ•´ä¸ªæ–‡ä»¶å¿½ç•¥</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-disable */</span></span><br><span class="line"><span class="comment">// ä»£ç å¼€å§‹ä½ç½®</span></span><br></pre></td></tr></table></figure><ol start="2"><li>ä¸´æ—¶ç¦æ­¢</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-disable */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line"><span class="comment">/* eslint-enable */</span></span><br></pre></td></tr></table></figure><ol start="3"><li>å¯¹æŒ‡å®šè§„åˆ™å¿½ç•¥</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-disable no-alert, no-console */</span></span><br><span class="line">alert(<span class="string">'foo'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'bar'</span>);</span><br><span class="line"><span class="comment">/* eslint-enable no-alert, no-console */</span></span><br></pre></td></tr></table></figure><ol start="4"><li>æŒ‡å®šè¡Œå¿½ç•¥</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="string">'foo'</span>); <span class="comment">// eslint-disable-line</span></span><br><span class="line"><span class="comment">// eslint-disable-next-line</span></span><br><span class="line">alert(<span class="string">'foo'</span>);</span><br></pre></td></tr></table></figure><ol start="5"><li>æŒ‡å®šè¡Œç¦ç”¨æŸä¸ªè§„åˆ™</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="string">'foo'</span>); <span class="comment">// eslint-disable-line no-alert</span></span><br><span class="line"><span class="comment">// eslint-disable-next-line no-alert</span></span><br><span class="line">alert(<span class="string">'foo'</span>);</span><br></pre></td></tr></table></figure><ol start="6"><li>æŒ‡å®šè¡Œç¦ç”¨å¤šä¸ªè§„åˆ™</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="string">'foo'</span>); <span class="comment">// eslint-disable-line no-alert, quotes, semi</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// eslint-disable-next-line no-alert, quotes, semi</span></span><br><span class="line">alert(<span class="string">'foo'</span>);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      ESLintç›¸å…³ï¼Œç»§æ‰¿çš„ä¸»è¦æ˜¯çˆ±å½¼è¿ã€eslintæ¨èã€typescript-eslintæ¨èã€Reactæ¨èè§„Rï¼Œå‚»ç“œå¼æ“ä½œæ­¥éª¤ï¼Œä¸ªäººå®è·µï¼Œå¯èƒ½è¿˜å­˜åœ¨é—®é¢˜ï¼Œæœ›å¤šå¤šæŒ‡æ•™
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="ESLint" scheme="https://kitions.github.io/tags/ESLint/"/>
    
  </entry>
  
  <entry>
    <title>React  0 -&gt; Hooks</title>
    <link href="https://kitions.github.io/2021/01/04/0%20-%20hooks/"/>
    <id>https://kitions.github.io/2021/01/04/0 - hooks/</id>
    <published>2021-01-04T10:29:32.000Z</published>
    <updated>2022-10-17T03:30:46.826Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0-gt-Hooks"><a href="#0-gt-Hooks" class="headerlink" title="0 -&gt; Hooks"></a>0 -&gt; Hooks</h1><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">funcition App ()&#123;</span><br><span class="line">  <span class="keyword">const</span> [num, setNum] = useState(<span class="number">0</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    onClick ()&#123;</span><br><span class="line">      setNum(<span class="function"><span class="params">num</span> =&gt;</span> num + <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>React è¿è¡Œç¯å¢ƒ</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> isMount = <span class="literal">true</span>  <span class="comment">// didMount or didUpdate</span></span><br><span class="line"><span class="keyword">let</span> workInProgressHook = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fiber = &#123;</span><br><span class="line">  stateNode: App,</span><br><span class="line">  memoizedState: <span class="literal">null</span>,  <span class="comment">// é“¾è¡¨</span></span><br><span class="line">  queue:&#123;    <span class="comment">// é˜Ÿåˆ—</span></span><br><span class="line">    pending: <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">schedule</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  workInProgressHook = fiber.memoizedState;</span><br><span class="line">  <span class="keyword">const</span> app = fiber.stateNode();</span><br><span class="line">  isMount = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> app</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.app = schedule()</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useState</span>(<span class="params">initState</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// å½“å‰hook</span></span><br><span class="line">  <span class="keyword">let</span> hook;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(isMount)&#123;</span><br><span class="line">    hook = &#123;  <span class="comment">// å•å‘é“¾è¡¨</span></span><br><span class="line">      memoizedState: initState,</span><br><span class="line">      next: <span class="literal">null</span> <span class="comment">// æŒ‡é’ˆ ä¸‹ä¸€ä¸ª</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!fiber.memoizedSate)&#123;</span><br><span class="line">      fiber.memoizedState = hook;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      workInProgressHook.next  = hook</span><br><span class="line">    &#125;</span><br><span class="line">     workInProgressHook  = hook</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    hook = workInProgressHook;</span><br><span class="line">    workInProgressHook = workInProgressHook.next</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å–åˆ°äº†å½“å‰useStateçš„æ•°æ®</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// todo</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dispathAction</span>(<span class="params">queue, action</span>)</span>&#123;</span><br><span class="line"><span class="keyword">const</span> update =&#123; <span class="comment">// ç¯çŠ¶é“¾è¡¨</span></span><br><span class="line">    action,</span><br><span class="line">    next</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(queue.pending === <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// u0 -&gt; u0 -&gt; u0</span></span><br><span class="line">    update.next = update</span><br><span class="line">    </span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// u0 -&gt; u0</span></span><br><span class="line">   <span class="comment">// u1 -&gt; u0 -&gt; u1</span></span><br><span class="line">    <span class="comment">// queue.pending // æœ€åç¬¬ä¸€ä¸ª</span></span><br><span class="line">    <span class="comment">// queue.pending.next //ç¬¬ä¸€ä¸ª</span></span><br><span class="line">    update.next = queue.pending.next; <span class="comment">// u1 -&gt; u0</span></span><br><span class="line">    queue.pending.next = update; <span class="comment">// u0 -&gt; u1</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  queue.pending = update;</span><br><span class="line">  </span><br><span class="line">  schedule();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useState</span>(<span class="params">initState</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// å½“å‰hook</span></span><br><span class="line">  <span class="keyword">let</span> hook;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(isMount)&#123;</span><br><span class="line">    hook = &#123;  <span class="comment">// å•å‘é“¾è¡¨</span></span><br><span class="line">      memoizedState: initState,</span><br><span class="line">      next: <span class="literal">null</span> <span class="comment">// æŒ‡é’ˆ ä¸‹ä¸€ä¸ª</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!fiber.memoizedSate)&#123;</span><br><span class="line">      fiber.memoizedState = hook;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      workInProgressHook.next  = hook</span><br><span class="line">    &#125;</span><br><span class="line">     workInProgressHook  = hook</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    hook = workInProgressHook;</span><br><span class="line">    workInProgressHook = workInProgressHook.next</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å–åˆ°äº†å½“å‰useStateçš„æ•°æ®</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> baseState = hook.memoizedState;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(hook.queue.pending)&#123;</span><br><span class="line">    <span class="keyword">let</span> firstupdate = hook.queue.pending.next;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">      <span class="keyword">const</span> action = firstUpdate.action</span><br><span class="line">      baseState = action(baseState)</span><br><span class="line">      firstUpdate = firstUpdate.next;</span><br><span class="line">    &#125;<span class="keyword">while</span>(firstUpdate !== hook.queue.pending.next)</span><br><span class="line">      </span><br><span class="line">    hook.queue.pending = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  hook.memoizedState = baseState;</span><br><span class="line">  <span class="keyword">return</span> [baseState, disPatchAction.bind(<span class="literal">null</span>, hook.queue)]</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œæ•´ä»£ç </p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> isMount = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> workInProgressHook = <span class="literal">null</span>   <span class="comment">// å˜é‡  å½“å‰å¤„ç†å“ªä¸€ä¸ªhook</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fiber = &#123;</span><br><span class="line">    stateNode: App,</span><br><span class="line">    memoizedState: <span class="literal">null</span>, <span class="comment">// ä¿å­˜hooksæ•°æ® ä¸€æ¡é“¾è¡¨ æ¯ä¸€ä¸ªhookæ•°æ®</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">schedule</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    workInProgressHook = fiber.memoizedState</span><br><span class="line">    <span class="keyword">const</span> app = fiber.stateNode()</span><br><span class="line">    isMount = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> app</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useState</span>(<span class="params">initState</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> hook;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isMount) &#123;</span><br><span class="line">        hook = &#123;  <span class="comment">// å•å‘é“¾è¡¨</span></span><br><span class="line">            memoizedState: initState,</span><br><span class="line">            next: <span class="literal">null</span>,</span><br><span class="line">            queue: &#123;</span><br><span class="line">                pending: <span class="literal">null</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!fiber.memoizedState) &#123;</span><br><span class="line">            fiber.memoizedState = hook</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            workInProgressHook.next = hook</span><br><span class="line">        &#125;</span><br><span class="line">        workInProgressHook = hook</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//  å·²ç»æœ‰ä¸€æ¡é“¾è¡¨äº†</span></span><br><span class="line">        hook = workInProgressHook; <span class="comment">// å–åˆ°äº†</span></span><br><span class="line">        workInProgressHook = workInProgressHook.next; <span class="comment">// æŒ‡å‘ä¸‹ä¸€ä¸ª</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å–åˆ°äº†å½“å‰useStateå¯¹åº”çš„æ•°æ® ï¼Œthen è®¡ç®—æ–°çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> baseState = hook.memoizedState</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (hook.queue.pending) &#123;</span><br><span class="line">        <span class="keyword">let</span> firstUpdate = hook.queue.pending.next <span class="comment">// ç¬¬ä¸€ä¸ªupdate</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> action = firstUpdate.action</span><br><span class="line">            baseState = action(baseState);</span><br><span class="line">            firstUpdate = firstUpdate.next <span class="comment">// æŒ‡å‘ä¸‹ä¸€ä¸ª</span></span><br><span class="line">        &#125; <span class="keyword">while</span> (firstUpdate != hook.queue.pending.next)</span><br><span class="line"></span><br><span class="line">        hook.queue.pending = <span class="literal">null</span> <span class="comment">// è®¡ç®—å®Œ æ¸…ç©º</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    hook.memoizedState = baseState</span><br><span class="line">    <span class="keyword">return</span> [baseState, dispatchAction.bind(<span class="literal">null</span>, hook.queue)]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// setNum - action</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dispatchAction</span>(<span class="params">queue, action</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºæ•°æ®ç»“æ„updateï¼Œæ¯æ¬¡æ›´æ–°æœ‰ä¼˜å…ˆçº§çš„ï¼Œclick &gt; fecth</span></span><br><span class="line">    <span class="keyword">const</span> update = &#123;</span><br><span class="line">        action, <span class="comment">// ç¯è£…é“¾è¡¨</span></span><br><span class="line">        next: <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é“¾è¡¨æ“ä½œ</span></span><br><span class="line">    <span class="keyword">if</span> (queue.pending === <span class="literal">null</span>) &#123;</span><br><span class="line">        update.next = update</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// u0 -&gt; u0</span></span><br><span class="line">        <span class="comment">// u1 -&gt; u0 -&gt; u1</span></span><br><span class="line">        <span class="comment">// queue.pending æœ€åä¸€ä¸ªupdate</span></span><br><span class="line">        <span class="comment">// queue.pending.next ç¬¬ä¸€ä¸ªupdate</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"ç¬¬ä¸€ä¸ªupdate"</span>,queue.pending.next)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"æœ€åä¸€ä¸ªupdate"</span>,queue.pending)</span><br><span class="line">        update.next = queue.pending.next; <span class="comment">// u1 =&gt; u0</span></span><br><span class="line">        queue.pending.next = update; <span class="comment">// u0 =&gt; u1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ¯æ¬¡æ‰§è¡Œå°±æ˜¯æœ€åä¸€ä¸ªupdate</span></span><br><span class="line">    queue.pending = update</span><br><span class="line"></span><br><span class="line">    schedule()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// FC ä¿å­˜hooksæ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [num, setNum] = useState(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">const</span> [num1, setNum1] = useState(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">const</span> [num2, setNum2] = useState(<span class="number">22</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(isMount)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"num"</span>,num)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"num1"</span>,num1)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"num2"</span>,num2)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"----"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        onClick() &#123;</span><br><span class="line">            setNum(<span class="function"><span class="params">num</span> =&gt;</span> num + <span class="number">1</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        set() &#123;</span><br><span class="line">            setNum1(<span class="function"><span class="params">num</span> =&gt;</span> num + <span class="number">10</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        set2() &#123;</span><br><span class="line">            setNum2(<span class="function"><span class="params">num</span> =&gt;</span> num + <span class="number">10</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.app = schedule()</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      ä»0 -&gt; Hooks
    
    </summary>
    
      <category term="React" scheme="https://kitions.github.io/categories/React/"/>
    
    
      <category term="React" scheme="https://kitions.github.io/tags/React/"/>
    
  </entry>
  
  <entry>
    <title>wx-open-launch-appæŒ‡å—</title>
    <link href="https://kitions.github.io/2020/10/21/wx-open-launch-app%E9%87%87%E5%9D%91%E6%8C%87%E5%8D%97/"/>
    <id>https://kitions.github.io/2020/10/21/wx-open-launch-appé‡‡å‘æŒ‡å—/</id>
    <published>2020-10-21T08:10:03.000Z</published>
    <updated>2022-10-17T03:30:46.829Z</updated>
    
    <content type="html"><![CDATA[<h1 id="wx-open-launch-appæŒ‡å—"><a href="#wx-open-launch-appæŒ‡å—" class="headerlink" title="wx-open-launch-appæŒ‡å—"></a>wx-open-launch-appæŒ‡å—</h1><p>ä»Šå¹´5æœˆå¾®ä¿¡åˆšå¼€æ”¾çš„APIï¼Œä»¥å¾€åªå¯¹å®ƒæŠ•èµ„çš„å…¬å¸ï¼Œæˆ–è€…å¹²å„¿å­å¼€æ”¾ï¼Œç°åœ¨å¯¹ç»‘å®šæœåŠ¡å·ä¸”è®¤è¯çš„ä¼ä¸šéƒ½å¼€æ”¾äº†ï¼Œæ¥å…¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ„Ÿè§‰æ–‡æ¡£å¤ªç®€å•ï¼Œè¦†ç›–é¢ä¸è¶³ï¼Œä¸è¿‡éƒ½å¯ä»¥è‡ªå·±é‡‡å‘æ¥è§£å†³ï¼Œå¯ä»¥å»<a href="https://developers.weixin.qq.com/community/" target="_blank" rel="noopener">å¾®ä¿¡å¼€æ”¾ç¤¾åŒº</a>æé—®æˆ–è€…æ‰¾ç›¸åº”åˆ«äººè¸©è¿‡çš„å‘æ‰¾ç­”æ¡ˆã€‚</p><h2 id="ä¸€ã€æ¥å…¥"><a href="#ä¸€ã€æ¥å…¥" class="headerlink" title="ä¸€ã€æ¥å…¥"></a>ä¸€ã€æ¥å…¥</h2><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjx07td2opj30tw07ut9u.jpg" alt="image-20201021155005245"></p><p>è·å¾—æ­¤è®¾ç½®å…¥å£çš„æƒé™ï¼Œéœ€åŒæ—¶æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š</p><ol><li>æœåŠ¡å·å·²è®¤è¯</li><li>å¼€æ”¾å¹³å°è´¦å·å·²è®¤è¯</li><li>æœåŠ¡å·ä¸å¼€æ”¾å¹³å°è´¦å·åŒä¸»ä½“</li></ol><h3 id="ç»‘å®šåŸŸåå’Œç§»åŠ¨åº”ç”¨"><a href="#ç»‘å®šåŸŸåå’Œç§»åŠ¨åº”ç”¨" class="headerlink" title="ç»‘å®šåŸŸåå’Œç§»åŠ¨åº”ç”¨"></a>ç»‘å®šåŸŸåå’Œç§»åŠ¨åº”ç”¨</h3><ol><li>ç»‘å®šåŸŸåçš„è¦æ±‚ï¼š</li></ol><ul><li>åŸŸåé¡»ä¸ºå½“å‰æœåŠ¡å·çš„ JS å®‰å…¨åŸŸåæˆ–å…¶å­åŸŸå</li><li>åŸŸååªèƒ½åŒæ—¶ç»‘å®šä¸€ä¸ªç§»åŠ¨åº”ç”¨ï¼Œå› æ­¤é¡»ç¡®ä¿åŸŸåæœªè¢«å…¶ä»–ç§»åŠ¨åº”ç”¨ç»‘å®š</li></ul><ol start="2"><li>ç»‘å®šç§»åŠ¨åº”ç”¨çš„è¦æ±‚</li></ol><ul><li>åªèƒ½ç»‘å®šåŒä¸€å¾®ä¿¡å¼€æ”¾å¹³å°è´¦å·ä¸‹å®¡æ ¸é€šè¿‡çš„ç§»åŠ¨åº”ç”¨</li></ul><ol start="3"><li>ç»‘å®šæ¬¡æ•°</li></ol><ul><li>æ¯æœˆå¯ä¿®æ”¹ç»‘å®š3æ¬¡</li></ul><hr><p>ä»¥ä¸Šæ˜¯ äº§å“ç»ç†è´Ÿè´£ä¿®æ”¹ï¼Œä½ åªéœ€è¦æ‹¿åˆ°appçš„idï¼Œå°ç¨‹åºçš„idï¼Œç¡®ä¿ç¬¬ä¸€å¼ å›¾çš„å®‰å…¨åŸŸåè·Ÿä½ å¼€å‘çš„ç«™çš„å®Œå…¨ä¸€è‡´ï¼Œä¸æ”¯æŒäºŒçº§åŸŸåå“¦ï¼</p><p>ä»¥ä¸‹ä»£ç æ˜¯åœ¨ä½ é¡µé¢ä¸­å·²ç»æ³¨å…¥è¿‡wx.configçš„æ¡ä»¶ä¸‹,å¹¶ä¸”æ–°å¢</p><p>wx.config { openTagList: [â€˜wx-open-launch-appâ€™, â€˜wx-open-launch-weappâ€™]}</p><h3 id="åœ¨ä½ çš„H5ä¸­æ¥å…¥å¾®ä¿¡å¼€æ”¾æ ‡ç­¾"><a href="#åœ¨ä½ çš„H5ä¸­æ¥å…¥å¾®ä¿¡å¼€æ”¾æ ‡ç­¾" class="headerlink" title="åœ¨ä½ çš„H5ä¸­æ¥å…¥å¾®ä¿¡å¼€æ”¾æ ‡ç­¾"></a>åœ¨ä½ çš„H5ä¸­æ¥å…¥å¾®ä¿¡å¼€æ”¾æ ‡ç­¾</h3><h4 id="1-å¾®ä¿¡å°ç¨‹åº"><a href="#1-å¾®ä¿¡å°ç¨‹åº" class="headerlink" title="1. å¾®ä¿¡å°ç¨‹åº"></a>1. å¾®ä¿¡å°ç¨‹åº</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;wx-open-launch-weapp</span><br><span class="line">                          id=<span class="string">"launch-btn-weapp"</span></span><br><span class="line">                          username=<span class="string">"gh_*****"</span></span><br><span class="line">                          path=<span class="string">"pages/home/home.html"</span></span><br><span class="line">                      &gt;</span><br><span class="line">                          &lt;script type=<span class="string">"text/wxtag-template"</span>&gt;</span><br><span class="line">                              &lt;div className=<span class="string">"btn1"</span> style=&#123;&#123; <span class="attr">width</span>: <span class="string">'170px'</span>, <span class="attr">height</span>: <span class="string">'70px'</span>, <span class="attr">lineHeight</span>: <span class="string">"70px"</span>, <span class="attr">color</span>: <span class="string">"rgba(0,0,0,1)"</span>, <span class="attr">display</span>: <span class="string">"block"</span>, <span class="attr">fontSize</span>: <span class="string">"38px"</span>, <span class="attr">textAlign</span>: <span class="string">"center"</span> &#125;&#125;&gt;æ‰“å¼€å°ç¨‹åº&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">                          &lt;/</span>script&gt;</span><br><span class="line">                          &#123;<span class="comment">/* @ts-ignore */</span>&#125;</span><br><span class="line">                      &lt;<span class="regexp">/wx-open-launch-weapp&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-APP"><a href="#2-APP" class="headerlink" title="2.  APP"></a>2.  APP</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt; wx-open-launch-app</span><br><span class="line">id = <span class="string">"launch-btn-app"</span></span><br><span class="line">appid = <span class="string">""</span></span><br><span class="line">extinfo = &#123;<span class="string">`å¸¦ç»™appçš„ä¿¡æ¯ å¯ä»¥ä½¿ç”¨åè®®ï¼Œè®©appç«¯æ¥å—`</span>&#125;</span><br><span class="line">&gt;</span><br><span class="line">&lt;script type=<span class="string">"text/wxtag-template"</span> &gt;</span><br><span class="line">&lt;div style=&#123;&#123; <span class="attr">width</span>: <span class="string">'170px'</span>, <span class="attr">height</span>: <span class="string">'70px'</span>, <span class="attr">lineHeight</span>: <span class="string">"70px"</span>, <span class="attr">color</span>: <span class="string">"rgba(0,0,0,1)"</span>, <span class="attr">display</span>: <span class="string">"block"</span>, <span class="attr">fontSize</span>: <span class="string">"38px"</span>, <span class="attr">textAlign</span>: <span class="string">"center"</span> &#125;&#125;&gt; æ‰“å¼€App &lt; <span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt; /</span>script&gt;</span><br><span class="line">&#123;<span class="comment">/* @ts-ignore */</span> &#125;</span><br><span class="line">&lt;<span class="regexp">/wx-open-launch-app&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-JSç”ŸæˆDom"><a href="#3-JSç”ŸæˆDom" class="headerlink" title="3. JSç”ŸæˆDom"></a>3. JSç”ŸæˆDom</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dom.innerHTML = <span class="string">'&lt;wx-open-launch-app style="width:100%; display:block;" id="launch-btn"  extinfo="" appid=""&gt;&lt;template&gt;&lt;div class="wx-btn" style="color:#fff;text-align:center" &gt;JSç”Ÿæˆçš„æŒ‰é’®&lt;/div&gt;&lt;/template&gt;&lt;/wx-open-launch-app&gt;'</span></span><br><span class="line">           <span class="keyword">var</span> launchBtn = <span class="built_in">document</span>.getElementById(<span class="string">'launch-btn'</span>)</span><br><span class="line">           <span class="built_in">console</span>.log(<span class="string">"launchBtn"</span>, launchBtn)</span><br><span class="line">           <span class="keyword">if</span> (!launchBtn) &#123;</span><br><span class="line">               <span class="keyword">return</span></span><br><span class="line">           &#125;</span><br><span class="line">           launchBtn.addEventListener(<span class="string">'launch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">               <span class="built_in">console</span>.log(<span class="string">'btlaunchBtnn success'</span>)</span><br><span class="line">           &#125;)</span><br><span class="line">           launchBtn.addEventListener(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e: any</span>) </span>&#123;</span><br><span class="line">               <span class="built_in">console</span>.log(<span class="string">'launchBtnfail'</span>, e.detail)</span><br><span class="line">           &#125;)</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€åˆ‡æ­£å¸¸çš„è¯ï¼Œå°±å¯ä»¥å”¤èµ·ä½ çš„å°ç¨‹åºå’ŒAPPäº†</p><p>æ³¨æ„çš„æ˜¯</p><blockquote><p>å¾®ä¿¡ç‰ˆæœ¬è¦æ±‚ä¸ºï¼š7.0.12åŠä»¥ä¸Šã€‚ ç³»ç»Ÿç‰ˆæœ¬è¦æ±‚ä¸ºï¼šiOS 10.3åŠä»¥ä¸Šã€Android 5.0åŠä»¥ä¸Šï¼Œweixin.js ç‰ˆæœ¬1.6.0ä»¥ä¸Š</p><p><a href="https://res.wx.qq.com/open/js/jweixin-1.6.0.js" target="_blank" rel="noopener">https://res.wx.qq.com/open/js/jweixin-1.6.0.js</a></p></blockquote><h4 id="4-é”™è¯¯è¿”å›"><a href="#4-é”™è¯¯è¿”å›" class="headerlink" title="4.  é”™è¯¯è¿”å›"></a>4.  é”™è¯¯è¿”å›</h4><p><code>error</code>äº‹ä»¶è¿”å›å€¼<code>errMsg</code>è¯´æ˜å¦‚ä¸‹ã€‚</p><table><thead><tr><th style="text-align:left">errMsg</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">â€œlaunch:failâ€</td><td style="text-align:left">è°ƒâ½¤å¤±è´¥ï¼Œæˆ–å®‰å“ä¸Šè¯¥åº”ç”¨æœªå®‰è£…ï¼Œæˆ–iOSä¸Šç”¨æˆ·åœ¨å¼¹çª—ä¸Šç‚¹å‡»ç¡®è®¤ä½†è¯¥åº”â½¤æœªå®‰è£…</td></tr><tr><td style="text-align:left">â€œlaunch:fail_check failâ€</td><td style="text-align:left">æ ¡éªŒAppè·³è½¬æƒé™å¤±è´¥ï¼Œè¯·ç¡®è®¤æ˜¯å¦æ­£ç¡®ç»‘å®šAppID</td></tr></tbody></table><h2 id="äºŒã€å‘-ä¸èƒ½æ˜¯äºŒçº§åŸŸå"><a href="#äºŒã€å‘-ä¸èƒ½æ˜¯äºŒçº§åŸŸå" class="headerlink" title="äºŒã€å‘ - ä¸èƒ½æ˜¯äºŒçº§åŸŸå"></a>äºŒã€å‘ - ä¸èƒ½æ˜¯äºŒçº§åŸŸå</h2><p>ç»æŸ¥è¯ï¼Œåªèƒ½æ˜¯å…·ä½“åŸŸåï¼Œä¸èƒ½æ˜¯äºŒçº§åŸŸå</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjwzr9w156j30ok0b1zlo.jpg" alt="image-20201021153405769"></p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjwzs1cl1cj30oe05t0t6.jpg" alt="image-20201021153455648"></p><h2 id="ä¸‰ã€å‚è€ƒé“¾æ¥"><a href="#ä¸‰ã€å‚è€ƒé“¾æ¥" class="headerlink" title="ä¸‰ã€å‚è€ƒé“¾æ¥"></a>ä¸‰ã€å‚è€ƒé“¾æ¥</h2><ol><li><p><a href="https://developers.weixin.qq.com/doc/oplatform/Mobile_App/WeChat_H5_Launch_APP.html" target="_blank" rel="noopener">å¾®ä¿¡å†…H5è·³è½¬APPæˆ–è€…å°ç¨‹åºæ–‡æ¡£</a></p></li><li><p><a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_Open_Tag.html" target="_blank" rel="noopener">å¾®ä¿¡å¼€æ”¾æ ‡ç­¾è¯´æ˜æ–‡æ¡£</a></p></li><li><a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/JS-SDK.html#1" target="_blank" rel="noopener">JS-SDKä½¿ç”¨æ­¥éª¤</a></li><li><a href="https://www.cnblogs.com/willian/p/13293030.html" target="_blank" rel="noopener">cnblogså…¶ä»–äººé‡‡å‘</a></li><li><a href="https://blog.csdn.net/WangYC_/article/details/107089709" target="_blank" rel="noopener">csdnå…¶ä»–äººé‡‡å‘</a></li><li><a href="https://developers.weixin.qq.com/community/develop/doc/0000065f1741801069eaec5e55b400?_at=1603177240329" target="_blank" rel="noopener">å®˜æ–¹å›å¤åŸŸåissues</a></li><li><a href="https://developers.weixin.qq.com/community/develop/doc/000082dea443f0d2042b5081156000" target="_blank" rel="noopener">è‡ªå·±æçš„åŸŸåissues</a></li></ol><h2 id="å››ã€å®Œæ•´ä»£ç "><a href="#å››ã€å®Œæ•´ä»£ç " class="headerlink" title="å››ã€å®Œæ•´ä»£ç "></a>å››ã€å®Œæ•´ä»£ç </h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsx</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>.isAllowWeixinTag(userAgent)</span><br><span class="line">?</span><br><span class="line"><span class="comment">// å¾®ä¿¡ç¯å¢ƒ</span></span><br><span class="line">&lt;&gt;</span><br><span class="line">&#123;<span class="comment">/* @ts-ignore */</span> &#125;</span><br><span class="line">&lt; wx-open-launch-app</span><br><span class="line">id = <span class="string">"launch-btn-app"</span></span><br><span class="line">appid = <span class="string">""</span></span><br><span class="line">extinfo = &#123;<span class="string">`å¸¦ç»™appçš„ä¿¡æ¯ å¯ä»¥ä½¿ç”¨åè®®ï¼Œè®©appç«¯æ¥å—`</span>&#125;</span><br><span class="line">&gt;</span><br><span class="line">&lt;script type=<span class="string">"text/wxtag-template"</span> &gt;</span><br><span class="line">&lt;div style=&#123;&#123; <span class="attr">width</span>: <span class="string">'170px'</span>, <span class="attr">height</span>: <span class="string">'70px'</span>, <span class="attr">lineHeight</span>: <span class="string">"70px"</span>, <span class="attr">color</span>: <span class="string">"rgba(0,0,0,1)"</span>, <span class="attr">display</span>: <span class="string">"block"</span>, <span class="attr">fontSize</span>: <span class="string">"38px"</span>, <span class="attr">textAlign</span>: <span class="string">"center"</span> &#125;&#125;&gt; æ‰“å¼€App &lt; <span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt; /</span>script&gt;</span><br><span class="line">&#123;<span class="comment">/* @ts-ignore */</span> &#125;</span><br><span class="line">&lt;<span class="regexp">/wx-open-launch-app&gt;</span></span><br><span class="line"><span class="regexp">&lt; /</span>&gt;</span><br><span class="line">: <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">"go_to_app"</span> <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">this.onApp</span> &#125; &gt;</span> æ‰“å¼€APP <span class="tag">&lt; /<span class="attr">span</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// äº‹ä»¶ç›‘å¬</span></span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">this</span>.isAllowWeixinTag(<span class="keyword">this</span>.props.userAgent)) <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"launch-btn-app"</span>)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"app"</span>, btn)</span><br><span class="line">            <span class="keyword">if</span>(!btn) <span class="keyword">return</span></span><br><span class="line">            btn.addEventListener(<span class="string">'launch'</span>, (e: any) =&gt; &#123;</span><br><span class="line">                <span class="comment">// åœ¨æ­¤å¤„å¯è®¾ç½®ç²˜è´´æ¿å†…æ•°æ®ï¼Œæ•°æ®æ˜¯ä¼ é€’ç»™ app çš„å‚æ•°è¿›ï¼Œ</span></span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">' app success'</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            btn.addEventListener(<span class="string">'error'</span>, (e: any) =&gt; &#123;</span><br><span class="line">                <span class="comment">// åœ¨æ­¤å¤„å¯è®¾ç½®ç²˜è´´æ¿å†…æ•°æ®ï¼Œæ•°æ®æ˜¯ä¼ é€’ç»™ app çš„å‚æ•°ï¼Œ</span></span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'app'</span>, e.detail);</span><br><span class="line">                <span class="comment">// å”¤é†’å¤±è´¥çš„æƒ…å†µä¸‹,å¯ä»¥æ‰“å¼€appç­‰</span></span><br><span class="line">                <span class="keyword">this</span>.onApp()</span><br><span class="line">            &#125;);    </span><br><span class="line">    </span><br><span class="line"> </span><br><span class="line"><span class="comment">//function</span></span><br><span class="line">    </span><br><span class="line">isAllowWeixinTag(userAgent: string)&#123;</span><br><span class="line">      &#123;<span class="comment">/* 1.å¾®ä¿¡ç¯å¢ƒ  2.å¾®ä¿¡ç‰ˆæœ¬å¤§äº7.0.12 */</span>&#125;</span><br><span class="line">     <span class="keyword">return</span> UA(userAgent).isWechat &amp;&amp; HandleJudgeWechat(userAgent)</span><br><span class="line">&#125;    </span><br><span class="line"><span class="keyword">const</span> HandleJudgeWechat = <span class="function">(<span class="params">ua: string</span>)=&gt;</span> &#123;</span><br><span class="line"><span class="keyword">let</span> wechat = ua.match(<span class="regexp">/MicroMessenger\/([\d\.]+)/i</span>);</span><br><span class="line"><span class="keyword">let</span> judgewechat = wechat[<span class="number">1</span>].split(<span class="string">'.'</span>)</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Number</span>(judgewechat[<span class="number">0</span>]) &gt;= <span class="number">7</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Number</span>(judgewechat[<span class="number">1</span>]) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Number</span>(judgewechat[<span class="number">2</span>]) &gt;= <span class="number">12</span>) &#123;</span><br><span class="line"><span class="comment">// console.log("å½“å‰å¾®ä¿¡ç‰ˆæœ¬å¤§äº7.0.12 å¯æ‰“å¼€æŒ‡å®šapp")</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº”ã€-æ€»ç»“"><a href="#äº”ã€-æ€»ç»“" class="headerlink" title="äº”ã€ æ€»ç»“"></a>äº”ã€ æ€»ç»“</h2><p>è¾ƒä¸ºç®€å•çš„æ¥å…¥ã€‚</p><p>åªèƒ½åˆ°å¾®ä¿¡å®‰å…¨åŸŸåä¸‹æµ‹è¯•ï¼Œå®åœ¨æ˜¯éº»çƒ¦ï¼Œå¯¼è‡´ åªèƒ½å‘ç‰ˆæµ‹è¯•ï¼Œè€Œä¸”å”¤é†’ç»‘å®šçš„é‚£ä¸ªåŸŸåæ˜¯æ­£å¼ç¯å¢ƒçš„ï¼Œç•¥éº»çƒ¦ã€‚å¾®ä¿¡å¼€å‘è€…å·¥å…·å¯¹è¿™ä¸ªæ–°æ ‡ç­¾å…¼å®¹æ€§ä¸æ˜¯å¾ˆå¥½ã€‚</p>]]></content>
    
    <summary type="html">
    
      ä»Šå¹´5æœˆå¾®ä¿¡æ–°å¼€æ”¾çš„api ï¼Œ å¾®ä¿¡ç¯å¢ƒH5å”¤èµ·APPå’Œå°ç¨‹åºå®è·µ
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="å¾®ä¿¡" scheme="https://kitions.github.io/tags/%E5%BE%AE%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>ç¾¤æ™–Momentså‘é€æœªçŸ¥é”™è¯¯</title>
    <link href="https://kitions.github.io/2020/10/18/%E7%BE%A4%E8%BE%89Moment/"/>
    <id>https://kitions.github.io/2020/10/18/ç¾¤è¾‰Moment/</id>
    <published>2020-10-18T08:24:19.000Z</published>
    <updated>2022-10-17T03:30:46.830Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¾¤æ™–Momentså‘é€æœªçŸ¥é”™è¯¯ï¼Œè¯·å†è¯•ä¸€æ¬¡"><a href="#ç¾¤æ™–Momentså‘é€æœªçŸ¥é”™è¯¯ï¼Œè¯·å†è¯•ä¸€æ¬¡" class="headerlink" title="ç¾¤æ™–Momentså‘é€æœªçŸ¥é”™è¯¯ï¼Œè¯·å†è¯•ä¸€æ¬¡"></a>ç¾¤æ™–Momentså‘é€æœªçŸ¥é”™è¯¯ï¼Œè¯·å†è¯•ä¸€æ¬¡</h1><p>æŒ‰ä¸‹é¢å›¾çš„æ­¥éª¤æ¥å°±å¥½äº†ï¼Œå…ˆåˆ ä¸‰ä¸ªå¥—ä»¶ï¼Œé‡å¯ï¼Œå®‰è£…momentsï¼Œæœ€åæ¢å¤ç´¢å¼•ï¼Œå°±å¥½äº†ã€‚ä¸‹é¢çš„å›¾å°±ä¸è§£é‡Šäº†</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvsfj1awqj30hb0910sv.jpg" alt="image-20201020143501721"></p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvsg8dc4nj30lc0eoq57.jpg" alt="image-20201020143549313"></p><p>æ—¶é—´æ¯”è¾ƒé•¿ï¼Œç­‰ç­‰</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvskxusuhj30oi0fwju3.jpg" alt="image-20201020144021076"></p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvsmi01q4j30k90g7acq.jpg" alt="image-20201020144150773"></p><p>æˆ‘è¿™ä¸ªç¾¤è¾‰ åº”ç”¨ç¨‹åºæœåŠ¡çš„å›¾æ ‡æ˜¯é”™çš„ï¼Œä¸çŸ¥é“ä¸ºå•¥</p><p>æœ€åä¸€æ­¥ é‡å¯NAS</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvsnl2j26j30gx09w42m.jpg" alt="image-20201020144253666"></p><p>æœ€æœ€å é‡å¯ï¼Œå®‰è£…momentï¼Œå®ƒä¼šè‡ªåŠ¨ä¸‹è½½ç¾¤è¾‰åº”ç”¨ç¨‹åºå’Œdriveã€‚Node.jsæˆ‘æœ¬æœºæ˜¯å®‰è£…çš„ï¼Œæ‰€ä»¥ä¸ç”¨é‡æ–°ä¸‹äº†</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvsse9kjvj30e308g0t8.jpg" alt="image-20201020144731049"></p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvstr8f0aj30kh0duq5p.jpg" alt="image-20201020144848581"></p><p>å› ä¸ºé‡è£…äº†driveï¼Œå®ƒä¼šå»ç´¢å¼•æ–‡ä»¶å¤¹</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvsy80htwj30e607pjta.jpg" alt="image-20201020145306329"></p><p>æ‰“å¼€momentï¼Œå¥½äº†</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvtpfzcj8j31f00npgp4.jpg" alt="image-20201020151858761"></p><p>æ¥ç€ æˆ‘ä»¬è¦ç‚¹å¼€å·¦ä¸‹è§’çš„è®¾ç½®ï¼Œè¦é‡å»ºç´¢å¼•</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvtr12oefj30mu0hgjta.jpg" alt="image-20201020152040110"></p><p>çœ‹åˆ°å›¾ç‰‡ æ…¢æ…¢æœ‰äº†</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvttn2c82j31e50mvt9x.jpg" alt="image-20201020152316292"></p>]]></content>
    
    <summary type="html">
    
      æˆ‘çš„ç¾¤æ™–å†…ç½®çš„å­˜å‚¨ç©ºé—´1åäº†ï¼Œæ–°æ¢äº†å—å›ºæ€ï¼Œå¯åŠ¨Momentsé‡åˆ°è¿™ä¸ªé—®é¢˜
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="ç¾¤æ™–" scheme="https://kitions.github.io/tags/%E7%BE%A4%E6%99%96/"/>
    
  </entry>
  
  <entry>
    <title>H5å”¤é†’APP ç®€å•hackeræ–¹æ³•</title>
    <link href="https://kitions.github.io/2020/10/15/H5%E5%94%A4%E9%86%92APP%20%E7%AE%80%E5%8D%95hacker%E6%96%B9%E6%B3%95/"/>
    <id>https://kitions.github.io/2020/10/15/H5å”¤é†’APP ç®€å•hackeræ–¹æ³•/</id>
    <published>2020-10-15T03:58:39.000Z</published>
    <updated>2022-10-17T03:30:46.827Z</updated>
    
    <content type="html"><![CDATA[<h2 id="H5å”¤é†’APP-ç®€å•hackeræ–¹æ³•"><a href="#H5å”¤é†’APP-ç®€å•hackeræ–¹æ³•" class="headerlink" title="H5å”¤é†’APP ç®€å•hackeræ–¹æ³•"></a>H5å”¤é†’APP ç®€å•hackeræ–¹æ³•</h2><p>æœ¬è´¨ä¸Šæµè§ˆå™¨æ˜¯é€šè¿‡URLschemeæ‰“å¼€APPï¼Œä¸€ä¸ªAPPå¯ä»¥è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªæ‰“å¼€è‡ªå·±çš„URL schemeã€‚ç±»ä¼¼äºzhihu://</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> APPRouter = <span class="function">(<span class="params">router: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isWeiXin()) &#123;</span><br><span class="line">        <span class="comment">// alert("è¯·ç‚¹å‡»å³ä¸Šè§’æ‰“å¼€å…¶ä»–æµè§ˆå™¨")</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">window</span>.location.href = router</span><br><span class="line">      </span><br><span class="line">        <span class="keyword">if</span>(isAndroid())&#123;</span><br><span class="line">          <span class="comment">// å®‰å“ </span></span><br><span class="line">            <span class="keyword">var</span> t = <span class="built_in">Date</span>.now()</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">Date</span>.now() - t &lt; <span class="number">1200</span>) &#123;</span><br><span class="line">                    <span class="built_in">window</span>.location.href = <span class="string">`ä½ appä¸‹è½½åŸŸå`</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="comment">// è‹¹æœ</span></span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">window</span>.location.href = <span class="string">`ä½ appä¸‹è½½åŸŸå`</span></span><br><span class="line">            &#125;, <span class="number">250</span>)</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">window</span>.location.reload()</span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®‰å“è®¾ç½®çš„åŸç†ï¼š"><a href="#å®‰å“è®¾ç½®çš„åŸç†ï¼š" class="headerlink" title="å®‰å“è®¾ç½®çš„åŸç†ï¼š"></a>å®‰å“è®¾ç½®çš„åŸç†ï¼š</h3><p>å¦‚æœè®¾ç½®æ¯”è¾ƒå°çš„è¿è¡Œé—´éš”ï¼ˆ&lt;30msï¼‰ï¼Œåœ¨æµè§ˆå™¨æˆ–è€…webviewä¸­ï¼Œåº”ç”¨åˆ‡æ¢åˆ°åå°ï¼ŒsetIntervalä¼šè¢«å¾ˆæ˜æ˜¾çš„å»¶è¿Ÿæ‰§è¡Œï¼Œæ¯”å¦‚è®¾ç½®ä¸€ä¸ªè¿è¡Œé—´éš”20msï¼Œæ€»è®¡è¿è¡Œ100æ¬¡çš„å®šæ—¶å™¨ï¼Œå¦‚æœé¡µé¢ä¸€ç›´å¤„äºå‰å°ï¼Œåˆ™100æ¬¡è·‘å®Œï¼Œæ€»è€—æ—¶ä¸100x20=2000msä¸ä¼šæœ‰å¤ªå¤§å·®å¼‚ï¼Œä½†é¡µé¢åœ¨åå°è¿è¡Œæ—¶ï¼Œæ­¤æ—¶é—´ä¼šæ˜æ˜¾è¶…è¿‡2000msã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥å®ç°æ˜¯å¦æˆåŠŸæ‰“å¼€APPæ£€æµ‹åŠå›è°ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t = <span class="built_in">Date</span>.now()</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">Date</span>.now() - t &lt; <span class="number">1200</span>) &#123;</span><br><span class="line">                    <span class="built_in">window</span>.location.href = <span class="string">`ä½ appä¸‹è½½åŸŸå`</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure><h3 id="è‹¹æœè®¾ç½®çš„åŸç†ï¼š"><a href="#è‹¹æœè®¾ç½®çš„åŸç†ï¼š" class="headerlink" title="è‹¹æœè®¾ç½®çš„åŸç†ï¼š"></a>è‹¹æœè®¾ç½®çš„åŸç†ï¼š</h3><p>APPå·²å®‰è£…è¿™æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†å¦‚æœAPPæœªå®‰è£…ï¼Œè·³App Store çš„è¯·æ±‚ä¼šå¤±è´¥ã€‚ è¿™æ—¶å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå®šæ—¶å™¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                   <span class="built_in">window</span>.location.href = <span class="string">`ä½ appä¸‹è½½åŸŸå`</span></span><br><span class="line">           &#125;, <span class="number">250</span>)</span><br><span class="line">           setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                   <span class="built_in">window</span>.location.reload()</span><br><span class="line">           &#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure><h3 id="Iframe"><a href="#Iframe" class="headerlink" title="Iframe"></a>Iframe</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ifm = <span class="built_in">document</span>.createElement(<span class="string">'iframe'</span>);</span><br><span class="line"></span><br><span class="line">      ifm.setAttribute(<span class="string">'src'</span>, wakeupUrl);</span><br><span class="line">      ifm.setAttribute(<span class="string">'style'</span>, <span class="string">'display:none'</span>);</span><br><span class="line">      <span class="built_in">document</span>.body.appendChild(ifm);</span><br><span class="line">      onBeforeWakeup &amp;&amp; onBeforeWakeup();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> currentTime = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">var</span> nowTime = <span class="built_in">Date</span>.now();</span><br><span class="line">          <span class="keyword">if</span> (nowTime - currentTime &lt; <span class="number">1050</span>) &#123;</span><br><span class="line">            <span class="comment">// å›è°ƒ</span></span><br><span class="line">              onWakeupFail &amp;&amp; onWakeupFail();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure><h3 id="å¼•å¯¼é¡µ"><a href="#å¼•å¯¼é¡µ" class="headerlink" title="å¼•å¯¼é¡µ"></a>å¼•å¯¼é¡µ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> H5ToApp = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(div);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div class="h5_toweixin" style="z-index: 9999;position: absolute;width: 100%;top: 0px;left: 0;height: 100%;"&gt;</span></span><br><span class="line"><span class="string">        &lt;img src="/images/h5-weixin.png" alt="å¼•å¯¼åˆ°å¾®ä¿¡"/&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;`</span></span><br><span class="line">    <span class="keyword">const</span> bodyScroll = <span class="function">(<span class="params">event: any</span>) =&gt;</span> &#123;</span><br><span class="line">        event.stopPropagation();</span><br><span class="line">        event.preventDefault();</span><br><span class="line">    &#125;</span><br><span class="line">    div.appendChild(parseElement(template))</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'touchmove'</span>, bodyScroll);</span><br><span class="line">    <span class="built_in">document</span>.body.style.position = <span class="string">'fixed'</span>;</span><br><span class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">"click"</span>, fn)</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (div.parentNode) &#123;</span><br><span class="line">            <span class="built_in">document</span>.body.style.position = <span class="string">'static'</span>;</span><br><span class="line">            <span class="built_in">window</span>.removeEventListener(<span class="string">'touchmove'</span>, bodyScroll);</span><br><span class="line">            <span class="built_in">document</span>.removeEventListener(<span class="string">'click'</span>,fn);</span><br><span class="line">            div.parentNode.removeChild(div);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> parseElement = <span class="function">(<span class="params">htmlString: string</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DOMParser().parseFromString(htmlString, <span class="string">'text/html'</span>).body.childNodes[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;H5ToApp&#125;</span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å‘å¾ˆå¤šï¼Œé—®é¢˜ä¸»è¦åœ¨å®‰å“ä¸Šï¼Œä¼šæœ‰å„ç§å…¼å®¹é—®é¢˜ï¼Œæœºå‹æµè§ˆå™¨ä¼—å¤šã€‚å½“ç„¶iosä¹Ÿæœ‰ã€‚</p><p>çŸ¥ä¹çš„è§£å†³åŠæ³•æ˜¯ï¼Œæä¾›ä¸¤ä¸ªæŒ‰é’®ï¼Œä¸€ä¸ªä¸‹è½½ï¼Œä¸€ä¸ªæ‰“å¼€APPï¼Œè®©ç”¨æˆ·è‡ªå·±é€‰ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p>é“¾æ¥ï¼š<a href="https://www.jianshu.com/p/7645ad94840d" target="_blank" rel="noopener">https://www.jianshu.com/p/7645ad94840d</a></p>]]></content>
    
    <summary type="html">
    
      H5å”¤é†’APP,æœ¬è´¨ä¸Šæµè§ˆå™¨æ˜¯é€šè¿‡URLschemeæ‰“å¼€APPï¼Œå®‰å“å’Œè‹¹æœçš„ä¸¤ä¸ªæ¯”è¾ƒhackçš„æ–¹æ³•å®ç°äº†è·³è½¬åæœ¬é¡µé¢ä¸è·³è½¬åˆ°ä¸‹è½½é¡µ
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="H5" scheme="https://kitions.github.io/tags/H5/"/>
    
  </entry>
  
  <entry>
    <title>å‡½æ•°çš„æŸ¯é‡ŒåŒ–ç®€å•äº†è§£</title>
    <link href="https://kitions.github.io/2020/08/25/%E5%87%BD%E6%95%B0%E7%9A%84%E6%9F%AF%E9%87%8C%E5%8C%96/"/>
    <id>https://kitions.github.io/2020/08/25/å‡½æ•°çš„æŸ¯é‡ŒåŒ–/</id>
    <published>2020-08-25T11:41:44.000Z</published>
    <updated>2022-10-17T03:30:46.829Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‡½æ•°çš„æŸ¯é‡ŒåŒ–"><a href="#å‡½æ•°çš„æŸ¯é‡ŒåŒ–" class="headerlink" title="å‡½æ•°çš„æŸ¯é‡ŒåŒ–"></a>å‡½æ•°çš„æŸ¯é‡ŒåŒ–</h1><h2 id="ä¸€ã€æ¦‚å¿µ"><a href="#ä¸€ã€æ¦‚å¿µ" class="headerlink" title="ä¸€ã€æ¦‚å¿µ"></a>ä¸€ã€æ¦‚å¿µ</h2><p>æ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢æˆæ¥å—å•ä¸€å‚æ•°çš„å‡½æ•°çš„æ“ä½œã€‚é€šä¿—ç†è§£ä¸ºï¼šåªä¼ é€’ç»™å‡½æ•°çš„ä¸€éƒ¨åˆ†å‚æ•°æ¥è°ƒç”¨å®ƒï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªæ–°å‡½æ•°å»å¤„ç†å‰©ä¸‹çš„å‚æ•°ã€‚</p><blockquote><p>æµ‹è¯•å¯ç”¨quokka.jsï¼ˆå…è´¹ç‰ˆå³å¯ï¼‰  vscodeçš„æ’ä»¶</p></blockquote><h2 id="äºŒã€å‚æ•°å®šé•¿æŸ¯é‡ŒåŒ–"><a href="#äºŒã€å‚æ•°å®šé•¿æŸ¯é‡ŒåŒ–" class="headerlink" title="äºŒã€å‚æ•°å®šé•¿æŸ¯é‡ŒåŒ–"></a>äºŒã€å‚æ•°å®šé•¿æŸ¯é‡ŒåŒ–</h2><h3 id="2-1-ä¾‹ä¸€"><a href="#2-1-ä¾‹ä¸€" class="headerlink" title="2.1 ä¾‹ä¸€"></a>2.1 ä¾‹ä¸€</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">...args</span>) =&gt;</span> args.reduce(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b);</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sum = currying(add);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> addCurryOne = sum(<span class="number">1</span>);</span><br><span class="line">addCurryOne(<span class="number">2</span>) <span class="comment">// 3</span></span><br><span class="line">addCurryOne(<span class="number">3</span>) <span class="comment">// 4</span></span><br></pre></td></tr></table></figure><p>ç”¨é—­åŒ…æŠŠä¼ å…¥å‚æ•°ä¿å­˜èµ·æ¥ï¼Œå½“ä¼ å…¥å‚æ•°çš„æ•°é‡è¶³å¤Ÿæ‰§è¡Œå‡½æ•°æ—¶ï¼Œå°±å¼€å§‹æ‰§è¡Œå‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">currying</span>(<span class="params">func</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> args = [];</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">result</span>(<span class="params">...rest</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rest.length === <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> func(...args);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          args.push(...rest);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gi35mxxb8cj30eo0ga0tz.jpg" alt="image-20200825165013800"></p><h3 id="2-2-ä¾‹äºŒ"><a href="#2-2-ä¾‹äºŒ" class="headerlink" title="2.2 ä¾‹äºŒ"></a>2.2 ä¾‹äºŒ</h3><p>æŸ¯é‡ŒåŒ–æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°çš„åŸºç¡€ä¸Šå˜æ¢ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„é¢„è®¾äº†å‚æ•°çš„å‡½æ•°ã€‚æœ€ååœ¨è°ƒç”¨æ–°å‡½æ•°æ—¶å€™ï¼Œå®é™…ä¸Šè¿˜æ˜¯ä¼šè°ƒç”¨æŸ¯é‡ŒåŒ–å‰çš„åŸå‡½æ•°ã€‚</p><p>è€Œä¸”æŸ¯é‡ŒåŒ–å¾—åˆ°çš„æ–°å‡½æ•°å¯ä»¥ç»§ç»­è¢«æŸ¯é‡ŒåŒ–ï¼Œæœ‰ç‚¹é€’å½’çš„æ„Ÿè§‰ï¼Œä¸å¯¹ä¸æ˜¯é€’å½’ï¼Œæœ‰ç‚¹å¥—å¨ƒçš„æ„Ÿè§‰</p><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gi49mnwbg6j30tk0fp42s.jpg" alt="image-20200826155358746"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">adds</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">currying</span>(<span class="params">fn, length</span>) </span>&#123;</span><br><span class="line">    length = length || fn.length; <span class="comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨è·å–å‡½æ•° fn å‚æ•°çš„é•¿åº¦ï¼Œåç»­è°ƒç”¨è·å– fn å‰©ä½™å‚æ•°çš„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">arguments</span> <span class="comment">//å°†ç±»æ•°ç»„å¯¹è±¡è½¬æ¢æˆæ•°ç»„</span></span><br><span class="line">        <span class="keyword">var</span> args = [].slice.call(<span class="built_in">arguments</span>) <span class="comment">// curryingè¿”å›å‡½æ•°æ¥å—çš„å‚æ•°</span></span><br><span class="line">        fn</span><br><span class="line">        args</span><br><span class="line">        <span class="built_in">console</span>.log(args.length)</span><br><span class="line">        length</span><br><span class="line">        <span class="keyword">if</span> (args.length &lt; length) &#123; <span class="comment">// åˆ¤æ–­å‚æ•°çš„é•¿åº¦æ˜¯å¦å°äº fn å‰©ä½™å‚æ•°éœ€è¦æ¥æ”¶çš„é•¿åº¦</span></span><br><span class="line">            <span class="keyword">return</span> currying(fn.bind(<span class="keyword">this</span>, ...args), length - args.length) <span class="comment">// é€’å½’ currying å‡½æ•°ï¼Œæ–°çš„ fn ä¸º bind è¿”å›çš„æ–°å‡½æ•°ï¼ˆbind ç»‘å®šäº† ...args å‚æ•°ï¼Œæœªæ‰§è¡Œï¼‰ï¼Œæ–°çš„ length ä¸º fn å‰©ä½™å‚æ•°çš„é•¿åº¦</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(fn)</span><br><span class="line">            <span class="built_in">console</span>.log(...args)</span><br><span class="line">            <span class="keyword">return</span> fn.call(<span class="keyword">this</span>, ...args) <span class="comment">// æ‰§è¡Œ fn å‡½æ•°ï¼Œä¼ å…¥æ–°å‡½æ•°çš„å‚æ•°</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> addCurry = currying(adds);</span><br><span class="line"><span class="built_in">console</span>.log(addCurry(<span class="number">2</span>)(<span class="number">3</span>)(<span class="number">4</span>)) <span class="comment">// 9</span></span><br><span class="line"><span class="comment">// console.log(addCurry(2, 3)(4))  // 9</span></span><br><span class="line"><span class="comment">// console.log(addCurry(2, 3, 4))  // 9</span></span><br><span class="line"><span class="comment">// addCurry(2)(3, 4) // 9</span></span><br></pre></td></tr></table></figure><p>å®ç°åŸç†éƒ½æ˜¯ã€Œç”¨é—­åŒ…æŠŠä¼ å…¥å‚æ•°ä¿å­˜èµ·æ¥ï¼Œå½“ä¼ å…¥å‚æ•°çš„æ•°é‡è¶³å¤Ÿæ‰§è¡Œå‡½æ•°æ—¶ï¼Œå°±å¼€å§‹æ‰§è¡Œå‡½æ•°ã€</p><h2 id="ä¸‰ã€å®é™…ä½¿ç”¨"><a href="#ä¸‰ã€å®é™…ä½¿ç”¨" class="headerlink" title="ä¸‰ã€å®é™…ä½¿ç”¨"></a>ä¸‰ã€å®é™…ä½¿ç”¨</h2><h3 id="1-bind"><a href="#1-bind" class="headerlink" title="1.bind"></a>1.bind</h3><p>MDNçš„è§£é‡Š</p><blockquote><p><code>Function.prototype.bind()</code>æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œåœ¨<code>bind()</code>è¢«è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„<code>this</code>è¢«æŒ‡å®šä¸º<code>bind</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œå…¶ä½™å‚æ•°ä¼šè¢«æŒ‡å®šä¸ºæ–°å‡½æ•°çš„å‚æ•°ï¼Œä¾›è°ƒç”¨æ—¶ä½¿ç”¨</p></blockquote><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gi5i8qlgwqj30eg0eltb4.jpg" alt="image-20200827173736428"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“!"></a>æ€»ç»“!</h2><p>æŸ¯é‡ŒåŒ–å±äºå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ã€‚æŸ¯é‡ŒåŒ–æ—¶åªæ˜¯è¿”å›ä¸€ä¸ªé¢„ç½®å‚æ•°çš„æ–°å‡½æ•°ï¼Œæ²¡æœ‰ç«‹åˆ»æ‰§è¡Œï¼Œå®é™…ä¸Šåœ¨æ»¡è¶³æ¡ä»¶åæ‰ä¼šæ‰§è¡Œã€‚ä¸æ±¡æŸ“åŸå‡½æ•°ã€‚</p>]]></content>
    
    <summary type="html">
    
      æ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢æˆæ¥å—å•ä¸€å‚æ•°çš„å‡½æ•°çš„æ“ä½œã€‚é€šä¿—ç†è§£ä¸ºï¼šåªä¼ é€’ç»™å‡½æ•°çš„ä¸€éƒ¨åˆ†å‚æ•°æ¥è°ƒç”¨å®ƒï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªæ–°å‡½æ•°å»å¤„ç†å‰©ä¸‹çš„å‚æ•°ã€‚
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="javascript" scheme="https://kitions.github.io/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>æµè§ˆå™¨äº‹ä»¶å…¨å±</title>
    <link href="https://kitions.github.io/2020/07/31/%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BA%8B%E4%BB%B6%E5%85%A8%E5%B1%8F/"/>
    <id>https://kitions.github.io/2020/07/31/æµè§ˆå™¨äº‹ä»¶å…¨å±/</id>
    <published>2020-07-31T03:55:08.000Z</published>
    <updated>2022-10-17T03:30:46.830Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æµè§ˆå™¨äº‹ä»¶å…¨å±"><a href="#æµè§ˆå™¨äº‹ä»¶å…¨å±" class="headerlink" title="æµè§ˆå™¨äº‹ä»¶å…¨å±"></a>æµè§ˆå™¨äº‹ä»¶å…¨å±</h1><h2 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…¨å±</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> fullScreen = <span class="function">(<span class="params">element: any</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> requestMethod = element.requestFullScreen || element.webkitRequestFullScreen || element.mozRequestFullScreen || element.msRequestFullScreen || element.msRequestFullscreen || element.requestFullscreen;</span><br><span class="line">    <span class="keyword">if</span> (requestMethod) &#123;</span><br><span class="line">        requestMethod.call(element);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> (<span class="built_in">window</span> <span class="keyword">as</span> any).ActiveXObject != <span class="string">"undefined"</span>) &#123;</span><br><span class="line">        <span class="comment">//for IEï¼Œè¿™é‡Œå…¶å®å°±æ˜¯æ¨¡æ‹Ÿäº†æŒ‰ä¸‹é”®ç›˜çš„F11ï¼Œä½¿æµè§ˆå™¨å…¨å±</span></span><br><span class="line">        <span class="keyword">var</span> wscript = <span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</span><br><span class="line">        <span class="keyword">if</span> (wscript != <span class="literal">null</span>) &#123;</span><br><span class="line">            wscript.SendKeys(<span class="string">"&#123;F11&#125;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é€€å‡ºå…¨å±</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> exitFullScreen = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> el: any = <span class="built_in">document</span>;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å„ç§æµè§ˆå™¨ï¼Œæ‰¾åˆ°æ­£ç¡®çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">var</span> exitMethod = el.exitFullscreen || <span class="comment">//W3C</span></span><br><span class="line">        el.mozCancelFullScreen || <span class="comment">//FireFox</span></span><br><span class="line">        el.webkitExitFullscreen || <span class="comment">//Chromeç­‰</span></span><br><span class="line">        el.webkitExitFullscreen; <span class="comment">//IE11</span></span><br><span class="line">    <span class="keyword">if</span> (exitMethod) &#123;</span><br><span class="line">        exitMethod.call(<span class="built_in">document</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> (<span class="built_in">window</span> <span class="keyword">as</span> any).ActiveXObject !== <span class="string">"undefined"</span>) &#123; <span class="comment">//for Internet Explorer</span></span><br><span class="line">        <span class="keyword">var</span> wscript = <span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</span><br><span class="line">        <span class="keyword">if</span> (wscript !== <span class="literal">null</span>) &#123;</span><br><span class="line">            wscript.SendKeys(<span class="string">"&#123;F11&#125;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç›‘å¬äº‹ä»¶"><a href="#ç›‘å¬äº‹ä»¶" class="headerlink" title="ç›‘å¬äº‹ä»¶"></a>ç›‘å¬äº‹ä»¶</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fullChage = <span class="function">(<span class="params">e: any</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> el: any = <span class="built_in">document</span></span><br><span class="line">        <span class="comment">// if isFullScreen</span></span><br><span class="line">        <span class="keyword">if</span> (el.isFullScreen || el.mozFullScreen || el.webkitIsFullScreen) &#123;</span><br><span class="line">            <span class="comment">// do someting</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"å…¨å±å¤±è´¥"</span>, error)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"fullscreenchange"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    fullChage(e)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"mozfullscreenchange"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    fullChage(e)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"webkitfullscreenchange"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    fullChage(e)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"msfullscreenchange"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    fullChage(e)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      æµè§ˆå™¨çš„å…¨å±ï¼Œé€€å‡ºå…¨å±ï¼Œç›‘å¬å…¨å±
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="å…¨å±" scheme="https://kitions.github.io/tags/%E5%85%A8%E5%B1%8F/"/>
    
  </entry>
  
  <entry>
    <title>styled-componentsæµ…å…¥æµ…å‡º</title>
    <link href="https://kitions.github.io/2020/07/25/styled-components/"/>
    <id>https://kitions.github.io/2020/07/25/styled-components/</id>
    <published>2020-07-25T10:45:22.000Z</published>
    <updated>2022-10-17T03:30:46.829Z</updated>
    
    <content type="html"><![CDATA[<h1 id="styled-components"><a href="#styled-components" class="headerlink" title="styled-components"></a>styled-components</h1><p>styled-componentsä»¥ç»„ä»¶çš„å½¢å¼æ¥å£°æ˜æ ·å¼ï¼Œè®©æ ·å¼ä¹Ÿæˆä¸ºç»„ä»¶ï¼Œä»è€Œåˆ†ç¦»é€»è¾‘ç»„ä»¶ä¸å±•ç¤ºç»„ä»¶ã€‚</p><h2 id="éƒ¨åˆ†å®è·µ"><a href="#éƒ¨åˆ†å®è·µ" class="headerlink" title="éƒ¨åˆ†å®è·µ"></a>éƒ¨åˆ†å®è·µ</h2><h3 id="1-å¼•å…¥å…¨éƒ¨æ ·å¼"><a href="#1-å¼•å…¥å…¨éƒ¨æ ·å¼" class="headerlink" title="1.  å¼•å…¥å…¨éƒ¨æ ·å¼"></a>1.  å¼•å…¥å…¨éƒ¨æ ·å¼</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createGlobalStyle&#125; <span class="keyword">from</span> <span class="string">'styled-components'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Global = createGlobalStyle<span class="string">`</span></span><br><span class="line"><span class="string">  body&#123;</span></span><br><span class="line"><span class="string">    background-color:red!important;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"> h1, h2, h3 &#123;</span></span><br><span class="line"><span class="string">    font-family: '<span class="subst">$&#123;props =&gt; props.theme.fontFamily.common&#125;</span>';</span></span><br><span class="line"><span class="string">    font-weight: normal;</span></span><br><span class="line"><span class="string">    font-style: normal;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line">&lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">  &lt;Global&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Global</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-input-attr"><a href="#2-input-attr" class="headerlink" title="2.  input attr"></a>2.  input attr</h3><p>ä¸ºStyled-Componentæ·»åŠ é»˜è®¤å±æ€§å’Œé»˜è®¤æ ·å¼å€¼</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Input = styled.input.attrs(<span class="function"><span class="params">props</span> =&gt;</span> (&#123;</span><br><span class="line">  <span class="comment">// we can define static props</span></span><br><span class="line">  type: <span class="string">"password"</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// or we can define dynamic ones</span></span><br><span class="line">  size: props.size || <span class="string">"1em"</span>,</span><br><span class="line">&#125;))<span class="string">`</span></span><br><span class="line"><span class="string">  color: red;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;Input /&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure><h3 id="3-ä¸»é¢˜"><a href="#3-ä¸»é¢˜" class="headerlink" title="3. ä¸»é¢˜"></a>3. ä¸»é¢˜</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> theme = &#123;</span><br><span class="line">fontSizes: &#123;</span><br><span class="line">sm: <span class="string">'10px'</span>,</span><br><span class="line">md: <span class="string">'15px'</span>,</span><br><span class="line">lg: <span class="string">'25px'</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BodyTexts = styled.p<span class="string">`</span></span><br><span class="line"><span class="string">font-size: <span class="subst">$&#123;props =&gt; props.theme.fontSizes.sm&#125;</span></span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;ThemeProvider theme=&#123;theme&#125;&gt;</span><br><span class="line">      &lt;BodyTexts&gt;Themed&lt;<span class="regexp">/BodyTexts&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>ThemeProvider&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure><h3 id="4-ç»§æ‰¿"><a href="#4-ç»§æ‰¿" class="headerlink" title="4. ç»§æ‰¿"></a>4. ç»§æ‰¿</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> StyledCompoent2 = styled(StyledCompoent1)<span class="string">`</span></span><br><span class="line"><span class="string">    background:xxx</span></span><br><span class="line"><span class="string">    ...</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure><p>StyledComponent2å…¶å®æ˜¯ä¸€ä¸ªå…¨æ–°çš„class</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦åšåˆ°<strong>çœŸæ­£çš„ç»§æ‰¿</strong>ï¼Œéœ€è¦ä½¿ç”¨style-componentsæä¾›çš„<code>extend</code>æ–¹æ³•ï¼Œå®ƒæ˜¯StyleComponentä¸‹çš„ä¸€ä¸ªå±æ€§æ–¹æ³•ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> StyledCompoent2 = StyledCompoent1.extend<span class="string">`</span></span><br><span class="line"><span class="string">    background:xxx</span></span><br><span class="line"><span class="string">    ...</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure><h3 id="5-withComponent"><a href="#5-withComponent" class="headerlink" title="5. withComponent"></a>5. withComponent</h3><p>åˆ›å»ºæ–°StyledComponentçš„æ–¹æ³•ï¼Œè¯¥æ–°StyledComponentä¼šåº”ç”¨ä¸åŒçš„æ ‡ç­¾æˆ–ç»„ä»¶ï¼Œä½†æ‰€è°ƒç”¨çš„è§„åˆ™ç›¸åŒã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Component = styled.div<span class="string">`</span></span><br><span class="line"><span class="string">  color: red;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">  &lt;Component</span><br><span class="line">    <span class="keyword">as</span>=<span class="string">"button"</span></span><br><span class="line">    onClick=&#123;() =&gt; alert(<span class="string">'It works!'</span>)&#125;</span><br><span class="line">  &gt;</span><br><span class="line">    Hello World!</span><br><span class="line">  &lt;<span class="regexp">/Component&gt;</span></span><br><span class="line"><span class="regexp">)</span></span><br></pre></td></tr></table></figure><h3 id="6-Refs"><a href="#6-Refs" class="headerlink" title="6. Refs"></a>6. Refs</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Input = styled.input<span class="string">`</span></span><br><span class="line"><span class="string">  padding: 0.5em;</span></span><br><span class="line"><span class="string">  margin: 0.5em;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Form</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.inputRef = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;Input</span><br><span class="line">        ref=&#123;<span class="keyword">this</span>.inputRef&#125;</span><br><span class="line">        placeholder=<span class="string">"Hover to focus!"</span></span><br><span class="line">        onMouseEnter=&#123;() =&gt; &#123;</span><br><span class="line">          <span class="keyword">this</span>.inputRef.current.focus()</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">render(</span><br><span class="line">  &lt;Form /&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="7-è·å–Theme"><a href="#7-è·å–Theme" class="headerlink" title="7. è·å–Theme"></a>7. è·å–Theme</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; withTheme &#125; <span class="keyword">from</span> <span class="string">'styled-components'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Current theme: '</span>, <span class="keyword">this</span>.props.theme);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withTheme(MyComponent)</span><br></pre></td></tr></table></figure><h2 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h2><h3 id="Stylelint"><a href="#Stylelint" class="headerlink" title="Stylelint"></a>Stylelint</h3> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(npm install --save-dev \</span><br><span class="line">  stylelint \</span><br><span class="line">  stylelint-processor-styled-components \</span><br><span class="line">  stylelint-config-styled-components \</span><br><span class="line">  stylelint-config-recommended)</span><br></pre></td></tr></table></figure><h3 id="Styled-Theming"><a href="#Styled-Theming" class="headerlink" title="Styled Theming"></a><a href="https://styled-components.com/docs/tooling#styled-theming" target="_blank" rel="noopener">Styled Theming</a></h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> styled, &#123; ThemeProvider &#125; <span class="keyword">from</span> <span class="string">'styled-components'</span></span><br><span class="line"><span class="keyword">import</span> theme <span class="keyword">from</span> <span class="string">'styled-theming'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> boxBackgroundColor = theme(<span class="string">'mode'</span>, &#123;</span><br><span class="line">  light: <span class="string">'#fff'</span>,</span><br><span class="line">  dark: <span class="string">'#000'</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Box = styled.div<span class="string">`</span></span><br><span class="line"><span class="string">  background-color: <span class="subst">$&#123;boxBackgroundColor&#125;</span>;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;ThemeProvider theme=&#123;&#123; <span class="attr">mode</span>: <span class="string">'light'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;Box&gt;Hello World&lt;<span class="regexp">/Box&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>ThemeProvider&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="vscode-styled-components"><a href="#vscode-styled-components" class="headerlink" title="vscode-styled-components"></a><strong>vscode-styled-components</strong></h3><h3 id="typescript-plugin-styled-components"><a href="#typescript-plugin-styled-components" class="headerlink" title="typescript-plugin-styled-components"></a><a href="https://github.com/Igorbek/typescript-plugin-styled-components" target="_blank" rel="noopener">typescript-plugin-styled-components</a></h3><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h3><ol><li>æ´»è·ƒçš„<a href="https://github.com/styled-components/styled-components/graphs/contributors" target="_blank" rel="noopener">ç¤¾åŒº</a>ã€‚</li><li><strong>CSSçš„æ¨¡æ¿æ–‡å­—è¯­æ³•</strong>ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæ‚¨å¯ä»¥ç¼–å†™æ™®é€šçš„CSSï¼Œå°±å¯ä»¥ä¸ºç»„ä»¶è®¾ç½®æ ·å¼ï¼Œè€Œä¸å¿…å­¦ä¹ æ–°çš„è¯­æ³•ã€‚</li><li>Sassæ”¯æŒã€‚</li><li>è‡ªåŠ¨æä¾›å‰ç¼€</li><li>ç»„ä»¶æ›´åŠ ç‹¬ç«‹æ¸…æ™°ï¼Œè¯­ä¹‰åŒ–æ›´æ¸…æ™°ï¼Œç»´æŠ¤ç®€å•ï¼Œç¬¬äºŒä¸ªäººæ¥æ‰‹å¾ˆå¿«ï¼Œä¹Ÿä¸ç”¨é¡¾å¿Œä¹‹å‰çš„æ ·å¼å†²çªã€‚</li><li>å‡è½»äº†å¤§å®¶ç±»åå‘½åçš„è´Ÿæ‹…ã€‚</li><li>å¯å®ç°ä»…åŠ è½½æ‰€éœ€çš„æœ€å°‘ä»£ç ã€‚</li><li>å…¼å®¹æ€§è‰¯å¥½ v4.xï¼ˆReact v16.3 +ï¼šIE11ï¼ŒIE 9+ï¼ˆå¸¦æœ‰Map + Set polyfillsï¼‰</li></ol><h3 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h3><ol><li>ä½¿ç”¨<strong>vscode-styled-components</strong> æœ‰æç¤ºï¼Œä½†æç¤ºé€Ÿåº¦è¾ƒæ…¢ï¼Œæ²¡æœ‰scssã€cssæç¤ºå‹å¥½ï¼Œæ¯”å¦‚margin-leftï¼Œæˆ‘åœ¨scssä¸­åªéœ€è¦mlå›è½¦å°±è¡Œäº†ï¼Œåœ¨styled-componentsç»„ä»¶ä¸­å°±è¿˜æ˜¯å¾—æ‰“å…¨ã€‚</li><li>äº§å“æ”¹æ ·å¼ï¼Œæƒ³è¦ä»HTMLä¸­å®šä½ç¡®åˆ‡çš„çŸ¥é“ä»£ç ä¸­æŸä¸ª class åœ¨å“ªå„¿ç”¨åˆ°å¾ˆéš¾</li></ol><h3 id="so"><a href="#so" class="headerlink" title="so:"></a>so:</h3><p>ä¼˜ç‚¹&gt;ç¼ºç‚¹ï¼Œgo on ç”¨èµ·æ¥å§ï¼</p>]]></content>
    
    <summary type="html">
    
      styled-componentsä»¥ç»„ä»¶çš„å½¢å¼æ¥å£°æ˜æ ·å¼ï¼Œè®©æ ·å¼ä¹Ÿæˆä¸ºç»„ä»¶ï¼Œä»è€Œåˆ†ç¦»é€»è¾‘ç»„ä»¶ä¸å±•ç¤ºç»„ä»¶ã€‚
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="styled-components" scheme="https://kitions.github.io/tags/styled-components/"/>
    
  </entry>
  
  <entry>
    <title>React + antd-table è¡¨æ ¼æ‹–æ‹½</title>
    <link href="https://kitions.github.io/2020/07/22/React%20+%20antd-table%20%E8%A1%A8%E6%A0%BC%E6%8B%96%E6%8B%BDclass%E7%B1%BB%E5%86%99%E6%B3%95/"/>
    <id>https://kitions.github.io/2020/07/22/React + antd-table è¡¨æ ¼æ‹–æ‹½classç±»å†™æ³•/</id>
    <published>2020-07-22T10:52:24.000Z</published>
    <updated>2022-10-17T03:30:46.827Z</updated>
    
    <content type="html"><![CDATA[<h1 id="React-antd-table-è¡¨æ ¼æ‹–æ‹½classç±»å†™æ³•-Immutability-Helpersä»‹ç»"><a href="#React-antd-table-è¡¨æ ¼æ‹–æ‹½classç±»å†™æ³•-Immutability-Helpersä»‹ç»" class="headerlink" title="React + antd-table è¡¨æ ¼æ‹–æ‹½classç±»å†™æ³•(Immutability Helpersä»‹ç»)"></a>React + antd-table è¡¨æ ¼æ‹–æ‹½classç±»å†™æ³•(Immutability Helpersä»‹ç»)</h1><h2 id="ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šreact-dnt"><a href="#ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šreact-dnt" class="headerlink" title="ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šreact-dnt"></a>ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šreact-dnt</h2><h3 id="ä¸»ç»„ä»¶"><a href="#ä¸»ç»„ä»¶" class="headerlink" title="ä¸»ç»„ä»¶"></a>ä¸»ç»„ä»¶</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; DndProvider &#125; <span class="keyword">from</span> <span class="string">'react-dnd'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; HTML5Backend &#125; <span class="keyword">from</span> <span class="string">'react-dnd-html5-backend'</span>;</span><br><span class="line"><span class="keyword">import</span> update <span class="keyword">from</span> <span class="string">'immutability-helper'</span>;</span><br><span class="line"></span><br><span class="line">moveRow = <span class="function">(<span class="params">dragIndex: number, hoverIndex: number</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">const</span> &#123; dataSource &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">   <span class="keyword">const</span> dragRow = dataSource[dragIndex];</span><br><span class="line">   <span class="keyword">this</span>.setState(</span><br><span class="line">     <span class="comment">// ä¸‹é¢æœ‰å¯¹è¿™ä¸ªå‡½æ•°çš„è¯´æ˜</span></span><br><span class="line">     update(<span class="keyword">this</span>.state, &#123;</span><br><span class="line">       dataSource: &#123;</span><br><span class="line">         $splice: [[dragIndex, <span class="number">1</span>], [hoverIndex, <span class="number">0</span>, dragRow]],</span><br><span class="line">       &#125;,</span><br><span class="line">     &#125;), () =&gt; &#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.dataSource)</span><br><span class="line">     &#125;</span><br><span class="line">   );</span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line">public render() &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; dataSource &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">  &lt;DndProvider backend=&#123;HTML5Backend&#125;&gt;</span><br><span class="line">    &lt;Table</span><br><span class="line">      columns=&#123;<span class="keyword">this</span>.renderColumns()&#125;</span><br><span class="line">      dataSource=&#123;dataSource&#125;</span><br><span class="line">      rowKey=<span class="string">"index"</span></span><br><span class="line">      bordered=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">      pagination=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">      locale=&#123;&#123; <span class="attr">emptyText</span>: <span class="string">"æš‚æœªé€‰æ‹©"</span> &#125;&#125;</span><br><span class="line">      components=&#123;&#123;</span><br><span class="line">        body: &#123;</span><br><span class="line">          row: DragableBodyRow,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      onRow=&#123;(record, index) =&gt; (&#123;</span><br><span class="line">        index,</span><br><span class="line">        moveRow: <span class="keyword">this</span>.moveRow,</span><br><span class="line">      &#125;)&#125;</span><br><span class="line"></span><br><span class="line">      /&gt;</span><br><span class="line">  &lt;<span class="regexp">/DndProvider&gt;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; DragSource, DropTarget &#125; <span class="keyword">from</span> <span class="string">'react-dnd'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dragingIndex = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BodyRow</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span>&lt;<span class="title">any</span>&gt; </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; isOver, connectDragSource, connectDropTarget, moveRow, ...restProps &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">        <span class="keyword">const</span> style = &#123; ...restProps.style, <span class="attr">cursor</span>: <span class="string">'move'</span> &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> className = restProps.className;</span><br><span class="line">        <span class="keyword">if</span> (isOver) &#123;</span><br><span class="line">            <span class="keyword">if</span> (restProps.index &gt; dragingIndex) &#123;</span><br><span class="line">                className += <span class="string">' drop-over-downward'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (restProps.index &lt; dragingIndex) &#123;</span><br><span class="line">                className += <span class="string">' drop-over-upward'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> connectDragSource(</span><br><span class="line">            connectDropTarget(<span class="xml"><span class="tag">&lt;<span class="name">tr</span> &#123;<span class="attr">...restProps</span>&#125; <span class="attr">className</span>=<span class="string">&#123;className&#125;</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span> /&gt;</span>),</span></span><br><span class="line"><span class="xml">        );</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">const rowSource = &#123;</span></span><br><span class="line"><span class="xml">    beginDrag(props: any) &#123;</span></span><br><span class="line"><span class="xml">        dragingIndex = props.index;</span></span><br><span class="line"><span class="xml">        return &#123;</span></span><br><span class="line"><span class="xml">            index: props.index,</span></span><br><span class="line"><span class="xml">        &#125;;</span></span><br><span class="line"><span class="xml">    &#125;,</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">const rowTarget = &#123;</span></span><br><span class="line"><span class="xml">    drop(props: any, monitor: any) &#123;</span></span><br><span class="line"><span class="xml">        const dragIndex = monitor.getItem().index;</span></span><br><span class="line"><span class="xml">        const hoverIndex = props.index;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        // Don't replace items with themselves</span></span><br><span class="line"><span class="xml">        if (dragIndex === hoverIndex) &#123;</span></span><br><span class="line"><span class="xml">            return;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        // Time to actually perform the action</span></span><br><span class="line"><span class="xml">        props.moveRow(dragIndex, hoverIndex);</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">        // Note: we're mutating the monitor item here!</span></span><br><span class="line"><span class="xml">        // Generally it's better to avoid mutations,</span></span><br><span class="line"><span class="xml">        // but it's good here for the sake of performance</span></span><br><span class="line"><span class="xml">        // to avoid expensive index searches.</span></span><br><span class="line"><span class="xml">        monitor.getItem().index = hoverIndex;</span></span><br><span class="line"><span class="xml">    &#125;,</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">export const DragableBodyRow = DropTarget('row', rowTarget, (connect, monitor) =&gt; (&#123;</span></span><br><span class="line"><span class="xml">    connectDropTarget: connect.dropTarget(),</span></span><br><span class="line"><span class="xml">    isOver: monitor.isOver(),</span></span><br><span class="line"><span class="xml">&#125;))(</span></span><br><span class="line"><span class="xml">    DragSource('row', rowSource, connect =&gt; (&#123;</span></span><br><span class="line"><span class="xml">        connectDragSource: connect.dragSource(),</span></span><br><span class="line"><span class="xml">    &#125;))(BodyRow),</span></span><br><span class="line"><span class="xml">);</span></span><br></pre></td></tr></table></figure><h3 id="css"><a href="#css" class="headerlink" title="css"></a>css</h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">:global &#123;</span><br><span class="line">    .drop-over-downward td &#123;</span><br><span class="line">        border-bottom: <span class="number">2px</span> dashed <span class="number">#1890ff</span><span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.drop-over-upward</span> <span class="selector-tag">td</span> &#123;</span><br><span class="line">        <span class="attribute">border-top</span>: <span class="number">2px</span> dashed <span class="number">#1890ff</span><span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¬¬äºŒç§æ–¹æ¡ˆï¼šreact-sortable-hoc"><a href="#ç¬¬äºŒç§æ–¹æ¡ˆï¼šreact-sortable-hoc" class="headerlink" title="ç¬¬äºŒç§æ–¹æ¡ˆï¼šreact-sortable-hoc"></a>ç¬¬äºŒç§æ–¹æ¡ˆï¼šreact-sortable-hoc</h2><p>æœªåšç»„ä»¶æŠ½ç¦»ï¼Œå‡‘åˆçœ‹</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; arrayMove, SortableContainer, SortableElement, SortableHandle &#125; <span class="keyword">from</span> <span class="string">'react-sortable-hoc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> SortableItem = SortableElement(<span class="function">(<span class="params">props: any</span>) =&gt;</span></span><br><span class="line">    &lt;tr &#123;...props&#125; /&gt;</span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> SortableContainers = SortableContainer(<span class="function">(<span class="params">props: any</span>) =&gt;</span></span><br><span class="line">    &lt;tbody &#123;...props&#125; /&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> DragHandle = SortableHandle(<span class="function"><span class="params">()</span> =&gt;</span> (</span><br><span class="line">    &lt;span className=<span class="string">"sortIcon"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">));</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAA</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span>&lt;<span class="title">Props</span>, <span class="title">State</span>&gt; </span>&#123;</span><br><span class="line">  onSortEnd = <span class="function">(<span class="params">params: any</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> &#123; oldIndex, newIndex &#125; = params;</span><br><span class="line">          <span class="keyword">const</span> &#123; dataSource &#125; = <span class="keyword">this</span>.state;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (oldIndex !== newIndex) &#123;</span><br><span class="line">              <span class="keyword">const</span> newData = arrayMove(<span class="function">(<span class="params">[] <span class="keyword">as</span> ISettleItemUse[]</span>).<span class="params">concat</span>(<span class="params">dataSource</span>), <span class="params">oldIndex</span>, <span class="params">newIndex</span>).<span class="params">filter</span>(<span class="params">(el: any</span>) =&gt;</span> !!el);</span><br><span class="line">              <span class="keyword">this</span>.setState(&#123; <span class="attr">dataSource</span>: newData &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">  DragableBodyRow = <span class="function">(<span class="params">params: any</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; ...restProps &#125; = params</span><br><span class="line">    <span class="keyword">const</span> &#123; dataSource &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">    <span class="keyword">const</span> index = dataSource.findIndex(<span class="function"><span class="params">x</span> =&gt;</span> x.index === restProps[<span class="string">'data-row-key'</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">SortableItem</span> <span class="attr">index</span>=<span class="string">&#123;index&#125;</span> &#123;<span class="attr">...restProps</span>&#125; /&gt;</span></span></span><br><span class="line"><span class="xml">  &#125;;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">  render()&#123;</span></span><br><span class="line"><span class="xml">      const DraggableContainer = (props: any) =&gt; (</span></span><br><span class="line"><span class="xml">              <span class="tag">&lt;&gt;</span></span></span><br><span class="line">                  &lt;SortableContainers</span><br><span class="line">                      useDragHandle</span><br><span class="line">                      helperClass="row-dragging"</span><br><span class="line">                      onSortEnd=&#123;this.onSortEnd&#125;</span><br><span class="line">                      &#123;...props&#125;</span><br><span class="line">                  /&gt;</span><br><span class="line">              &lt;/&gt;</span><br><span class="line">          );</span><br><span class="line"></span><br><span class="line">     &lt;Table</span><br><span class="line">       columns=&#123;this.renderColumns()&#125;</span><br><span class="line">       dataSource=&#123;dataSource&#125;</span><br><span class="line">       rowKey="index"</span><br><span class="line">       bordered=&#123;false&#125;</span><br><span class="line">       pagination=&#123;false&#125;</span><br><span class="line">       locale=&#123;&#123; emptyText: "æš‚æœªé€‰æ‹©" &#125;&#125;</span><br><span class="line">       components=&#123;&#123;</span><br><span class="line">          body: &#123;</span><br><span class="line">            wrapper: DraggableContainer,</span><br><span class="line">              row: this.DragableBodyRow,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;&#125;</span><br><span class="line">       /&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> &lt;DragHandle /&gt;ä¸ºæ‹–åŠ¨çš„å›¾æ ‡</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// æ‹–åŠ¨</span><br><span class="line">  <span class="selector-class">.row-dragging</span> &#123;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#fafafa</span>;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line"></span><br><span class="line">      th &#123;</span><br><span class="line">          color: $color-333;</span><br><span class="line">          <span class="selector-tag">background</span>: <span class="selector-id">#E9EAEA</span> !<span class="selector-tag">important</span>;</span><br><span class="line">          <span class="selector-tag">font-size</span>: 12<span class="selector-tag">px</span>;</span><br><span class="line">          <span class="selector-tag">padding</span>: 8<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> !<span class="selector-tag">important</span>;</span><br><span class="line">          <span class="selector-tag">font-weight</span>: <span class="selector-tag">normal</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">td</span> &#123;</span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">          <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">10px</span> <span class="meta">!important</span>;</span><br><span class="line">          <span class="attribute">color</span>: $color-<span class="number">333</span>;</span><br><span class="line">          <span class="attribute">visibility</span>: hidden;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.drag-visible</span> &#123;</span><br><span class="line">          <span class="attribute">visibility</span>: visible;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ¡ˆåœ¨ä½¿ç”¨åæœ‰ç‚¹å¡é¡¿ï¼Œæ—¶é—´æ€¥æ²¡æ‰¾åˆ° å¡é¡¿çš„åŸå› ã€‚ä½¿ç”¨äº†ç¬¬ä¸€ç§æ–¹æ¡ˆ</p><p>å¯èƒ½æ˜¯è·Ÿè¡¨æ ¼ä¸­çš„åŠ¨æ€ç¼–è¾‘çš„selectã€inputæœ‰å…³ï¼ŒsetStateå¯¼è‡´tbodyé‡æ–°æ¸²æŸ“ï¼Œé€ æˆå¡é¡¿ï¼Œselectå’Œinputä¹Ÿæœ‰è®¸å¤šè”åŠ¨ï¼Œç›®å‰çŒœæ˜¯è¿™ä¸ªåŸå› ï¼ŒåæœŸæœ‰æ—¶é—´ï¼Œæ‰¾åˆ°ä¸€ä¸‹è¿™ä¸ªåŸå› ã€‚</p><h1 id="immutability-helper"><a href="#immutability-helper" class="headerlink" title="immutability-helper"></a>immutability-helper</h1><p>yarn add immutability-helper</p><p>ä¸Šæ–‡ä¸­update $splice</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initialArray = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * API: &#123;$splice: array of arrays&#125;</span></span><br><span class="line"><span class="comment"> * åŒæ•°ç»„çš„ splice æ–¹æ³•</span></span><br><span class="line"><span class="comment"> *      æ•°ç»„ arrays ä¸­åŒ…å«çš„æ˜¯æ‰€æœ‰éœ€è¦æ‰§è¡Œçš„æ“ä½œé›†åˆ</span></span><br><span class="line"><span class="comment"> *      å…ƒç´  array ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ä»£è¡¨ä¸‹æ ‡ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä»£è¡¨éœ€è¦åˆ é™¤çš„ä¸ªæ•°ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ ä»£è¡¨éœ€è¦æ’å…¥åˆ° initialArray ä¸­çš„çš„å…ƒç´ </span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * PS:  1ã€å¯ä»¥åœ¨ arrays ä¸­æ‰§è¡Œå¤šä¸ªé›†åˆï¼›</span></span><br><span class="line"><span class="comment"> *      2ã€ä¸¤ä¸ªæ“ä½œä¸æ˜¯åŒæ—¶æ‰§è¡Œï¼Œè€Œæ˜¯æŒ‰é¡ºåºæ‰§è¡Œï¼Œåé¢çš„æ“ä½œä¼šåœ¨å‰é¢ä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œç»“æœä¸Šæ‰§è¡Œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> spliceArray = update(initialArray, &#123; <span class="attr">$splice</span>: [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">0</span>, <span class="string">'f'</span>, <span class="string">'g'</span>]] &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'spliceArrayï¼š'</span>, spliceArray);  <span class="comment">// =&gt; [ 'a', 'd', 'f', 'g', 'e' ]</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸æ›´æ”¹åŸå§‹æºçš„æƒ…å†µä¸‹æ”¹å˜æ•°æ®å‰¯æœ¬ã€‚</p><blockquote><p>Immutable data encourages pure functions (data-in, data-out) and lends itself to much simpler application development and enabling techniques from functional programming such as lazy evaluation.</p></blockquote><p>API</p><p><code>$push</code> â€”â€” æ•°ç»„;</p><p><code>$unshift</code> â€”â€” æ•°ç»„;</p><p><code>$splice</code> â€”â€” æ•°ç»„;</p><p><code>$set</code> â€”â€” æ›¿æ¢/è¦†ç›–/åˆå¹¶åŸæ•°æ®;</p><p><code>$toggle</code> â€”â€” array of strings ï¼Œtoggles a list of boolean fields from the target objectï¼›</p><p><code>$unset</code> â€”â€” remove the list of keys in array from the target object;</p><p><code>$merge</code> â€”â€” åˆå¹¶å¯¹è±¡;</p><p><code>$apply</code> â€”â€”  passes in the current value to the function and updates it with the new returned valueï¼›</p><p><code>$add</code> â€”â€” æ–°å¢;</p><p><code>$remove</code> â€”â€” åˆ é™¤ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$splice</span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">66</span>];</span><br><span class="line">  <span class="keyword">let</span> arr2 = update(arr,&#123;</span><br><span class="line">    $splice : [[<span class="number">1</span>,<span class="number">2</span>,[<span class="number">66788</span>,<span class="number">99</span>],&#123;<span class="attr">a</span>:<span class="number">123</span>,<span class="attr">b</span>:<span class="string">"fff"</span>&#125;]], <span class="comment">// or [0,1,"ä»æˆ‘å¼€å§‹æ˜¯æ’å…¥çš„å†…å®¹",88,89,90,"åé¢å¯ä»¥å¾ˆå¤šï¼Œæ˜¯æ•°ç»„ã€å¯¹è±¡ã€å­—ç¬¦ä¸²éƒ½è¡Œ"]</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">console</span>.log(arr2); </span><br><span class="line"></span><br><span class="line">  <span class="comment">//å¤æ‚ä¸€äº›çš„ç”¨æ³•ï¼š</span></span><br><span class="line">  <span class="keyword">let</span> obj=&#123;</span><br><span class="line">    name:<span class="string">"immutable"</span>,</span><br><span class="line">    list :[<span class="number">1</span>,<span class="number">2</span>,[<span class="number">90</span>,<span class="number">55</span>,<span class="number">44</span>,<span class="number">3</span>,<span class="number">22</span>,<span class="number">55</span>],<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>]</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> obj2 = update(obj,&#123;</span><br><span class="line">    list:&#123;</span><br><span class="line">      [<span class="number">2</span>]:<span class="function"><span class="params">value</span>=&gt;</span>update(value,&#123;</span><br><span class="line">        $splice:[[<span class="number">0</span>,<span class="number">2</span>]]  <span class="comment">// [90,55,44,3,22,55] =&gt; [44, 3, 22, 55]</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>å‚è€ƒ</p><p><a href="https://www.jianshu.com/p/074bbb7a36b2" target="_blank" rel="noopener">immutabilityå› Reactå®˜æ–¹å‡ºé•œä¹‹ä½¿ç”¨æ€»ç»“åˆ†äº«ï¼</a></p><p><a href="https://ant.design/components/table-cn/" target="_blank" rel="noopener">https://ant.design/components/table-cn/</a></p><p><a href="https://react-dnd.github.io/react-dnd/docs/overview" target="_blank" rel="noopener">https://react-dnd.github.io/react-dnd/docs/overview</a></p>]]></content>
    
    <summary type="html">
    
      React + antd-table è¡¨æ ¼æ‹–æ‹½classç±»å†™æ³•ï¼Œé¡ºä¾¿çœ‹åˆ°äº†Immutability Helpersï¼Œè§‰å¾—è¿˜ä¸é”™ï¼Œç®€å•çš„çœ‹äº†çœ‹
    
    </summary>
    
      <category term="é»˜è®¤åˆ†ç±»" scheme="https://kitions.github.io/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="React" scheme="https://kitions.github.io/tags/React/"/>
    
  </entry>
  
</feed>
